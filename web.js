(()=>{"use strict";let t="https://tejassrinivasan.pythonanywhere.com/";async function e(e){e.url_data=globalThis.url_data,console.log("Data"),"study_id"in e.url_data||(e.url_data.study_id="demo_study"),"prolific_id"in e.url_data||(e.url_data.prolific_id="demo_user"),"session_id"in e.url_data||(e.url_data.session_id="demo_session"),e.url_data.queue_id=globalThis.uid,console.log("logged",e),console.log("Logging to",t+"log");try{let n=await $.ajax(t+"log",{data:JSON.stringify({project:"vlm-rationales-study/"+e.url_data.study_id,uid:globalThis.uid+"_"+e.url_data.prolific_id,payload:JSON.stringify(e)}),type:"POST",contentType:"application/json"});return await async function(){return new Promise((t=>setTimeout(t,2e3)))}(),n}catch(t){console.log(t)}}var n=!1,i=[];let o=-1,s=null,a=-1,r=-1,u=-1,l=-1,d=0,_=0,c=20,h=0,b=0,w=0;function p(t){a=t,$("#button_answeronly_usertrusts").attr("disabled","true"),$("#button_answeronly_userdistrusts").attr("disabled","true"),$("#button_answeronly_userunsure").attr("disabled","true"),0==t?$("#button_answeronly_usertrusts").attr("activedecision","true"):1==t?$("#button_answeronly_userdistrusts").attr("activedecision","true"):2==t&&$("#button_answeronly_userunsure").attr("activedecision","true"),$("#ai_explanation_div").show()}function m(t){r=t,$("#button_withexplanation_usertrusts").attr("disabled","true"),$("#button_withexplanation_userdistrusts").attr("disabled","true"),$("#button_withexplanation_userunsure").attr("disabled","true"),0==t?$("#button_withexplanation_usertrusts").attr("activedecision","true"):1==t?$("#button_withexplanation_userdistrusts").attr("activedecision","true"):2==t&&$("#button_withexplanation_userunsure").attr("activedecision","true"),$("#ai_explanation_quality_div").show()}function x(t){u=t,$("#button_withexplanationquality_usertrusts").attr("disabled","true"),$("#button_withexplanationquality_userdistrusts").attr("disabled","true"),$("#button_withexplanationquality_userunsure").attr("disabled","true"),0==t?$("#button_withexplanationquality_usertrusts").attr("activedecision","true"):1==t?$("#button_withexplanationquality_userdistrusts").attr("activedecision","true"):2==t&&$("#button_withexplanationquality_userunsure").attr("activedecision","true"),$("#button_next").show(),$("#button_next").removeAttr("disabled")}function g(){const t=$("input[name='latexExperience']:checked").val(),e=$("input[name='latexFrequency']:checked").val(),n=$("input[name='chatbotFrequency']:checked").val();return t&&e&&n?($("#button_instructions_next").show(),!0):($("#button_instructions_next").hide(),!1)}function v(t){b+=t,0==b?$("#button_instructions_prev").attr("disabled","true"):$("#button_instructions_prev").removeAttr("disabled"),4!=b||g()?($("#button_instructions_next").removeAttr("disabled"),$("#button_instructions_next").show()):($("#button_instructions_next").attr("disabled","true"),$("#button_instructions_next").hide()),b>=5?($("#instructions_and_decorations").show(),$("#button_instructions_next").val("Start study")):($("#instructions_and_decorations").hide(),$("#button_instructions_next").val("Next")),6==b&&($("#instructions_and_decorations").show(),$("#main_box_instructions").hide(),$("#main_box_experiment").show(),q()),$("#main_box_instructions").children(":not(input)").each(((t,e)=>{$(e).hide()})),$(`#instructions_${b}`).show()}function y(t){return 2!=t?t==1-s.prediction_is_correct?1:0:-1}function q(){if($("#button_readytoanswer").removeAttr("activedecision"),$("#button_readytoanswer").removeAttr("disabled"),$("#button_readytoanswer").show(),$("#button_answeronly_usertrusts").removeAttr("activedecision"),$("#button_answeronly_usertrusts").removeAttr("disabled"),$("#button_answeronly_userdistrusts").removeAttr("activedecision"),$("#button_answeronly_userdistrusts").removeAttr("disabled"),$("#button_answeronly_userunsure").removeAttr("activedecision"),$("#button_answeronly_userunsure").removeAttr("disabled"),$("#button_withexplanation_usertrusts").removeAttr("activedecision"),$("#button_withexplanation_usertrusts").removeAttr("disabled"),$("#button_withexplanation_userdistrusts").removeAttr("activedecision"),$("#button_withexplanation_userdistrusts").removeAttr("disabled"),$("#button_withexplanation_userunsure").removeAttr("activedecision"),$("#button_withexplanation_userunsure").removeAttr("disabled"),$("#button_withexplanationquality_usertrusts").removeAttr("activedecision"),$("#button_withexplanationquality_usertrusts").removeAttr("disabled"),$("#button_withexplanationquality_userdistrusts").removeAttr("activedecision"),$("#button_withexplanationquality_userdistrusts").removeAttr("disabled"),$("#button_withexplanationquality_userunsure").removeAttr("activedecision"),$("#button_withexplanationquality_userunsure").removeAttr("disabled"),$("#ai_explanation_div").hide(),$("#ai_explanation_quality_div").hide(),$("#button_next").hide(),$("#button_quit").hide(),o+=1,o>=i.length)return $("#main_box_experiment").hide(),void $("#qualitative_section").show();s=i[o],$("#part1").show(),$("#part2").hide(),s.image?$("#question_image").attr("src","data:image/png;base64,"+s.image):$("#question_image").attr("src","");let t="";s.token_info&&Array.isArray(s.token_info)&&(t=s.token_info.filter((t=>"<|im_end|>"!==t.token)).map((t=>{let e=t.token.replace(/Ġ/g," "),n=1-(t.top_5_tokens&&t.top_5_tokens[0]&&"number"==typeof t.top_5_tokens[0].probability?t.top_5_tokens[0].probability:1);return 1==s.is_highlighted?`<span style="background-color: rgba(255, 0, 0, ${n});">${e}</span>`:e})).join("")),$("#predicted_text").html(t),1==s.is_highlighted?$("#predicted_text_container strong").addClass("highlighted-title"):$("#predicted_text_container strong").removeClass("highlighted-title");let e="";s.token_info&&Array.isArray(s.token_info)&&(e=s.token_info.map((t=>t.token)).filter((t=>"<|im_end|>"!==t)).map((t=>t.replace(/Ġ/g," "))).join("")),$("#token_input").val(e),$("#progress").text(`Progress: ${o+1} / ${i.length}`),$("#token_input_container").hide(),$("#button_next_part1").hide(),clearTimeout(d),d=window.setTimeout(E,2e4),c=20,$("#timer").text(c),$("#timer").show(),_&&clearInterval(_),_=window.setInterval((()=>{c-=1,$("#timer").text(c),c<=15&&($("#token_input_container").show(),$("#button_next_part1").show()),c<=0&&(clearInterval(_),E(),$("#timer").hide())}),1e3)}document.getElementById("button_answeronly_usertrusts")?.addEventListener("click",(()=>p(0))),document.getElementById("button_answeronly_userdistrusts")?.addEventListener("click",(()=>p(1))),document.getElementById("button_answeronly_userunsure")?.addEventListener("click",(()=>p(2))),document.getElementById("button_withexplanation_usertrusts")?.addEventListener("click",(()=>m(0))),document.getElementById("button_withexplanation_userdistrusts")?.addEventListener("click",(()=>m(1))),document.getElementById("button_withexplanation_userunsure")?.addEventListener("click",(()=>m(2))),document.getElementById("button_withexplanationquality_usertrusts")?.addEventListener("click",(()=>x(0))),document.getElementById("button_withexplanationquality_userdistrusts")?.addEventListener("click",(()=>x(1))),document.getElementById("button_withexplanationquality_userunsure")?.addEventListener("click",(()=>x(2))),$("#button_instructions_next").on("click",(()=>v(1))),$("#button_instructions_prev").on("click",(()=>v(-1))),$("#button_next").on("click",(()=>{let t=h;if(function(){if(2!=u){let t=1-s.prediction_is_correct;u==t&&(h+=.1)}}(),-1!=o){let n={question_i:o,user_selections:{answeronly:a,withexplanation:r,withexplanationquality:u},user_is_correct:{answeronly:y(a),withexplanation:y(r),withexplanationquality:y(u)},balance:{old:t,new:h}};n.question=s,n.count_exited_page=w,e(n),w=0}q()}));const f=new URLSearchParams(window.location.search),k=f.get("start"),A=f.get("uid");if(globalThis.url_data=function(t){const e={};for(const[n,i]of t)e[n]=i;return e}(f.entries()),null==globalThis.url_data.study_id&&(globalThis.url_data.study_id="demo_study"),null==globalThis.url_data.prolific_id&&(globalThis.url_data.prolific_id="demo_user"),null==globalThis.url_data.session_id&&(globalThis.url_data.session_id="demo_session"),null!=A){if(globalThis.uid=A,"prolific_random"==globalThis.uid){let t=`${Math.floor(10*Math.random())}`.padStart(3,"0");globalThis.uid=`${f.get("prolific_queue_name")}/${t}`}}else{let t=null;for(;null==t;)t=prompt("Enter your user id. Please get in touch if you were not assigned an id but wish to participate in this experiment.");globalThis.uid=t}globalThis.url_data.session_id.startsWith("demo")&&(n=!0),console.log("Running with UID",globalThis.uid),async function(){return await $.getJSON(`baked_queues/${globalThis.uid}.json?t=${Date.now()}`)}().catch((t=>{console.log("Invalid user id."),console.log(globalThis.uid),window.location.reload()})).then((t=>{i=t,null!=k&&(o=parseInt(k)-1,console.log("Starting from",o)),v(0),$("#main_box_instructions").show(),$("#instructions_and_decorations").hide()})),console.log("Starting session with UID:",globalThis.uid);let T=!1;function E(){clearInterval(_),$("#timer").hide(),$("#part1").hide(),$("#part2").show()}document.onvisibilitychange=()=>{T||(w+=1,T=!0,T=!1)},$(document).ready((()=>{$("#button_next_part1").on("click",(()=>{clearTimeout(d),$("#timer").hide(),$("#part1").hide(),$("#part2").show()})),$(".confidence-button").on("click",(function(){let t=parseInt($(this).attr("data-rating"));$(".confidence-button").removeClass("selected"),$(this).addClass("selected"),l=t,$("#button_next_part2").removeAttr("disabled")})),$("#button_next_part2").on("click",(()=>{e({question_i:o,confidence_rating:l}),$("#button_next_part2").attr("disabled","true"),$(".confidence-button").removeClass("selected"),l=-1,$("#part2").hide(),$("#part1").show(),q()})),$("input[name='latexExperience'], input[name='latexFrequency'], input[name='chatbotFrequency']").on("change",(()=>{g()&&($("#button_instructions_next").removeAttr("disabled"),$("#button_instructions_next").show())}))})),$("#qual_next").on("click",(()=>{const t=$("#qual_q1").val()||"",i=$("#qual_q2").val()||"",s=$("#qual_q3").val()||"";let a=!0;t.length<25?($("#warn_q1").show(),a=!1):$("#warn_q1").hide(),i.length<25?($("#warn_q2").show(),a=!1):$("#warn_q2").hide(),s.length<0?($("#warn_q3").show(),a=!1):$("#warn_q3").hide(),a&&(e({qualitative:{q1:t,q2:i,q3:s}}),$("#qualitative_section").hide(),n?($("#reward_box_mock").text(`Your total reward is $${h.toFixed(2)} (${o} questions answered) + $2.`),$("#reward_box_mock").show(),$("#main_box_end_mock").show()):($("#reward_box").text(`Your total reward is $${h.toFixed(2)} (${o} questions answered) + $2.`),$("#reward_box").show(),$("#main_box_end").show()))}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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WSxZQUNwQzdDLEdBQW9CLEVBR3BCbkIsRUFBRSxVQUFVc0MsT0FDWnRDLEVBQUUsVUFBVTZCLE9BQ1pZLEdBQWUsSUFFakJ6QyxFQUFFLCtGQUErRjJFLEdBQUcsVUFBVSxLQUN2RzFDLE1BQ0NqQyxFQUFFLDZCQUE2QmdDLFdBQVcsWUFDMUNoQyxFQUFFLDZCQUE2QjZCLE8sR0FHckMsSUFZTjdCLEVBQUUsY0FBYzJFLEdBQUcsU0FBUyxLQUN4QixNQUFNdUMsRUFBTWxILEVBQUUsWUFBWW1DLE9BQW9CLEdBQ3hDZ0YsRUFBTW5ILEVBQUUsWUFBWW1DLE9BQW9CLEdBQ3hDaUYsRUFBTXBILEVBQUUsWUFBWW1DLE9BQW9CLEdBRTlDLElBQUlrRixHQUFRLEVBRVJILEVBQUdsRSxPQUFTLElBQ1poRCxFQUFFLFlBQVk2QixPQUNkd0YsR0FBUSxHQUVSckgsRUFBRSxZQUFZc0MsT0FHZDZFLEVBQUduRSxPQUFTLElBQ1poRCxFQUFFLFlBQVk2QixPQUNkd0YsR0FBUSxHQUVSckgsRUFBRSxZQUFZc0MsT0FHZDhFLEVBQUdwRSxPQUFTLEdBQ1poRCxFQUFFLFlBQVk2QixPQUNkd0YsR0FBUSxHQUVSckgsRUFBRSxZQUFZc0MsT0FJYitFLElBYUw3SCxFQVJrQixDQUNkOEgsWUFBYSxDQUNUSixHQUFJQSxFQUNKQyxHQUFJQSxFQUNKQyxHQUFJQSxLQU9acEgsRUFBRSx3QkFBd0JzQyxPQUN0QnpCLEdBQ0FiLEVBQUUsb0JBQW9Ca0UsS0FBSyx5QkFBeUIzQyxFQUFRZ0csUUFBUSxPQUFPekcsK0JBQzNFZCxFQUFFLG9CQUFvQjZCLE9BQ3RCN0IsRUFBRSxzQkFBc0I2QixTQUV4QjdCLEVBQUUsZUFBZWtFLEtBQUsseUJBQXlCM0MsRUFBUWdHLFFBQVEsT0FBT3pHLCtCQUN0RWQsRUFBRSxlQUFlNkIsT0FDakI3QixFQUFFLGlCQUFpQjZCLFEiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvY29ubmVjdG9yLnRzIiwid2VicGFjazovLy8uL3NyYy9tYWluLnRzIiwid2VicGFjazovLy8uL3NyYy91dGlscy50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBERVZNT0RFIH0gZnJvbSAnLi9nbG9iYWxzJ1xyXG5pbXBvcnQgeyBNT0NLTU9ERSB9IGZyb20gJy4vbWFpbidcclxuXHJcbmxldCBTRVJWRVJfTE9HX1JPT1QgPSBERVZNT0RFID8gXCJodHRwOi8vMTI3LjAuMC4xOjUwMDAvXCIgOiBcImh0dHBzOi8vdGVqYXNzcmluaXZhc2FuLnB5dGhvbmFueXdoZXJlLmNvbS9cIlxyXG5cclxuYXN5bmMgZnVuY3Rpb24gc2xlZXAobXM6IG51bWJlcik6IFByb21pc2U8dm9pZD4ge1xyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIG1zKSk7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBsb2FkX2RhdGEoKTogUHJvbWlzZTxhbnk+IHtcclxuICAgIC8vIGluY2x1ZGUgdGltZXN0YW1wIHNvIHRoYXQgdGhpbmdzIGRvbid0IGdldCBjYWNoZWRcclxuICAgIGxldCByZXN1bHQgPSBhd2FpdCAkLmdldEpTT04oXHJcbiAgICAgICAgYGJha2VkX3F1ZXVlcy8ke2dsb2JhbFRoaXMudWlkfS5qc29uP3Q9JHtEYXRlLm5vdygpfWAsXHJcbiAgICApXHJcbiAgICByZXR1cm4gcmVzdWx0XHJcbn1cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGxvZ19kYXRhKGRhdGEpOiBQcm9taXNlPGFueT4ge1xyXG4gICAgLy9pZiAoTU9DS01PREUpIHtcclxuICAgIC8vICAgIGNvbnNvbGUubG9nKFwibG9nZ2VkIChtb2NrKVwiLCBkYXRhKVxyXG4gICAgLy8gICAgcmV0dXJuXHJcbiAgICAvL31cclxuICAgIFxyXG4gICAgZGF0YVtcInVybF9kYXRhXCJdID0gZ2xvYmFsVGhpcy51cmxfZGF0YVxyXG4gICAgY29uc29sZS5sb2coXCJEYXRhXCIpXHJcbiAgICBpZiAoIShcInN0dWR5X2lkXCIgaW4gZGF0YVsndXJsX2RhdGEnXSkpIHtcclxuICAgICAgICBkYXRhWyd1cmxfZGF0YSddW1wic3R1ZHlfaWRcIl0gPSBcImRlbW9fc3R1ZHlcIlxyXG4gICAgfVxyXG4gICAgaWYgKCEoXCJwcm9saWZpY19pZFwiIGluIGRhdGFbJ3VybF9kYXRhJ10pKSB7XHJcbiAgICAgICAgZGF0YVsndXJsX2RhdGEnXVtcInByb2xpZmljX2lkXCJdID0gXCJkZW1vX3VzZXJcIlxyXG4gICAgfVxyXG4gICAgaWYgKCEoXCJzZXNzaW9uX2lkXCIgaW4gZGF0YVsndXJsX2RhdGEnXSkpIHtcclxuICAgICAgICBkYXRhWyd1cmxfZGF0YSddW1wic2Vzc2lvbl9pZFwiXSA9IFwiZGVtb19zZXNzaW9uXCJcclxuICAgIH1cclxuICAgIGRhdGFbXCJ1cmxfZGF0YVwiXVtcInF1ZXVlX2lkXCJdID0gZ2xvYmFsVGhpcy51aWRcclxuICAgIGNvbnNvbGUubG9nKFwibG9nZ2VkXCIsIGRhdGEpXHJcbiAgICBjb25zb2xlLmxvZyhcIkxvZ2dpbmcgdG9cIiwgU0VSVkVSX0xPR19ST09UICsgXCJsb2dcIilcclxuXHJcbiAgICB0cnkge1xyXG4gICAgICAgIGxldCByZXN1bHQgPSBhd2FpdCAkLmFqYXgoXHJcbiAgICAgICAgICAgIFNFUlZFUl9MT0dfUk9PVCArIFwibG9nXCIsXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGRhdGE6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICAgICAgICAgICAgICBwcm9qZWN0OiBcInZsbS1yYXRpb25hbGVzLXN0dWR5L1wiK2RhdGFbJ3VybF9kYXRhJ11bJ3N0dWR5X2lkJ10sXHJcbiAgICAgICAgICAgICAgICAgICAgdWlkOiBnbG9iYWxUaGlzLnVpZCtcIl9cIitkYXRhWyd1cmxfZGF0YSddWydwcm9saWZpY19pZCddLFxyXG4gICAgICAgICAgICAgICAgICAgIHBheWxvYWQ6IEpTT04uc3RyaW5naWZ5KGRhdGEpLFxyXG4gICAgICAgICAgICAgICAgfSksXHJcbiAgICAgICAgICAgICAgICB0eXBlOiAnUE9TVCcsXHJcbiAgICAgICAgICAgICAgICBjb250ZW50VHlwZTogJ2FwcGxpY2F0aW9uL2pzb24nLFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgKVxyXG4gICAgICAgIGF3YWl0IHNsZWVwKDIwMDApO1xyXG4gICAgICAgIHJldHVybiByZXN1bHRcclxuICAgIH0gY2F0Y2ggKGUpIHtcclxuICAgICAgICBjb25zb2xlLmxvZyhlKVxyXG4gICAgfVxyXG59IiwiaW1wb3J0IHsgREVWTU9ERSB9IGZyb20gXCIuL2dsb2JhbHNcIlxyXG5leHBvcnQgdmFyIFVJRDogc3RyaW5nXHJcbmV4cG9ydCB2YXIgTU9DS01PREU6IGJvb2xlYW4gPSBmYWxzZVxyXG5pbXBvcnQgeyBsb2FkX2RhdGEsIGxvZ19kYXRhIH0gZnJvbSAnLi9jb25uZWN0b3InXHJcbmltcG9ydCB7IHBhcmFtc1RvT2JqZWN0IH0gZnJvbSBcIi4vdXRpbHNcIlxyXG5cclxudmFyIGRhdGE6IGFueVtdID0gW11cclxubGV0IHF1ZXN0aW9uX2kgPSAtMVxyXG5sZXQgcXVlc3Rpb246IGFueSA9IG51bGxcclxubGV0IHVzZXJzZWxlY3Rpb25fYW5zd2Vyb25seTogbnVtYmVyID0gLTFcclxubGV0IHVzZXJzZWxlY3Rpb25fd2l0aGV4cGxhbmF0aW9uOiBudW1iZXIgPSAtMVxyXG5sZXQgdXNlcnNlbGVjdGlvbl93aXRoZXhwbGFuYXRpb25xdWFsaXR5OiBudW1iZXIgPSAtMVxyXG5sZXQgY29uZmlkZW5jZVJhdGluZzogbnVtYmVyID0gLTE7XHJcbmxldCBwYXJ0MVRpbWVyOiBudW1iZXIgPSAwO1xyXG5sZXQgcGFydDFJbnRlcnZhbDogbnVtYmVyID0gMDtcclxubGV0IHJlbWFpbmluZ1RpbWU6IG51bWJlciA9IDIwO1xyXG5cclxuXHJcblxyXG5sZXQgYmFsYW5jZSA9IDBcclxubGV0IGJhbGFuY2VfaW5jcmVtZW50ID0gMC4xICAgICAvLyBCYWxhbmNlIHVwZGF0ZXMgYnkgJDAuMTAgZm9yIGV2ZXJ5IGNvcnJlY3Qgc2VsZWN0aW9uXHJcblxyXG5sZXQgaW5zdHJ1Y3Rpb25faTogbnVtYmVyID0gMFxyXG5sZXQgY291bnRfZXhpdGVkX3BhZ2U6IG51bWJlciA9IDBcclxuXHJcbmZ1bmN0aW9uIGFzc2VydChjb25kaXRpb24sIG1lc3NhZ2UpIHtcclxuICAgIGlmICghY29uZGl0aW9uKSB7XHJcbiAgICAgICAgdGhyb3cgbWVzc2FnZSB8fCBcIkFzc2VydGlvbiBmYWlsZWRcIjtcclxuICAgIH1cclxufVxyXG5cclxuZnVuY3Rpb24gcmVnaXN0ZXJBbnN3ZXJPbmx5VXNlclNlbGVjdGlvbih1c2VyX2Nob2ljZTogbnVtYmVyKSB7XHJcbiAgICB1c2Vyc2VsZWN0aW9uX2Fuc3dlcm9ubHkgPSB1c2VyX2Nob2ljZVxyXG5cclxuICAgICQoXCIjYnV0dG9uX2Fuc3dlcm9ubHlfdXNlcnRydXN0c1wiKS5hdHRyKFwiZGlzYWJsZWRcIiwgXCJ0cnVlXCIpXHJcbiAgICAkKFwiI2J1dHRvbl9hbnN3ZXJvbmx5X3VzZXJkaXN0cnVzdHNcIikuYXR0cihcImRpc2FibGVkXCIsIFwidHJ1ZVwiKVxyXG4gICAgJChcIiNidXR0b25fYW5zd2Vyb25seV91c2VydW5zdXJlXCIpLmF0dHIoXCJkaXNhYmxlZFwiLCBcInRydWVcIilcclxuICAgIGlmICh1c2VyX2Nob2ljZSA9PSAwKSB7XHJcbiAgICAgICAgJChcIiNidXR0b25fYW5zd2Vyb25seV91c2VydHJ1c3RzXCIpLmF0dHIoXCJhY3RpdmVkZWNpc2lvblwiLCBcInRydWVcIilcclxuICAgIH0gZWxzZSBpZiAodXNlcl9jaG9pY2UgPT0gMSkge1xyXG4gICAgICAgICQoXCIjYnV0dG9uX2Fuc3dlcm9ubHlfdXNlcmRpc3RydXN0c1wiKS5hdHRyKFwiYWN0aXZlZGVjaXNpb25cIiwgXCJ0cnVlXCIpXHJcbiAgICB9IGVsc2UgaWYgKHVzZXJfY2hvaWNlID09IDIpIHtcclxuICAgICAgICAkKFwiI2J1dHRvbl9hbnN3ZXJvbmx5X3VzZXJ1bnN1cmVcIikuYXR0cihcImFjdGl2ZWRlY2lzaW9uXCIsIFwidHJ1ZVwiKVxyXG4gICAgfVxyXG4gICAgJChcIiNhaV9leHBsYW5hdGlvbl9kaXZcIikuc2hvdygpXHJcbn1cclxuLy8gRXZlbnQgbGlzdGVuZXIgZm9yIHRoZSBidXR0b24gY2xpY2tcclxuZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2J1dHRvbl9hbnN3ZXJvbmx5X3VzZXJ0cnVzdHMnKT8uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiByZWdpc3RlckFuc3dlck9ubHlVc2VyU2VsZWN0aW9uKDApKTtcclxuZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2J1dHRvbl9hbnN3ZXJvbmx5X3VzZXJkaXN0cnVzdHMnKT8uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiByZWdpc3RlckFuc3dlck9ubHlVc2VyU2VsZWN0aW9uKDEpKTtcclxuZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2J1dHRvbl9hbnN3ZXJvbmx5X3VzZXJ1bnN1cmUnKT8uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiByZWdpc3RlckFuc3dlck9ubHlVc2VyU2VsZWN0aW9uKDIpKTtcclxuXHJcblxyXG5mdW5jdGlvbiByZWdpc3RlcldpdGhFeHBsYW5hdGlvblVzZXJTZWxlY3Rpb24odXNlcl9jaG9pY2U6IG51bWJlcikge1xyXG4gICAgdXNlcnNlbGVjdGlvbl93aXRoZXhwbGFuYXRpb24gPSB1c2VyX2Nob2ljZVxyXG5cclxuICAgICQoXCIjYnV0dG9uX3dpdGhleHBsYW5hdGlvbl91c2VydHJ1c3RzXCIpLmF0dHIoXCJkaXNhYmxlZFwiLCBcInRydWVcIilcclxuICAgICQoXCIjYnV0dG9uX3dpdGhleHBsYW5hdGlvbl91c2VyZGlzdHJ1c3RzXCIpLmF0dHIoXCJkaXNhYmxlZFwiLCBcInRydWVcIilcclxuICAgICQoXCIjYnV0dG9uX3dpdGhleHBsYW5hdGlvbl91c2VydW5zdXJlXCIpLmF0dHIoXCJkaXNhYmxlZFwiLCBcInRydWVcIilcclxuICAgIGlmICh1c2VyX2Nob2ljZSA9PSAwKSB7XHJcbiAgICAgICAgJChcIiNidXR0b25fd2l0aGV4cGxhbmF0aW9uX3VzZXJ0cnVzdHNcIikuYXR0cihcImFjdGl2ZWRlY2lzaW9uXCIsIFwidHJ1ZVwiKVxyXG4gICAgfSBlbHNlIGlmICh1c2VyX2Nob2ljZSA9PSAxKSB7XHJcbiAgICAgICAgJChcIiNidXR0b25fd2l0aGV4cGxhbmF0aW9uX3VzZXJkaXN0cnVzdHNcIikuYXR0cihcImFjdGl2ZWRlY2lzaW9uXCIsIFwidHJ1ZVwiKVxyXG4gICAgfSBlbHNlIGlmICh1c2VyX2Nob2ljZSA9PSAyKSB7XHJcbiAgICAgICAgJChcIiNidXR0b25fd2l0aGV4cGxhbmF0aW9uX3VzZXJ1bnN1cmVcIikuYXR0cihcImFjdGl2ZWRlY2lzaW9uXCIsIFwidHJ1ZVwiKVxyXG4gICAgfVxyXG4gICAgJChcIiNhaV9leHBsYW5hdGlvbl9xdWFsaXR5X2RpdlwiKS5zaG93KClcclxufVxyXG5cclxuZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2J1dHRvbl93aXRoZXhwbGFuYXRpb25fdXNlcnRydXN0cycpPy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHJlZ2lzdGVyV2l0aEV4cGxhbmF0aW9uVXNlclNlbGVjdGlvbigwKSk7XHJcbmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdidXR0b25fd2l0aGV4cGxhbmF0aW9uX3VzZXJkaXN0cnVzdHMnKT8uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiByZWdpc3RlcldpdGhFeHBsYW5hdGlvblVzZXJTZWxlY3Rpb24oMSkpO1xyXG5kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYnV0dG9uX3dpdGhleHBsYW5hdGlvbl91c2VydW5zdXJlJyk/LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gcmVnaXN0ZXJXaXRoRXhwbGFuYXRpb25Vc2VyU2VsZWN0aW9uKDIpKTtcclxuICBcclxuZnVuY3Rpb24gcmVnaXN0ZXJXaXRoRXhwbGFuYXRpb25RdWFsaXR5VXNlclNlbGVjdGlvbih1c2VyX2Nob2ljZTogbnVtYmVyKSB7XHJcbiAgICB1c2Vyc2VsZWN0aW9uX3dpdGhleHBsYW5hdGlvbnF1YWxpdHkgPSB1c2VyX2Nob2ljZVxyXG5cclxuICAgICQoXCIjYnV0dG9uX3dpdGhleHBsYW5hdGlvbnF1YWxpdHlfdXNlcnRydXN0c1wiKS5hdHRyKFwiZGlzYWJsZWRcIiwgXCJ0cnVlXCIpXHJcbiAgICAkKFwiI2J1dHRvbl93aXRoZXhwbGFuYXRpb25xdWFsaXR5X3VzZXJkaXN0cnVzdHNcIikuYXR0cihcImRpc2FibGVkXCIsIFwidHJ1ZVwiKVxyXG4gICAgJChcIiNidXR0b25fd2l0aGV4cGxhbmF0aW9ucXVhbGl0eV91c2VydW5zdXJlXCIpLmF0dHIoXCJkaXNhYmxlZFwiLCBcInRydWVcIilcclxuICAgIGlmICh1c2VyX2Nob2ljZSA9PSAwKSB7XHJcbiAgICAgICAgJChcIiNidXR0b25fd2l0aGV4cGxhbmF0aW9ucXVhbGl0eV91c2VydHJ1c3RzXCIpLmF0dHIoXCJhY3RpdmVkZWNpc2lvblwiLCBcInRydWVcIilcclxuICAgIH0gZWxzZSBpZiAodXNlcl9jaG9pY2UgPT0gMSkge1xyXG4gICAgICAgICQoXCIjYnV0dG9uX3dpdGhleHBsYW5hdGlvbnF1YWxpdHlfdXNlcmRpc3RydXN0c1wiKS5hdHRyKFwiYWN0aXZlZGVjaXNpb25cIiwgXCJ0cnVlXCIpXHJcbiAgICB9IGVsc2UgaWYgKHVzZXJfY2hvaWNlID09IDIpIHtcclxuICAgICAgICAkKFwiI2J1dHRvbl93aXRoZXhwbGFuYXRpb25xdWFsaXR5X3VzZXJ1bnN1cmVcIikuYXR0cihcImFjdGl2ZWRlY2lzaW9uXCIsIFwidHJ1ZVwiKVxyXG4gICAgfVxyXG4gICAgJChcIiNidXR0b25fbmV4dFwiKS5zaG93KClcclxuICAgICQoXCIjYnV0dG9uX25leHRcIikucmVtb3ZlQXR0cihcImRpc2FibGVkXCIpXHJcbn1cclxuXHJcbmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdidXR0b25fd2l0aGV4cGxhbmF0aW9ucXVhbGl0eV91c2VydHJ1c3RzJyk/LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gcmVnaXN0ZXJXaXRoRXhwbGFuYXRpb25RdWFsaXR5VXNlclNlbGVjdGlvbigwKSk7XHJcbmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdidXR0b25fd2l0aGV4cGxhbmF0aW9ucXVhbGl0eV91c2VyZGlzdHJ1c3RzJyk/LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gcmVnaXN0ZXJXaXRoRXhwbGFuYXRpb25RdWFsaXR5VXNlclNlbGVjdGlvbigxKSk7XHJcbmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdidXR0b25fd2l0aGV4cGxhbmF0aW9ucXVhbGl0eV91c2VydW5zdXJlJyk/LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gcmVnaXN0ZXJXaXRoRXhwbGFuYXRpb25RdWFsaXR5VXNlclNlbGVjdGlvbigyKSk7XHJcblxyXG5mdW5jdGlvbiBjaGVja1ByZVN1cnZleSgpOiBib29sZWFuIHtcclxuICAgIGNvbnN0IGxhdGV4RXhwID0gJChcImlucHV0W25hbWU9J2xhdGV4RXhwZXJpZW5jZSddOmNoZWNrZWRcIikudmFsKCk7XHJcbiAgICBjb25zdCBsYXRleEZyZXEgPSAkKFwiaW5wdXRbbmFtZT0nbGF0ZXhGcmVxdWVuY3knXTpjaGVja2VkXCIpLnZhbCgpO1xyXG4gICAgY29uc3QgY2hhdGJvdEZyZXEgPSAkKFwiaW5wdXRbbmFtZT0nY2hhdGJvdEZyZXF1ZW5jeSddOmNoZWNrZWRcIikudmFsKCk7XHJcbiAgXHJcbiAgICBpZiAobGF0ZXhFeHAgJiYgbGF0ZXhGcmVxICYmIGNoYXRib3RGcmVxKSB7XHJcbiAgICAgICQoXCIjYnV0dG9uX2luc3RydWN0aW9uc19uZXh0XCIpLnNob3coKTtcclxuICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAkKFwiI2J1dHRvbl9pbnN0cnVjdGlvbnNfbmV4dFwiKS5oaWRlKCk7XHJcbiAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxufVxyXG5cclxuXHJcbmZ1bmN0aW9uIG5leHRfaW5zdHJ1Y3Rpb25zKGluY3JlbWVudDogbnVtYmVyKSB7XHJcbiAgICBpbnN0cnVjdGlvbl9pICs9IGluY3JlbWVudFxyXG5cclxuICAgIGlmIChpbnN0cnVjdGlvbl9pID09IDApIHtcclxuICAgICAgICAkKFwiI2J1dHRvbl9pbnN0cnVjdGlvbnNfcHJldlwiKS5hdHRyKFwiZGlzYWJsZWRcIiwgXCJ0cnVlXCIpXHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgICQoXCIjYnV0dG9uX2luc3RydWN0aW9uc19wcmV2XCIpLnJlbW92ZUF0dHIoXCJkaXNhYmxlZFwiKVxyXG4gICAgfVxyXG4gICAgaWYoaW5zdHJ1Y3Rpb25faSA9PSA0ICYmICFjaGVja1ByZVN1cnZleSgpKSB7XHJcbiAgICAgICAgJChcIiNidXR0b25faW5zdHJ1Y3Rpb25zX25leHRcIikuYXR0cihcImRpc2FibGVkXCIsIFwidHJ1ZVwiKVxyXG4gICAgICAgICQoXCIjYnV0dG9uX2luc3RydWN0aW9uc19uZXh0XCIpLmhpZGUoKVxyXG4gICAgfVxyXG4gICAgZWxzZXtcclxuICAgICAgICAkKFwiI2J1dHRvbl9pbnN0cnVjdGlvbnNfbmV4dFwiKS5yZW1vdmVBdHRyKFwiZGlzYWJsZWRcIilcclxuICAgICAgICAkKFwiI2J1dHRvbl9pbnN0cnVjdGlvbnNfbmV4dFwiKS5zaG93KClcclxuICAgIH1cclxuICAgIGlmIChpbnN0cnVjdGlvbl9pID49IDUpIHtcclxuICAgICAgICAkKFwiI2luc3RydWN0aW9uc19hbmRfZGVjb3JhdGlvbnNcIikuc2hvdygpXHJcbiAgICAgICAgJChcIiNidXR0b25faW5zdHJ1Y3Rpb25zX25leHRcIikudmFsKFwiU3RhcnQgc3R1ZHlcIilcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgJChcIiNpbnN0cnVjdGlvbnNfYW5kX2RlY29yYXRpb25zXCIpLmhpZGUoKVxyXG4gICAgICAgICQoXCIjYnV0dG9uX2luc3RydWN0aW9uc19uZXh0XCIpLnZhbChcIk5leHRcIilcclxuICAgIH1cclxuICAgIGlmIChpbnN0cnVjdGlvbl9pID09IDYpIHtcclxuICAgICAgICAkKFwiI2luc3RydWN0aW9uc19hbmRfZGVjb3JhdGlvbnNcIikuc2hvdygpXHJcbiAgICAgICAgJChcIiNtYWluX2JveF9pbnN0cnVjdGlvbnNcIikuaGlkZSgpXHJcbiAgICAgICAgJChcIiNtYWluX2JveF9leHBlcmltZW50XCIpLnNob3coKVxyXG4gICAgICAgIG5leHRfcXVlc3Rpb24oKVxyXG4gICAgfVxyXG5cclxuICAgICQoXCIjbWFpbl9ib3hfaW5zdHJ1Y3Rpb25zXCIpLmNoaWxkcmVuKFwiOm5vdChpbnB1dClcIikuZWFjaCgoXywgZWwpID0+IHtcclxuICAgICAgICAkKGVsKS5oaWRlKClcclxuICAgIH0pXHJcbiAgICAkKGAjaW5zdHJ1Y3Rpb25zXyR7aW5zdHJ1Y3Rpb25faX1gKS5zaG93KClcclxufVxyXG4kKFwiI2J1dHRvbl9pbnN0cnVjdGlvbnNfbmV4dFwiKS5vbihcImNsaWNrXCIsICgpID0+IG5leHRfaW5zdHJ1Y3Rpb25zKCsxKSlcclxuJChcIiNidXR0b25faW5zdHJ1Y3Rpb25zX3ByZXZcIikub24oXCJjbGlja1wiLCAoKSA9PiBuZXh0X2luc3RydWN0aW9ucygtMSkpXHJcblxyXG4kKFwiI2J1dHRvbl9uZXh0XCIpLm9uKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG5cclxuICAgIC8vIFVwZGF0ZSB0aGUgdXNlciBiYWxhbmNlXHJcbiAgICBsZXQgb2xkX2JhbGFuY2UgPSBiYWxhbmNlXHJcbiAgICB1cGRhdGVfYmFsYW5jZSgpXHJcblxyXG4gICAgaWYgKHF1ZXN0aW9uX2kgIT0gLTEpIHtcclxuICAgICAgICBsZXQgbG9nZ2VkX2RhdGEgPSB7XHJcbiAgICAgICAgICAgIFwicXVlc3Rpb25faVwiOiBxdWVzdGlvbl9pLFxyXG4gICAgICAgICAgICBcInVzZXJfc2VsZWN0aW9uc1wiOiB7XHJcbiAgICAgICAgICAgICAgICBcImFuc3dlcm9ubHlcIjogdXNlcnNlbGVjdGlvbl9hbnN3ZXJvbmx5LFxyXG4gICAgICAgICAgICAgICAgXCJ3aXRoZXhwbGFuYXRpb25cIjogdXNlcnNlbGVjdGlvbl93aXRoZXhwbGFuYXRpb24sXHJcbiAgICAgICAgICAgICAgICBcIndpdGhleHBsYW5hdGlvbnF1YWxpdHlcIjogdXNlcnNlbGVjdGlvbl93aXRoZXhwbGFuYXRpb25xdWFsaXR5XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIFwidXNlcl9pc19jb3JyZWN0XCI6IHtcclxuICAgICAgICAgICAgICAgIFwiYW5zd2Vyb25seVwiOiBpc191c2VyX2NvcnJlY3QodXNlcnNlbGVjdGlvbl9hbnN3ZXJvbmx5KSxcclxuICAgICAgICAgICAgICAgIFwid2l0aGV4cGxhbmF0aW9uXCI6IGlzX3VzZXJfY29ycmVjdCh1c2Vyc2VsZWN0aW9uX3dpdGhleHBsYW5hdGlvbiksXHJcbiAgICAgICAgICAgICAgICBcIndpdGhleHBsYW5hdGlvbnF1YWxpdHlcIjogaXNfdXNlcl9jb3JyZWN0KHVzZXJzZWxlY3Rpb25fd2l0aGV4cGxhbmF0aW9ucXVhbGl0eSlcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgXCJiYWxhbmNlXCI6IHtcclxuICAgICAgICAgICAgICAgIFwib2xkXCI6IG9sZF9iYWxhbmNlLFxyXG4gICAgICAgICAgICAgICAgXCJuZXdcIjogYmFsYW5jZVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBsb2dnZWRfZGF0YVsncXVlc3Rpb24nXSA9IHF1ZXN0aW9uXHJcbiAgICAgICAgbG9nZ2VkX2RhdGFbJ2NvdW50X2V4aXRlZF9wYWdlJ10gPSBjb3VudF9leGl0ZWRfcGFnZVxyXG4gICAgICAgIGxvZ19kYXRhKGxvZ2dlZF9kYXRhKVxyXG4gICAgICAgIGNvdW50X2V4aXRlZF9wYWdlID0gMFxyXG4gICAgfVxyXG4gICAgXHJcblxyXG4gICAgbmV4dF9xdWVzdGlvbigpXHJcbn0pO1xyXG5cclxuXHJcblxyXG5mdW5jdGlvbiBpc191c2VyX2NvcnJlY3Qoc2VsZWN0aW9uKSB7XHJcbiAgICBpZiAoc2VsZWN0aW9uICE9IDIpIHtcclxuICAgICAgICBsZXQgY29ycmVjdF9zZWxlY3Rpb24gPSAxIC0gcXVlc3Rpb25bXCJwcmVkaWN0aW9uX2lzX2NvcnJlY3RcIl0gLy8gMCBpZiBBSSBpcyBjb3JyZWN0LCAxIGlmIGluY29ycmVjdFxyXG4gICAgICAgIHJldHVybiBzZWxlY3Rpb24gPT0gY29ycmVjdF9zZWxlY3Rpb24gPyAxIDogMFxyXG4gICAgfVxyXG4gICAgcmV0dXJuIC0xXHJcbn1cclxuXHJcbmZ1bmN0aW9uIHVwZGF0ZV9iYWxhbmNlKCkge1xyXG4gICAgaWYgKHVzZXJzZWxlY3Rpb25fd2l0aGV4cGxhbmF0aW9ucXVhbGl0eSAhPSAyKSB7XHJcbiAgICAgICAgbGV0IGNvcnJlY3Rfc2VsZWN0aW9uID0gMSAtIHF1ZXN0aW9uW1wicHJlZGljdGlvbl9pc19jb3JyZWN0XCJdIC8vIDAgaWYgQUkgaXMgY29ycmVjdCwgMSBpZiBpbmNvcnJlY3RcclxuICAgICAgICBpZiAodXNlcnNlbGVjdGlvbl93aXRoZXhwbGFuYXRpb25xdWFsaXR5ID09IGNvcnJlY3Rfc2VsZWN0aW9uKSB7XHJcbiAgICAgICAgICAgIGJhbGFuY2UgKz0gYmFsYW5jZV9pbmNyZW1lbnRcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIG5leHRfcXVlc3Rpb24oKSB7XHJcbiAgICAvLyByZXN0b3JlIHByZXZpb3VzIHN0YXRlIG9mIFVJXHJcblxyXG4gICAgJChcIiNidXR0b25fcmVhZHl0b2Fuc3dlclwiKS5yZW1vdmVBdHRyKFwiYWN0aXZlZGVjaXNpb25cIilcclxuICAgICQoXCIjYnV0dG9uX3JlYWR5dG9hbnN3ZXJcIikucmVtb3ZlQXR0cihcImRpc2FibGVkXCIpXHJcbiAgICAkKFwiI2J1dHRvbl9yZWFkeXRvYW5zd2VyXCIpLnNob3coKVxyXG5cclxuICAgICQoXCIjYnV0dG9uX2Fuc3dlcm9ubHlfdXNlcnRydXN0c1wiKS5yZW1vdmVBdHRyKFwiYWN0aXZlZGVjaXNpb25cIilcclxuICAgICQoXCIjYnV0dG9uX2Fuc3dlcm9ubHlfdXNlcnRydXN0c1wiKS5yZW1vdmVBdHRyKFwiZGlzYWJsZWRcIilcclxuICAgICQoXCIjYnV0dG9uX2Fuc3dlcm9ubHlfdXNlcmRpc3RydXN0c1wiKS5yZW1vdmVBdHRyKFwiYWN0aXZlZGVjaXNpb25cIilcclxuICAgICQoXCIjYnV0dG9uX2Fuc3dlcm9ubHlfdXNlcmRpc3RydXN0c1wiKS5yZW1vdmVBdHRyKFwiZGlzYWJsZWRcIilcclxuICAgICQoXCIjYnV0dG9uX2Fuc3dlcm9ubHlfdXNlcnVuc3VyZVwiKS5yZW1vdmVBdHRyKFwiYWN0aXZlZGVjaXNpb25cIilcclxuICAgICQoXCIjYnV0dG9uX2Fuc3dlcm9ubHlfdXNlcnVuc3VyZVwiKS5yZW1vdmVBdHRyKFwiZGlzYWJsZWRcIilcclxuXHJcbiAgICAkKFwiI2J1dHRvbl93aXRoZXhwbGFuYXRpb25fdXNlcnRydXN0c1wiKS5yZW1vdmVBdHRyKFwiYWN0aXZlZGVjaXNpb25cIilcclxuICAgICQoXCIjYnV0dG9uX3dpdGhleHBsYW5hdGlvbl91c2VydHJ1c3RzXCIpLnJlbW92ZUF0dHIoXCJkaXNhYmxlZFwiKVxyXG4gICAgJChcIiNidXR0b25fd2l0aGV4cGxhbmF0aW9uX3VzZXJkaXN0cnVzdHNcIikucmVtb3ZlQXR0cihcImFjdGl2ZWRlY2lzaW9uXCIpXHJcbiAgICAkKFwiI2J1dHRvbl93aXRoZXhwbGFuYXRpb25fdXNlcmRpc3RydXN0c1wiKS5yZW1vdmVBdHRyKFwiZGlzYWJsZWRcIilcclxuICAgICQoXCIjYnV0dG9uX3dpdGhleHBsYW5hdGlvbl91c2VydW5zdXJlXCIpLnJlbW92ZUF0dHIoXCJhY3RpdmVkZWNpc2lvblwiKVxyXG4gICAgJChcIiNidXR0b25fd2l0aGV4cGxhbmF0aW9uX3VzZXJ1bnN1cmVcIikucmVtb3ZlQXR0cihcImRpc2FibGVkXCIpXHJcblxyXG4gICAgJChcIiNidXR0b25fd2l0aGV4cGxhbmF0aW9ucXVhbGl0eV91c2VydHJ1c3RzXCIpLnJlbW92ZUF0dHIoXCJhY3RpdmVkZWNpc2lvblwiKVxyXG4gICAgJChcIiNidXR0b25fd2l0aGV4cGxhbmF0aW9ucXVhbGl0eV91c2VydHJ1c3RzXCIpLnJlbW92ZUF0dHIoXCJkaXNhYmxlZFwiKVxyXG4gICAgJChcIiNidXR0b25fd2l0aGV4cGxhbmF0aW9ucXVhbGl0eV91c2VyZGlzdHJ1c3RzXCIpLnJlbW92ZUF0dHIoXCJhY3RpdmVkZWNpc2lvblwiKVxyXG4gICAgJChcIiNidXR0b25fd2l0aGV4cGxhbmF0aW9ucXVhbGl0eV91c2VyZGlzdHJ1c3RzXCIpLnJlbW92ZUF0dHIoXCJkaXNhYmxlZFwiKVxyXG4gICAgJChcIiNidXR0b25fd2l0aGV4cGxhbmF0aW9ucXVhbGl0eV91c2VydW5zdXJlXCIpLnJlbW92ZUF0dHIoXCJhY3RpdmVkZWNpc2lvblwiKVxyXG4gICAgJChcIiNidXR0b25fd2l0aGV4cGxhbmF0aW9ucXVhbGl0eV91c2VydW5zdXJlXCIpLnJlbW92ZUF0dHIoXCJkaXNhYmxlZFwiKVxyXG5cclxuICAgICQoXCIjYWlfZXhwbGFuYXRpb25fZGl2XCIpLmhpZGUoKVxyXG4gICAgJChcIiNhaV9leHBsYW5hdGlvbl9xdWFsaXR5X2RpdlwiKS5oaWRlKClcclxuICAgIFxyXG5cclxuICAgICQoXCIjYnV0dG9uX25leHRcIikuaGlkZSgpXHJcbiAgICAkKCcjYnV0dG9uX3F1aXQnKS5oaWRlKClcclxuICAgIC8vJChcIiNyYW5nZV92YWxcIikudmFsKHVzZXJfdHJ1c3QpXHJcblxyXG4gICAgcXVlc3Rpb25faSArPSAxO1xyXG4gICAgaWYgKHF1ZXN0aW9uX2kgPj0gZGF0YS5sZW5ndGgpIHtcclxuICAgICAgICAvLyBIaWRlIHRoZSBleHBlcmltZW50IGNvbnRhaW5lci5cclxuICAgICAgICAkKFwiI21haW5fYm94X2V4cGVyaW1lbnRcIikuaGlkZSgpO1xyXG4gICAgICAgICQoXCIjcXVhbGl0YXRpdmVfc2VjdGlvblwiKS5zaG93KCk7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG5cclxuICAgIFxyXG4gICAgLy8gUmV0cmlldmUgdGhlIGN1cnJlbnQgcXVlc3Rpb24gb2JqZWN0LlxyXG4gICAgcXVlc3Rpb24gPSBkYXRhW3F1ZXN0aW9uX2ldO1xyXG4gICAgXHJcbiAgICAvLyBBbHdheXMgc2hvdyBQYXJ0IDEgYW5kIGhpZGUgUGFydCAyIHdoZW4gYSBuZXcgcXVlc3Rpb24gbG9hZHMuXHJcbiAgICAkKFwiI3BhcnQxXCIpLnNob3coKTtcclxuICAgICQoXCIjcGFydDJcIikuaGlkZSgpO1xyXG4gICAgXHJcbiAgICAvLyAtLS0gVXBkYXRlIFBhcnQgMSBlbGVtZW50cyAtLS1cclxuICAgIC8vIEZvciB0aGUgaW1hZ2U6IGFzc3VtZSBhIHZhbGlkIEJhc2U2NCBzdHJpbmcgZm9yIG5vdy5cclxuICAgIGlmIChxdWVzdGlvbltcImltYWdlXCJdKSB7XHJcbiAgICAgICQoXCIjcXVlc3Rpb25faW1hZ2VcIikuYXR0cihcInNyY1wiLCBcImRhdGE6aW1hZ2UvcG5nO2Jhc2U2NCxcIiArIHF1ZXN0aW9uW1wiaW1hZ2VcIl0pO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgJChcIiNxdWVzdGlvbl9pbWFnZVwiKS5hdHRyKFwic3JjXCIsIFwiXCIpO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyBEaXNwbGF5IHRoZSBwcmVkaWN0ZWQgdGV4dC5cclxuICAgIC8vIEJ1aWxkIHRoZSBwcmVkaWN0ZWQgdGV4dCBIVE1MIGJ5IGNvbmNhdGVuYXRpbmcgdG9rZW5faW5mb1xyXG4gICAgbGV0IHByZWRpY3RlZEh0bWwgPSBcIlwiO1xyXG4gICAgaWYgKHF1ZXN0aW9uW1widG9rZW5faW5mb1wiXSAmJiBBcnJheS5pc0FycmF5KHF1ZXN0aW9uW1widG9rZW5faW5mb1wiXSkpIHtcclxuICAgICAgICBwcmVkaWN0ZWRIdG1sID0gcXVlc3Rpb25bXCJ0b2tlbl9pbmZvXCJdXHJcbiAgICAgICAgICAgIC8vIFNraXAgdGhlIGVuZCB0b2tlblxyXG4gICAgICAgICAgICAuZmlsdGVyKGl0ZW0gPT4gaXRlbS50b2tlbiAhPT0gXCI8fGltX2VuZHw+XCIpXHJcbiAgICAgICAgICAgIC5tYXAoaXRlbSA9PiB7XHJcbiAgICAgICAgICAgICAgICAvLyBSZXBsYWNlIHRoZSBzcGVjaWFsIFwixKBcIiBjaGFyYWN0ZXIgd2l0aCBhIHNwYWNlXHJcbiAgICAgICAgICAgICAgICBsZXQgdG9rZW5UZXh0ID0gaXRlbS50b2tlbi5yZXBsYWNlKC/EoC9nLCBcIiBcIik7XHJcbiAgICAgICAgICAgICAgICAvLyBHZXQgdGhlIHByb2JhYmlsaXR5IGZyb20gdGhlIGZpcnN0IGNhbmRpZGF0ZSBpbiB0b3BfNV90b2tlbnMuXHJcbiAgICAgICAgICAgICAgICAvLyBJZiBub3QgYXZhaWxhYmxlLCBkZWZhdWx0IHRvIDEgKG5vIGhpZ2hsaWdodCkuXHJcbiAgICAgICAgICAgICAgICBsZXQgcHJvYiA9IChpdGVtLnRvcF81X3Rva2VucyAmJlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlbS50b3BfNV90b2tlbnNbMF0gJiZcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGVvZiBpdGVtLnRvcF81X3Rva2Vuc1swXS5wcm9iYWJpbGl0eSA9PT0gXCJudW1iZXJcIilcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gaXRlbS50b3BfNV90b2tlbnNbMF0ucHJvYmFiaWxpdHlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogMTtcclxuICAgICAgICAgICAgICAgIC8vIENvbXB1dGUgdGhlIGhpZ2hsaWdodCBpbnRlbnNpdHkgKDAgaWYgcHJvYmFiaWxpdHkgaXMgMSwgMSBpZiBwcm9iYWJpbGl0eSBpcyAwKVxyXG4gICAgICAgICAgICAgICAgbGV0IGludGVuc2l0eSA9IDEgLSBwcm9iO1xyXG4gICAgICAgICAgICAgICAgLy8gQ3JlYXRlIGEgc3BhbiB3aXRoIHJlZCBiYWNrZ3JvdW5kOyBhZGp1c3QgdGhlIG9wYWNpdHkgYnkgaW50ZW5zaXR5LlxyXG4gICAgICAgICAgICAgICAgaWYgKHF1ZXN0aW9uW1wiaXNfaGlnaGxpZ2h0ZWRcIl0gPT0gMSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBgPHNwYW4gc3R5bGU9XCJiYWNrZ3JvdW5kLWNvbG9yOiByZ2JhKDI1NSwgMCwgMCwgJHtpbnRlbnNpdHl9KTtcIj4ke3Rva2VuVGV4dH08L3NwYW4+YDtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRva2VuVGV4dDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLmpvaW4oJycpO1xyXG4gICAgfVxyXG4gICAgJChcIiNwcmVkaWN0ZWRfdGV4dFwiKS5odG1sKHByZWRpY3RlZEh0bWwpO1xyXG5cclxuICAgIGlmIChxdWVzdGlvbltcImlzX2hpZ2hsaWdodGVkXCJdID09IDEpIHtcclxuICAgICAgICAkKFwiI3ByZWRpY3RlZF90ZXh0X2NvbnRhaW5lciBzdHJvbmdcIikuYWRkQ2xhc3MoXCJoaWdobGlnaHRlZC10aXRsZVwiKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICAkKFwiI3ByZWRpY3RlZF90ZXh0X2NvbnRhaW5lciBzdHJvbmdcIikucmVtb3ZlQ2xhc3MoXCJoaWdobGlnaHRlZC10aXRsZVwiKTtcclxuICAgICAgfVxyXG4gICAgICBcclxuICAgIFxyXG4gICAgLy8gQ29uY2F0ZW5hdGUgdG9rZW5zICh3aXRoIHJlcGxhY2VtZW50IG9mIMSgIGFuZCBza2lwcGluZyA8fGltX2VuZHw+KS5cclxuICAgIGxldCB0b2tlbnNDb25jYXRlbmF0ZWQgPSBcIlwiO1xyXG4gICAgaWYgKHF1ZXN0aW9uW1widG9rZW5faW5mb1wiXSAmJiBBcnJheS5pc0FycmF5KHF1ZXN0aW9uW1widG9rZW5faW5mb1wiXSkpIHtcclxuICAgICAgICB0b2tlbnNDb25jYXRlbmF0ZWQgPSBxdWVzdGlvbltcInRva2VuX2luZm9cIl1cclxuICAgICAgICAgIC5tYXAoaXRlbSA9PiBpdGVtLnRva2VuKVxyXG4gICAgICAgICAgLmZpbHRlcih0b2tlbiA9PiB0b2tlbiAhPT0gXCI8fGltX2VuZHw+XCIpXHJcbiAgICAgICAgICAubWFwKHRva2VuID0+IHRva2VuLnJlcGxhY2UoL8SgL2csIFwiIFwiKSlcclxuICAgICAgICAgIC5qb2luKCcnKTtcclxuICAgIH1cclxuICAgICQoXCIjdG9rZW5faW5wdXRcIikudmFsKHRva2Vuc0NvbmNhdGVuYXRlZCk7XHJcbiAgICBcclxuICAgIC8vIChVcGRhdGUgcHJvZ3Jlc3MgYW5kIG90aGVyIGVsZW1lbnRzIGFzIG5lY2Vzc2FyeSlcclxuICAgICQoXCIjcHJvZ3Jlc3NcIikudGV4dChgUHJvZ3Jlc3M6ICR7cXVlc3Rpb25faSArIDF9IC8gJHtkYXRhLmxlbmd0aH1gKTtcclxuXHJcbi8vIEF0IHRoZSBlbmQgb2YgbmV4dF9xdWVzdGlvbigpLCBhZnRlciB1cGRhdGluZyBhbGwgUGFydCAxIGVsZW1lbnRzOlxyXG4kKFwiI3Rva2VuX2lucHV0X2NvbnRhaW5lclwiKS5oaWRlKCk7XHJcbiQoXCIjYnV0dG9uX25leHRfcGFydDFcIikuaGlkZSgpO1xyXG5cclxuLy8gU3RhcnQgYSAyMC1zZWNvbmQgdGltZXIgZm9yIFBhcnQgMVxyXG5jbGVhclRpbWVvdXQocGFydDFUaW1lcik7XHJcbnBhcnQxVGltZXIgPSB3aW5kb3cuc2V0VGltZW91dChhdXRvU3VibWl0UGFydDEsIDIwMDAwKTtcclxuXHJcbi8vIFJlc2V0IGFuZCBzdGFydCB0aGUgdGltZXIgZm9yIFBhcnQgMVxyXG5yZW1haW5pbmdUaW1lID0gMjA7XHJcbiQoXCIjdGltZXJcIikudGV4dChyZW1haW5pbmdUaW1lKTtcclxuJChcIiN0aW1lclwiKS5zaG93KCk7XHJcblxyXG4vLyBDbGVhciBhbnkgcHJldmlvdXMgaW50ZXJ2YWxcclxuaWYgKHBhcnQxSW50ZXJ2YWwpIHtcclxuICAgIGNsZWFySW50ZXJ2YWwocGFydDFJbnRlcnZhbCk7XHJcbn1cclxuXHJcbi8vIFN0YXJ0IGEgbmV3IGludGVydmFsIHRoYXQgY291bnRzIGRvd24gZXZlcnkgc2Vjb25kXHJcbnBhcnQxSW50ZXJ2YWwgPSB3aW5kb3cuc2V0SW50ZXJ2YWwoKCkgPT4ge1xyXG4gICAgcmVtYWluaW5nVGltZSAtPSAxO1xyXG4gICAgJChcIiN0aW1lclwiKS50ZXh0KHJlbWFpbmluZ1RpbWUpO1xyXG5cclxuICAgIC8vIFdoZW4gdGhlcmUgYXJlIDE1IHNlY29uZHMgb3IgbGVzcyByZW1haW5pbmcsIHNob3cgdGhlIGlucHV0IGJveCBhbmQgTmV4dCBidXR0b25cclxuICAgIGlmIChyZW1haW5pbmdUaW1lIDw9IDE1KSB7XHJcbiAgICAgICAgJChcIiN0b2tlbl9pbnB1dF9jb250YWluZXJcIikuc2hvdygpO1xyXG4gICAgICAgICQoXCIjYnV0dG9uX25leHRfcGFydDFcIikuc2hvdygpO1xyXG4gICAgfVxyXG5cclxuICAgIGlmIChyZW1haW5pbmdUaW1lIDw9IDApIHtcclxuICAgICAgICBjbGVhckludGVydmFsKHBhcnQxSW50ZXJ2YWwpO1xyXG4gICAgICAgIGF1dG9TdWJtaXRQYXJ0MSgpO1xyXG4gICAgICAgICQoXCIjdGltZXJcIikuaGlkZSgpO1xyXG4gICAgfVxyXG59LCAxMDAwKTtcclxuXHJcblxyXG59XHJcblxyXG4vLyBnZXQgdXNlciBpZCBhbmQgbG9hZCBxdWV1ZVxyXG4vLyB0cnkgdG8gc2VlIGlmIHN0YXJ0IG92ZXJyaWRlIHdhcyBwYXNzZWRcclxuY29uc3QgdXJsUGFyYW1zID0gbmV3IFVSTFNlYXJjaFBhcmFtcyh3aW5kb3cubG9jYXRpb24uc2VhcmNoKTtcclxuY29uc3Qgc3RhcnRPdmVycmlkZSA9IHVybFBhcmFtcy5nZXQoJ3N0YXJ0Jyk7XHJcbmNvbnN0IFVJREZyb21VUkwgPSB1cmxQYXJhbXMuZ2V0KFwidWlkXCIpXHJcbmdsb2JhbFRoaXMudXJsX2RhdGEgPSBwYXJhbXNUb09iamVjdCh1cmxQYXJhbXMuZW50cmllcygpKVxyXG5cclxuaWYgKGdsb2JhbFRoaXMudXJsX2RhdGFbJ3N0dWR5X2lkJ10gPT0gbnVsbCkge1xyXG4gICAgZ2xvYmFsVGhpcy51cmxfZGF0YVsnc3R1ZHlfaWQnXSA9IFwiZGVtb19zdHVkeVwiXHJcbn1cclxuaWYgKGdsb2JhbFRoaXMudXJsX2RhdGFbJ3Byb2xpZmljX2lkJ10gPT0gbnVsbCkge1xyXG4gICAgZ2xvYmFsVGhpcy51cmxfZGF0YVsncHJvbGlmaWNfaWQnXSA9IFwiZGVtb191c2VyXCJcclxufVxyXG5pZiAoZ2xvYmFsVGhpcy51cmxfZGF0YVsnc2Vzc2lvbl9pZCddID09IG51bGwpIHtcclxuICAgIGdsb2JhbFRoaXMudXJsX2RhdGFbJ3Nlc3Npb25faWQnXSA9IFwiZGVtb19zZXNzaW9uXCJcclxufVxyXG5cclxuaWYgKFVJREZyb21VUkwgIT0gbnVsbCkge1xyXG4gICAgZ2xvYmFsVGhpcy51aWQgPSBVSURGcm9tVVJMIGFzIHN0cmluZ1xyXG4gICAgaWYgKGdsb2JhbFRoaXMudWlkID09IFwicHJvbGlmaWNfcmFuZG9tXCIpIHtcclxuICAgICAgICBsZXQgcXVldWVfaWQgPSBgJHtNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMCl9YC5wYWRTdGFydCgzLCBcIjBcIilcclxuICAgICAgICBnbG9iYWxUaGlzLnVpZCA9IGAke3VybFBhcmFtcy5nZXQoXCJwcm9saWZpY19xdWV1ZV9uYW1lXCIpfS8ke3F1ZXVlX2lkfWBcclxuICAgIH1cclxufSBlbHNlIGlmIChERVZNT0RFKSB7XHJcbiAgICBnbG9iYWxUaGlzLnVpZCA9IFwiZGVtb1wiXHJcbn0gZWxzZSB7XHJcbiAgICBsZXQgVUlEX21heWJlOiBhbnkgPSBudWxsXHJcbiAgICB3aGlsZSAoVUlEX21heWJlID09IG51bGwpIHtcclxuICAgICAgICBVSURfbWF5YmUgPSBwcm9tcHQoXCJFbnRlciB5b3VyIHVzZXIgaWQuIFBsZWFzZSBnZXQgaW4gdG91Y2ggaWYgeW91IHdlcmUgbm90IGFzc2lnbmVkIGFuIGlkIGJ1dCB3aXNoIHRvIHBhcnRpY2lwYXRlIGluIHRoaXMgZXhwZXJpbWVudC5cIilcclxuICAgIH1cclxuICAgIGdsb2JhbFRoaXMudWlkID0gVUlEX21heWJlIVxyXG59XHJcblxyXG4vLyB2ZXJzaW9uIGZvciBwYXBlclxyXG5pZiAoREVWTU9ERSkge1xyXG4gICAgTU9DS01PREUgPSB0cnVlXHJcbn0gZWxzZSBpZiAoZ2xvYmFsVGhpcy51cmxfZGF0YVsnc2Vzc2lvbl9pZCddLnN0YXJ0c1dpdGgoXCJkZW1vXCIpKSB7XHJcbiAgICBNT0NLTU9ERSA9IHRydWVcclxufVxyXG5cclxuY29uc29sZS5sb2coXCJSdW5uaW5nIHdpdGggVUlEXCIsIGdsb2JhbFRoaXMudWlkKVxyXG5sb2FkX2RhdGEoKS5jYXRjaCgoX2Vycm9yKSA9PiB7XHJcbiAgICAvL2FsZXJ0KFwiSW52YWxpZCB1c2VyIGlkLlwiKVxyXG4gICAgY29uc29sZS5sb2coXCJJbnZhbGlkIHVzZXIgaWQuXCIpXHJcbiAgICBjb25zb2xlLmxvZyhnbG9iYWxUaGlzLnVpZCEpXHJcbiAgICB3aW5kb3cubG9jYXRpb24ucmVsb2FkKClcclxufVxyXG4pLnRoZW4oKG5ld19kYXRhKSA9PiB7XHJcbiAgICBkYXRhID0gbmV3X2RhdGFcclxuICAgIGlmIChzdGFydE92ZXJyaWRlICE9IG51bGwpIHtcclxuICAgICAgICBxdWVzdGlvbl9pID0gcGFyc2VJbnQoc3RhcnRPdmVycmlkZSkgLSAxXHJcbiAgICAgICAgY29uc29sZS5sb2coXCJTdGFydGluZyBmcm9tXCIsIHF1ZXN0aW9uX2kpXHJcbiAgICB9XHJcbiAgICAvLyBuZXh0X3F1ZXN0aW9uKClcclxuICAgIG5leHRfaW5zdHJ1Y3Rpb25zKDApXHJcbiAgICAkKFwiI21haW5fYm94X2luc3RydWN0aW9uc1wiKS5zaG93KClcclxuICAgICQoXCIjaW5zdHJ1Y3Rpb25zX2FuZF9kZWNvcmF0aW9uc1wiKS5oaWRlKClcclxufSlcclxuXHJcbmNvbnNvbGUubG9nKFwiU3RhcnRpbmcgc2Vzc2lvbiB3aXRoIFVJRDpcIiwgZ2xvYmFsVGhpcy51aWQhKVxyXG5cclxubGV0IGFsZXJ0X2FjdGl2ZSA9IGZhbHNlXHJcbmRvY3VtZW50Lm9udmlzaWJpbGl0eWNoYW5nZSA9ICgpID0+IHtcclxuICAgIGlmICghYWxlcnRfYWN0aXZlKSB7XHJcbiAgICAgICAgY291bnRfZXhpdGVkX3BhZ2UgKz0gMVxyXG4gICAgICAgIGFsZXJ0X2FjdGl2ZSA9IHRydWVcclxuICAgICAgICAvL2lmICghKGdsb2JhbFRoaXMudWlkIS5zdGFydHNXaXRoKFwiZGVtb1wiKSkpIHtcclxuICAgICAgICAvLyAgICBhbGVydChcIlBsZWFzZSBkb24ndCBsZWF2ZSB0aGUgcGFnZS4gSWYgeW91IGRvIHNvIGFnYWluLCB3ZSBtYXkgcmVzdHJpY3QgcGF5aW5nIHlvdS5cIilcclxuICAgICAgICAvL31cclxuICAgICAgICBhbGVydF9hY3RpdmUgPSBmYWxzZVxyXG4gICAgfVxyXG59XHJcblxyXG4vLyBXaGVuIHRoZSBET00gaXMgcmVhZHk6XHJcbiQoZG9jdW1lbnQpLnJlYWR5KCgpID0+IHtcclxuICAgIC8vIFRyYW5zaXRpb24gZnJvbSBQYXJ0IDEgKHF1ZXN0aW9uKSB0byBQYXJ0IDIgKGNvbmZpZGVuY2UgcmF0aW5nKVxyXG4gICAgJChcIiNidXR0b25fbmV4dF9wYXJ0MVwiKS5vbihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgLy8gT3B0aW9uYWxseSwgbG9nIG9yIHNhdmUgYW55IFBhcnQgMSBkYXRhIGhlcmUuXHJcbiAgICAgIGNsZWFyVGltZW91dChwYXJ0MVRpbWVyKTtcclxuICAgICAgJChcIiN0aW1lclwiKS5oaWRlKCk7XHJcblxyXG5cclxuICAgICAgJChcIiNwYXJ0MVwiKS5oaWRlKCk7XHJcbiAgICAgICQoXCIjcGFydDJcIikuc2hvdygpO1xyXG4gICAgfSk7XHJcbiAgXHJcbiAgICAvLyBIYW5kbGUgY29uZmlkZW5jZSByYXRpbmcgc2VsZWN0aW9uczpcclxuICAgICQoXCIuY29uZmlkZW5jZS1idXR0b25cIikub24oXCJjbGlja1wiLCBmdW5jdGlvbigpIHtcclxuICAgICAgICBsZXQgcmF0aW5nID0gcGFyc2VJbnQoJCh0aGlzKS5hdHRyKFwiZGF0YS1yYXRpbmdcIikgYXMgc3RyaW5nKTtcclxuICAgICAgICAvLyBSZW1vdmUgJ3NlbGVjdGVkJyBmcm9tIGFsbCBidXR0b25zLCB0aGVuIGFkZCBpdCB0byB0aGUgY2xpY2tlZCBvbmUuXHJcbiAgICAgICAgJChcIi5jb25maWRlbmNlLWJ1dHRvblwiKS5yZW1vdmVDbGFzcyhcInNlbGVjdGVkXCIpO1xyXG4gICAgICAgICQodGhpcykuYWRkQ2xhc3MoXCJzZWxlY3RlZFwiKTtcclxuICAgICAgICAvLyBTdG9yZSB0aGUgcmF0aW5nIGFuZCBlbmFibGUgdGhlIFBhcnQgMiBOZXh0IGJ1dHRvbi5cclxuICAgICAgICBjb25maWRlbmNlUmF0aW5nID0gcmF0aW5nO1xyXG4gICAgICAgICQoXCIjYnV0dG9uX25leHRfcGFydDJcIikucmVtb3ZlQXR0cihcImRpc2FibGVkXCIpO1xyXG4gICAgfSk7XHJcbiAgXHJcbiAgICAvLyBUcmFuc2l0aW9uIGZyb20gUGFydCAyIChjb25maWRlbmNlIHJhdGluZykgdG8gdGhlIG5leHQgcXVlc3Rpb24uXHJcbiAgICAkKFwiI2J1dHRvbl9uZXh0X3BhcnQyXCIpLm9uKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICAvLyBMb2cgdGhlIGNvbmZpZGVuY2UgcmF0aW5nIGFsb25nIHdpdGggb3RoZXIgZGF0YSBpZiBuZWVkZWQuXHJcbiAgICAgIGxldCBsb2dnZWRfZGF0YSA9IHtcclxuICAgICAgICBcInF1ZXN0aW9uX2lcIjogcXVlc3Rpb25faSxcclxuICAgICAgICBcImNvbmZpZGVuY2VfcmF0aW5nXCI6IGNvbmZpZGVuY2VSYXRpbmcsXHJcbiAgICAgICAgLy8gLi4uIGluY2x1ZGUgb3RoZXIgbG9nZ2luZyBmaWVsZHMgYXMgZGVzaXJlZFxyXG4gICAgICB9O1xyXG4gICAgICBsb2dfZGF0YShsb2dnZWRfZGF0YSk7XHJcbiAgICAgIFxyXG4gICAgICAvLyBSZXNldCBQYXJ0IDIgVUkgZWxlbWVudHMgZm9yIHRoZSBuZXh0IHF1ZXN0aW9uLlxyXG4gICAgICAkKFwiI2J1dHRvbl9uZXh0X3BhcnQyXCIpLmF0dHIoXCJkaXNhYmxlZFwiLCBcInRydWVcIik7XHJcbiAgICAgICQoXCIuY29uZmlkZW5jZS1idXR0b25cIikucmVtb3ZlQ2xhc3MoXCJzZWxlY3RlZFwiKTtcclxuICAgICAgY29uZmlkZW5jZVJhdGluZyA9IC0xO1xyXG4gICAgICBcclxuICAgICAgLy8gU3dpdGNoIGJhY2sgdG8gUGFydCAxIGFuZCBsb2FkIHRoZSBuZXh0IHF1ZXN0aW9uLlxyXG4gICAgICAkKFwiI3BhcnQyXCIpLmhpZGUoKTtcclxuICAgICAgJChcIiNwYXJ0MVwiKS5zaG93KCk7XHJcbiAgICAgIG5leHRfcXVlc3Rpb24oKTtcclxuICAgIH0pO1xyXG4gICAgJChcImlucHV0W25hbWU9J2xhdGV4RXhwZXJpZW5jZSddLCBpbnB1dFtuYW1lPSdsYXRleEZyZXF1ZW5jeSddLCBpbnB1dFtuYW1lPSdjaGF0Ym90RnJlcXVlbmN5J11cIikub24oXCJjaGFuZ2VcIiwgKCkgPT4ge1xyXG4gICAgICAgIGlmKGNoZWNrUHJlU3VydmV5KCkpIHtcclxuICAgICAgICAgICAgJChcIiNidXR0b25faW5zdHJ1Y3Rpb25zX25leHRcIikucmVtb3ZlQXR0cihcImRpc2FibGVkXCIpXHJcbiAgICAgICAgICAgICQoXCIjYnV0dG9uX2luc3RydWN0aW9uc19uZXh0XCIpLnNob3coKSAgICAgICAgICAgIFxyXG4gICAgICAgIH1cclxuXHJcbiAgICB9KTtcclxuXHJcbn0pO1xyXG4gIGZ1bmN0aW9uIGF1dG9TdWJtaXRQYXJ0MSgpIHtcclxuICAgIC8vIFN0b3AgdGhlIHRpbWVyIGlmIG5vdCBhbHJlYWR5IGNsZWFyZWRcclxuICAgIGNsZWFySW50ZXJ2YWwocGFydDFJbnRlcnZhbCk7XHJcbiAgICAkKFwiI3RpbWVyXCIpLmhpZGUoKTtcclxuICAgIFxyXG4gICAgLy8gQXV0b21hdGljYWxseSB0cmFuc2l0aW9uIHRvIFBhcnQgMlxyXG4gICAgJChcIiNwYXJ0MVwiKS5oaWRlKCk7XHJcbiAgICAkKFwiI3BhcnQyXCIpLnNob3coKTtcclxufVxyXG4kKFwiI3F1YWxfbmV4dFwiKS5vbihcImNsaWNrXCIsICgpID0+IHtcclxuICAgIGNvbnN0IHExID0gKCQoXCIjcXVhbF9xMVwiKS52YWwoKSBhcyBzdHJpbmcpIHx8IFwiXCI7XHJcbiAgICBjb25zdCBxMiA9ICgkKFwiI3F1YWxfcTJcIikudmFsKCkgYXMgc3RyaW5nKSB8fCBcIlwiO1xyXG4gICAgY29uc3QgcTMgPSAoJChcIiNxdWFsX3EzXCIpLnZhbCgpIGFzIHN0cmluZykgfHwgXCJcIjtcclxuICAgIFxyXG4gICAgbGV0IHZhbGlkID0gdHJ1ZTtcclxuICAgIFxyXG4gICAgaWYgKHExLmxlbmd0aCA8IDI1KSB7XHJcbiAgICAgICAgJChcIiN3YXJuX3ExXCIpLnNob3coKTtcclxuICAgICAgICB2YWxpZCA9IGZhbHNlO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICAkKFwiI3dhcm5fcTFcIikuaGlkZSgpO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBpZiAocTIubGVuZ3RoIDwgMjUpIHtcclxuICAgICAgICAkKFwiI3dhcm5fcTJcIikuc2hvdygpO1xyXG4gICAgICAgIHZhbGlkID0gZmFsc2U7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgICQoXCIjd2Fybl9xMlwiKS5oaWRlKCk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGlmIChxMy5sZW5ndGggPCAwKSB7XHJcbiAgICAgICAgJChcIiN3YXJuX3EzXCIpLnNob3coKTtcclxuICAgICAgICB2YWxpZCA9IGZhbHNlO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICAkKFwiI3dhcm5fcTNcIikuaGlkZSgpO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyBJZiB2YWxpZGF0aW9uIGZhaWxzLCBkbyBub3QgcHJvY2VlZFxyXG4gICAgaWYgKCF2YWxpZCkge1xyXG4gICAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8gSWYgYWxsIHRleHQgYm94ZXMgaGF2ZSBhdCBsZWFzdCA1MCBjaGFyYWN0ZXJzLCBsb2cgZGF0YSBhbmQgcHJvY2VlZFxyXG4gICAgY29uc3QgZmluYWxEYXRhID0ge1xyXG4gICAgICAgIHF1YWxpdGF0aXZlOiB7XHJcbiAgICAgICAgICAgIHExOiBxMSxcclxuICAgICAgICAgICAgcTI6IHEyLFxyXG4gICAgICAgICAgICBxMzogcTNcclxuICAgICAgICB9LFxyXG4gICAgICAgIC8vIC4uLiBpbmNsdWRlIGFueSBhZGRpdGlvbmFsIGRhdGEgaWYgbmVlZGVkXHJcbiAgICB9O1xyXG4gICAgbG9nX2RhdGEoZmluYWxEYXRhKTtcclxuICAgIFxyXG4gICAgLy8gVHJhbnNpdGlvbiB0byBlbmQtb2Ytc3VydmV5IOKAnFRoYW5rIHlvdeKAnSBzY3JlZW4gb3Igc2ltaWxhci5cclxuICAgICQoXCIjcXVhbGl0YXRpdmVfc2VjdGlvblwiKS5oaWRlKCk7XHJcbiAgICBpZiAoTU9DS01PREUpIHtcclxuICAgICAgICAkKCcjcmV3YXJkX2JveF9tb2NrJykudGV4dChgWW91ciB0b3RhbCByZXdhcmQgaXMgJCR7YmFsYW5jZS50b0ZpeGVkKDIpfSAoJHtxdWVzdGlvbl9pfSBxdWVzdGlvbnMgYW5zd2VyZWQpICsgJDIuYCk7XHJcbiAgICAgICAgJCgnI3Jld2FyZF9ib3hfbW9jaycpLnNob3coKTtcclxuICAgICAgICAkKFwiI21haW5fYm94X2VuZF9tb2NrXCIpLnNob3coKTsgICAgXHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgICQoJyNyZXdhcmRfYm94JykudGV4dChgWW91ciB0b3RhbCByZXdhcmQgaXMgJCR7YmFsYW5jZS50b0ZpeGVkKDIpfSAoJHtxdWVzdGlvbl9pfSBxdWVzdGlvbnMgYW5zd2VyZWQpICsgJDIuYCk7XHJcbiAgICAgICAgJCgnI3Jld2FyZF9ib3gnKS5zaG93KCk7XHJcbiAgICAgICAgJChcIiNtYWluX2JveF9lbmRcIikuc2hvdygpOyAgICBcclxuICAgIH1cclxufSk7XHJcbiIsImZ1bmN0aW9uIHBhcmFtc1RvT2JqZWN0KGVudHJpZXMpIHtcclxuICBjb25zdCByZXN1bHQgPSB7fVxyXG4gIC8vIGVhY2ggJ2VudHJ5JyBpcyBhIFtrZXksIHZhbHVlXSB0dXBwbGVcclxuICBmb3IgKGNvbnN0IFtrZXksIHZhbHVlXSBvZiBlbnRyaWVzKSB7XHJcbiAgICByZXN1bHRba2V5XSA9IHZhbHVlO1xyXG4gIH1cclxuICByZXR1cm4gcmVzdWx0O1xyXG59XHJcblxyXG5leHBvcnQgeyBwYXJhbXNUb09iamVjdCB9Il0sIm5hbWVzIjpbIlNFUlZFUl9MT0dfUk9PVCIsImFzeW5jIiwibG9nX2RhdGEiLCJkYXRhIiwiZ2xvYmFsVGhpcyIsInVybF9kYXRhIiwiY29uc29sZSIsImxvZyIsInVpZCIsInJlc3VsdCIsIiQiLCJhamF4IiwiSlNPTiIsInN0cmluZ2lmeSIsInByb2plY3QiLCJwYXlsb2FkIiwidHlwZSIsImNvbnRlbnRUeXBlIiwiUHJvbWlzZSIsInJlc29sdmUiLCJzZXRUaW1lb3V0Iiwic2xlZXAiLCJlIiwiTU9DS01PREUiLCJxdWVzdGlvbl9pIiwicXVlc3Rpb24iLCJ1c2Vyc2VsZWN0aW9uX2Fuc3dlcm9ubHkiLCJ1c2Vyc2VsZWN0aW9uX3dpdGhleHBsYW5hdGlvbiIsInVzZXJzZWxlY3Rpb25fd2l0aGV4cGxhbmF0aW9ucXVhbGl0eSIsImNvbmZpZGVuY2VSYXRpbmciLCJwYXJ0MVRpbWVyIiwicGFydDFJbnRlcnZhbCIsInJlbWFpbmluZ1RpbWUiLCJiYWxhbmNlIiwiaW5zdHJ1Y3Rpb25faSIsImNvdW50X2V4aXRlZF9wYWdlIiwicmVnaXN0ZXJBbnN3ZXJPbmx5VXNlclNlbGVjdGlvbiIsInVzZXJfY2hvaWNlIiwiYXR0ciIsInNob3ciLCJyZWdpc3RlcldpdGhFeHBsYW5hdGlvblVzZXJTZWxlY3Rpb24iLCJyZWdpc3RlcldpdGhFeHBsYW5hdGlvblF1YWxpdHlVc2VyU2VsZWN0aW9uIiwicmVtb3ZlQXR0ciIsImNoZWNrUHJlU3VydmV5IiwibGF0ZXhFeHAiLCJ2YWwiLCJsYXRleEZyZXEiLCJjaGF0Ym90RnJlcSIsImhpZGUiLCJuZXh0X2luc3RydWN0aW9ucyIsImluY3JlbWVudCIsIm5leHRfcXVlc3Rpb24iLCJjaGlsZHJlbiIsImVhY2giLCJfIiwiZWwiLCJpc191c2VyX2NvcnJlY3QiLCJzZWxlY3Rpb24iLCJsZW5ndGgiLCJwcmVkaWN0ZWRIdG1sIiwiQXJyYXkiLCJpc0FycmF5IiwiZmlsdGVyIiwiaXRlbSIsInRva2VuIiwibWFwIiwidG9rZW5UZXh0IiwicmVwbGFjZSIsImludGVuc2l0eSIsInRvcF81X3Rva2VucyIsInByb2JhYmlsaXR5Iiwiam9pbiIsImh0bWwiLCJhZGRDbGFzcyIsInJlbW92ZUNsYXNzIiwidG9rZW5zQ29uY2F0ZW5hdGVkIiwidGV4dCIsImNsZWFyVGltZW91dCIsIndpbmRvdyIsImF1dG9TdWJtaXRQYXJ0MSIsImNsZWFySW50ZXJ2YWwiLCJzZXRJbnRlcnZhbCIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJhZGRFdmVudExpc3RlbmVyIiwib24iLCJvbGRfYmFsYW5jZSIsImNvcnJlY3Rfc2VsZWN0aW9uIiwidXBkYXRlX2JhbGFuY2UiLCJsb2dnZWRfZGF0YSIsInVybFBhcmFtcyIsIlVSTFNlYXJjaFBhcmFtcyIsImxvY2F0aW9uIiwic2VhcmNoIiwic3RhcnRPdmVycmlkZSIsImdldCIsIlVJREZyb21VUkwiLCJlbnRyaWVzIiwia2V5IiwidmFsdWUiLCJwYXJhbXNUb09iamVjdCIsInF1ZXVlX2lkIiwiTWF0aCIsImZsb29yIiwicmFuZG9tIiwicGFkU3RhcnQiLCJVSURfbWF5YmUiLCJwcm9tcHQiLCJzdGFydHNXaXRoIiwiZ2V0SlNPTiIsIkRhdGUiLCJub3ciLCJsb2FkX2RhdGEiLCJjYXRjaCIsIl9lcnJvciIsInJlbG9hZCIsInRoZW4iLCJuZXdfZGF0YSIsInBhcnNlSW50IiwiYWxlcnRfYWN0aXZlIiwib252aXNpYmlsaXR5Y2hhbmdlIiwicmVhZHkiLCJyYXRpbmciLCJ0aGlzIiwicTEiLCJxMiIsInEzIiwidmFsaWQiLCJxdWFsaXRhdGl2ZSIsInRvRml4ZWQiXSwic291cmNlUm9vdCI6IiJ9