(()=>{"use strict";let t="https://matthewsalaway.pythonanywhere.com/";async function e(e){e.url_data=globalThis.url_data,console.log("Data"),"study_id"in e.url_data||(e.url_data.study_id="demo_study"),"prolific_id"in e.url_data||(e.url_data.prolific_id="demo_user"),"session_id"in e.url_data||(e.url_data.session_id="demo_session"),e.url_data.queue_id=globalThis.uid,console.log("logged",e),console.log("Logging to",t+"log");try{let n=await $.ajax(t+"log",{data:JSON.stringify({project:"ocr-calibration-study/"+e.url_data.study_id,uid:globalThis.uid+"_"+e.url_data.prolific_id,payload:JSON.stringify(e)}),type:"POST",contentType:"application/json"});return await async function(){return new Promise((t=>setTimeout(t,2e3)))}(),n}catch(t){console.log(t)}}function n(t){let e=t.replace(/\s+/g,"");return e=e.replace(/\\/g," \\"),e=e.replace(/([\+\-\=])/g," $1 "),e=e.replace(/\s+/g," "),e}var i=!1,o=[];let a=null,r=-1,s=0,l=0,c=20,d=0,u=0,_=!1,p=Date.now(),h=0,m=0;function g(){const t=$("input[name='latexExperience']:checked").val(),e=$("input[name='latexFrequency']:checked").val(),n=$("input[name='chatbotFrequency']:checked").val();return t&&e&&n?($("#button_instructions_next").show(),!0):($("#button_instructions_next").hide(),!1)}function b(t){const n=((Date.now()-p)/1e3).toFixed(3),i=u,a=o[d].condition,r=$("#token_input").val();e({keylog:{event:t,qid:i,condition:a,condition_index:d,precise_time:n,input:r}})}function x(t){h+=t,0==h?$("#button_instructions_prev").attr("disabled","true"):$("#button_instructions_prev").removeAttr("disabled"),3!=h||g()?($("#button_instructions_next").removeAttr("disabled"),$("#button_instructions_next").show()):($("#button_instructions_next").attr("disabled","true"),$("#button_instructions_next").hide()),h>=4?($("#instructions_and_decorations").show(),$("#button_instructions_next").val("Start study")):($("#instructions_and_decorations").hide(),$("#button_instructions_next").val("Next")),5==h&&($("#instructions_and_decorations").show(),$("#main_box_instructions").hide(),$("#main_box_experiment").show(),_||(e({pre_survey:{latexExperience:$("input[name='latexExperience']:checked").val(),latexFrequency:$("input[name='latexFrequency']:checked").val(),chatbotFrequency:$("input[name='chatbotFrequency']:checked").val()}}),_=!0),w()),$("#main_box_instructions").children(":not(input)").each(((t,e)=>{$(e).hide()})),$(`#instructions_${h}`).show()}$("#button_instructions_next").on("click",(()=>x(1))),$("#button_instructions_prev").on("click",(()=>x(-1)));let f=[],y=0;function v(t){$("#practice_container").empty().show();const e=$('\n      <div id="practice_inner_container" style="padding: 20px; padding-top:0px; overflow-y: auto;">\n        <div id="practice_instructions"></div>\n        <div id="practice_header"></div>\n        <div id="practice_content" style="margin-top: 10px;"></div>\n        <div id="practice_nav" style="margin-top: 20px; margin-bottom: 25px;"></div>\n      </div>\n    ');$("#practice_container").append(e),$("#practice_header").html(`<h2>Practice Round (${y+1} of ${f.length})</h2>`);const i=o[d].condition,a=[];"highlighted"===i?(a.push("The text is red if the model is uncertain about it. The brighter the red, the more uncertain the model is about that specific text."),a.push("Review the transcription carefully and fix any errors by editing the input box.")):a.push("Review the transcription carefully and fix any errors by editing the input box."),a.push("When the session starts, you will have 20 seconds to modify each transcription.");const r=a.map((t=>`<li>${t}</li>`)).join("");$("#practice_instructions").html(`\n    <h3 style="font-size: 1.1em; margin-bottom: 5px;">Instructions:</h3>\n    <ul style="margin-left: 20px;">\n        ${r}\n    </ul>\n    `),$("#practice_content").html('\n      <div id="practice_question_display" style="margin-top: 10px;">\n        <img id="practice_question_image" src="" alt="Practice Question Image" style="max-width: 100%; height: 110px; object-fit: contain;margin-top: 20px;">\n        <div id="practice_predicted_text_container" style="margin-top: 20px;">\n          <div style="margin-top: 10px;">Predicted Text:</div>\n          <div id="practice_predicted_text" style="margin-top: 20px;"></div>\n        </div>\n        <div id="practice_token_input_container" style="margin-top: 20px;">\n          <input id="practice_token_input" type="text" style="width: 100%; font-size: 16px; padding: 8px;">\n        </div>\n      </div>\n    ');const s=f[y];s.image?$("#practice_question_image").attr("src","data:image/png;base64,"+s.image):$("#practice_question_image").attr("src","");let l="";s.token_info&&Array.isArray(s.token_info)&&(l=s.token_info.filter((t=>"<|im_end|>"!==t.token)).map((t=>{let e=t.token.replace(/Ġ/g," ");if("highlighted"===o[d].condition){const i=1-(t.top_5_tokens&&t.top_5_tokens[0]&&"number"==typeof t.top_5_tokens[0].probability?t.top_5_tokens[0].probability:1);return e=n(e),`<span style="background-color: rgba(255, 0, 0, ${i});">${e}</span>`}return n(e)})).join("")),$("#practice_predicted_text").html(l);let c="";if(s.token_info&&Array.isArray(s.token_info)&&(c=s.token_info.map((t=>t.token)).filter((t=>"<|im_end|>"!==t)).map((t=>t.replace(/Ġ/g," "))).join("")),$("#practice_token_input").val(n(c)),"highlighted"===i){let t="";0===y?t="The model is uncertain about the text \\boxed":1===y?t="the model shows no uncertainty":2===y&&(t="The model is uncertain about three characters"),$("#practice_predicted_text").append(`<span style="font-style: italic; margin-left: 20px; vertical-align: middle;">${t}</span>`)}$("#practice_nav").html('\n      <div>\n        <input id="practice_prev" type="button" value="Previous Example">\n        <input id="practice_next" type="button" value="Next Example" style="margin-left: 10px;">\n      </div>\n    '),$("#practice_prev").off("click").on("click",(()=>{y=(y-1+f.length)%f.length,v(t)})),$("#practice_next").off("click").on("click",(()=>{y=(y+1)%f.length,v(t)}))}function w(){if($("#main_box_experiment").show(),$("#button_next").hide(),$("#button_quit").hide(),d>=o.length)return $("#main_box_experiment").hide(),void $("#qualitative_section").show();let t=o[d];if(0===u)return void function(t){$("#main_box_experiment").hide(),$("#start_condition_page").empty().show();const e=`\n      <div style="display: flex; justify-content: space-between; align-items: center;">\n          <h2 style="margin: 0;">${"highlighted"===t?"Uncertainty Highlighted Section":"Non-Highlighted Section"}</h2>\n          <input id="start_condition_next" type="button" value="Start Section" style="margin: 0;"/>\n      </div>\n    `;$("#start_condition_page").append(e),0===$("#practice_container").length&&$("#start_condition_page").append('<div id="practice_container" style="margin-top:10px;"></div>'),new Promise(((t,e)=>{$.getJSON("practice_questions/Qwen_practice_Qs.json").done((e=>t(e))).fail(((t,n,i)=>e(i)))})).then((t=>{f=t,y=0,v((()=>{u=1,w()}))})).catch((t=>{})),$("#start_condition_next").on("click",(()=>{$("#start_condition_page").hide(),u=1,w()}))}(t.condition);if(u>t.questions.length)return void function(){$("#main_box_experiment").hide();const t=o[d].condition;$("#condition_label").text(t),$("#mental_demand").val("0"),$("#hurried_demand").val("0"),$("#performance").val("0"),$("#effort").val("0"),$("#frustration").val("0"),$("#nasa_tlx_survey").show()}(t.condition);a=t.questions[u-1],a.image?$("#question_image").attr("src","data:image/png;base64,"+a.image):$("#question_image").attr("src","");let e="";a.token_info&&Array.isArray(a.token_info)&&(e=a.token_info.filter((t=>"<|im_end|>"!==t.token)).map((t=>{let e=t.token.replace(/Ġ/g," "),i=1-(t.top_5_tokens&&t.top_5_tokens[0]&&"number"==typeof t.top_5_tokens[0].probability?t.top_5_tokens[0].probability:1);return"highlighted"==o[d].condition?`<span style="background-color: rgba(255, 0, 0, ${i});">${n(e)}</span>`:n(e)})).join("")),$("#predicted_text").html(e);let i="";a.token_info&&Array.isArray(a.token_info)&&(i=a.token_info.map((t=>t.token)).filter((t=>"<|im_end|>"!==t)).map((t=>t.replace(/Ġ/g," "))).join("")),$("#token_input").val(n(i)),$("#progress").text(`Section ${d+1} of ${o.length} | Question ${u} of ${t.questions.length}`),$("#part1").show(),$("#part2").hide(),$("#token_input_container").hide(),$("#button_next_part1").hide(),p=Date.now(),clearTimeout(s),s=window.setTimeout(S,2e4),c=20,$("#timer").text(c),$("#timer").show(),l&&clearInterval(l),l=window.setInterval((()=>{c-=1,$("#timer").text(c),c<=15&&($("#token_input_container").show(),$("#button_next_part1").show()),c<=0&&(clearInterval(l),S(),$("#timer").hide())}),1e3)}const k=new URLSearchParams(window.location.search),q=k.get("start"),T=k.get("uid");if(globalThis.url_data=function(t){const e={};for(const[n,i]of t)e[n]=i;return e}(k.entries()),null==globalThis.url_data.study_id&&(globalThis.url_data.study_id="demo_study"),null==globalThis.url_data.prolific_id&&(globalThis.url_data.prolific_id="demo_user"),null==globalThis.url_data.session_id&&(globalThis.url_data.session_id="demo_session"),null!=T){if(globalThis.uid=T,"prolific_random"==globalThis.uid){let t=`${Math.floor(10*Math.random())}`.padStart(3,"0");globalThis.uid=`${k.get("prolific_queue_name")}/${t}`}}else{let t=null;for(;null==t;)t=prompt("Enter your user id. Please get in touch if you were not assigned an id but wish to participate in this experiment.");globalThis.uid=t}globalThis.url_data.session_id.startsWith("demo")&&(i=!0),async function(){return await $.getJSON(`baked_queues/${globalThis.uid}.json?t=${Date.now()}`)}().catch((t=>{window.location.reload()})).then((t=>{o=t,null!=q&&(u=parseInt(q)-1),x(0),$("#main_box_instructions").show(),$("#instructions_and_decorations").hide()}));let j=!1;function S(){b("auto_submit"),clearInterval(l),$("#timer").hide(),$("#part1").hide(),$("#part2").show()}document.onvisibilitychange=()=>{j||(m+=1,j=!0,j=!1)},$(document).ready((()=>{$("#button_next_part1").on("click",(()=>{b("next_button_submitted"),clearTimeout(s),$("#timer").hide(),$("#part1").hide(),$("#part2").show()})),$(".confidence-button").on("click",(function(){let t=parseInt($(this).attr("data-rating"));$(".confidence-button").removeClass("selected"),$(this).addClass("selected"),r=t,$("#button_next_part2").removeAttr("disabled")})),$("#button_next_part2").on("click",(()=>{e({question_i:u,qid:a.qid,condition:o[d].condition,confidence_rating:r}),$("#button_next_part2").attr("disabled","true"),$(".confidence-button").removeClass("selected"),r=-1,$("#part2").hide(),$("#part1").show(),u++,w()})),$("input[name='latexExperience'], input[name='latexFrequency'], input[name='chatbotFrequency']").on("change",(()=>{g()&&($("#button_instructions_next").removeAttr("disabled"),$("#button_instructions_next").show())})),$("#token_input").on("input",(function(){b("input_change")}));const t={mental_demand:!1,hurried_demand:!1,performance:!1,effort:!1,frustration:!1},n={mental_demand:null,hurried_demand:null,performance:null,effort:null,frustration:null};function i(){return Object.values(t).every((t=>!0===t))}const l=$("#nasa_tlx_next");l.prop("disabled",!0),$(".tlx-box").on("click",(function(){const e=$(this).parent().attr("id");if(!e||!(e in t))return;const o=parseInt($(this).attr("data-value"));n[e]=o,t[e]=!0,$(this).siblings().removeClass("selected"),$(this).addClass("selected"),i()&&l.prop("disabled",!1)})),l.on("click",(()=>{if(!i())return void alert("Please adjust all sliders before continuing.");const o={mental_demand:null!==n.mental_demand?n.mental_demand:0,hurried_demand:null!==n.hurried_demand?n.hurried_demand:0,performance:null!==n.performance?n.performance:0,effort:null!==n.effort?n.effort:0,frustration:null!==n.frustration?n.frustration:0};e({condition:$("#condition_label").text(),condition_index:d,tlx:o}),function(){for(let e in t)t[e]=!1;for(let t in n)n[t]=null;$(".tlx-box").removeClass("selected"),l.prop("disabled",!0)}(),$("#nasa_tlx_survey").hide(),d++,u=0,w()}))})),$("#qual_next").on("click",(()=>{const t=$("#qual_q1").val()||"",n=$("#qual_q2").val()||"",o=$("#qual_q3").val()||"";let a=!0;t.length<25?($("#warn_q1").show(),a=!1):$("#warn_q1").hide(),n.length<25?($("#warn_q2").show(),a=!1):$("#warn_q2").hide(),o.length<0?($("#warn_q3").show(),a=!1):$("#warn_q3").hide(),a&&(e({qualitative:{q1:t,q2:n,q3:o}}),$("#qualitative_section").hide(),i?($("#reward_box_mock").text("Your total reward is $3.00."),$("#reward_box_mock").show(),$("#main_box_end_mock").show()):($("#reward_box").text("Your total reward is $3.00."),$("#reward_box").show(),$("#main_box_end").show()))}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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dkJpQyxHQUFlLEdBQ2pCLElBZUZ6RCxFQUFFLGNBQWM4RCxHQUFHLFNBQVMsS0FDeEIsTUFBTXVHLEVBQU1ySyxFQUFFLFlBQVlpQyxPQUFvQixHQUN4Q3FJLEVBQU10SyxFQUFFLFlBQVlpQyxPQUFvQixHQUN4Q3NJLEVBQU12SyxFQUFFLFlBQVlpQyxPQUFvQixHQUU5QyxJQUFJdUksR0FBUSxFQUVSSCxFQUFHOUYsT0FBUyxJQUNadkUsRUFBRSxZQUFZb0MsT0FDZG9JLEdBQVEsR0FFUnhLLEVBQUUsWUFBWXFDLE9BR2RpSSxFQUFHL0YsT0FBUyxJQUNadkUsRUFBRSxZQUFZb0MsT0FDZG9JLEdBQVEsR0FFUnhLLEVBQUUsWUFBWXFDLE9BR2RrSSxFQUFHaEcsT0FBUyxHQUNadkUsRUFBRSxZQUFZb0MsT0FDZG9JLEdBQVEsR0FFUnhLLEVBQUUsWUFBWXFDLE9BSWJtSSxJQWFMaEwsRUFSa0IsQ0FDZGlMLFlBQWEsQ0FDVEosR0FBSUEsRUFDSkMsR0FBSUEsRUFDSkMsR0FBSUEsS0FPWnZLLEVBQUUsd0JBQXdCcUMsT0FDdEJwQixHQUNBakIsRUFBRSxvQkFBb0IwRyxLQUFLLCtCQUMzQjFHLEVBQUUsb0JBQW9Cb0MsT0FDdEJwQyxFQUFFLHNCQUFzQm9DLFNBRXhCcEMsRUFBRSxlQUFlMEcsS0FBSywrQkFDdEIxRyxFQUFFLGVBQWVvQyxPQUNqQnBDLEVBQUUsaUJBQWlCb0MsUSIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL3NyYy9jb25uZWN0b3IudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL3V0aWxzLnRzIiwid2VicGFjazovLy8uL3NyYy9tYWluLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IERFVk1PREUgfSBmcm9tICcuL2dsb2JhbHMnXHJcbmltcG9ydCB7IE1PQ0tNT0RFIH0gZnJvbSAnLi9tYWluJ1xyXG5cclxubGV0IFNFUlZFUl9MT0dfUk9PVCA9IERFVk1PREUgPyBcImh0dHA6Ly8xMjcuMC4wLjE6NTAwMC9cIiA6IFwiaHR0cHM6Ly9tYXR0aGV3c2FsYXdheS5weXRob25hbnl3aGVyZS5jb20vXCJcclxuXHJcbmFzeW5jIGZ1bmN0aW9uIHNsZWVwKG1zOiBudW1iZXIpOiBQcm9taXNlPHZvaWQ+IHtcclxuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4gc2V0VGltZW91dChyZXNvbHZlLCBtcykpO1xyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gbG9hZF9kYXRhKCk6IFByb21pc2U8YW55PiB7XHJcbiAgICAvLyBpbmNsdWRlIHRpbWVzdGFtcCBzbyB0aGF0IHRoaW5ncyBkb24ndCBnZXQgY2FjaGVkXHJcbiAgICBsZXQgcmVzdWx0ID0gYXdhaXQgJC5nZXRKU09OKFxyXG4gICAgICAgIGBiYWtlZF9xdWV1ZXMvJHtnbG9iYWxUaGlzLnVpZH0uanNvbj90PSR7RGF0ZS5ub3coKX1gLFxyXG4gICAgKVxyXG4gICAgcmV0dXJuIHJlc3VsdFxyXG59XHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBsb2dfZGF0YShkYXRhKTogUHJvbWlzZTxhbnk+IHtcclxuICAgIC8vaWYgKE1PQ0tNT0RFKSB7XHJcbiAgICAvLyAgICBjb25zb2xlLmxvZyhcImxvZ2dlZCAobW9jaylcIiwgZGF0YSlcclxuICAgIC8vICAgIHJldHVyblxyXG4gICAgLy99XHJcbiAgICBcclxuICAgIGRhdGFbXCJ1cmxfZGF0YVwiXSA9IGdsb2JhbFRoaXMudXJsX2RhdGFcclxuICAgIGNvbnNvbGUubG9nKFwiRGF0YVwiKVxyXG4gICAgaWYgKCEoXCJzdHVkeV9pZFwiIGluIGRhdGFbJ3VybF9kYXRhJ10pKSB7XHJcbiAgICAgICAgZGF0YVsndXJsX2RhdGEnXVtcInN0dWR5X2lkXCJdID0gXCJkZW1vX3N0dWR5XCJcclxuICAgIH1cclxuICAgIGlmICghKFwicHJvbGlmaWNfaWRcIiBpbiBkYXRhWyd1cmxfZGF0YSddKSkge1xyXG4gICAgICAgIGRhdGFbJ3VybF9kYXRhJ11bXCJwcm9saWZpY19pZFwiXSA9IFwiZGVtb191c2VyXCJcclxuICAgIH1cclxuICAgIGlmICghKFwic2Vzc2lvbl9pZFwiIGluIGRhdGFbJ3VybF9kYXRhJ10pKSB7XHJcbiAgICAgICAgZGF0YVsndXJsX2RhdGEnXVtcInNlc3Npb25faWRcIl0gPSBcImRlbW9fc2Vzc2lvblwiXHJcbiAgICB9XHJcbiAgICBkYXRhW1widXJsX2RhdGFcIl1bXCJxdWV1ZV9pZFwiXSA9IGdsb2JhbFRoaXMudWlkXHJcbiAgICBjb25zb2xlLmxvZyhcImxvZ2dlZFwiLCBkYXRhKVxyXG4gICAgY29uc29sZS5sb2coXCJMb2dnaW5nIHRvXCIsIFNFUlZFUl9MT0dfUk9PVCArIFwibG9nXCIpXHJcblxyXG4gICAgdHJ5IHtcclxuICAgICAgICBsZXQgcmVzdWx0ID0gYXdhaXQgJC5hamF4KFxyXG4gICAgICAgICAgICBTRVJWRVJfTE9HX1JPT1QgKyBcImxvZ1wiLFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBkYXRhOiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgICAgICAgICAgICAgcHJvamVjdDogXCJvY3ItY2FsaWJyYXRpb24tc3R1ZHkvXCIrZGF0YVsndXJsX2RhdGEnXVsnc3R1ZHlfaWQnXSxcclxuICAgICAgICAgICAgICAgICAgICB1aWQ6IGdsb2JhbFRoaXMudWlkK1wiX1wiK2RhdGFbJ3VybF9kYXRhJ11bJ3Byb2xpZmljX2lkJ10sXHJcbiAgICAgICAgICAgICAgICAgICAgcGF5bG9hZDogSlNPTi5zdHJpbmdpZnkoZGF0YSksXHJcbiAgICAgICAgICAgICAgICB9KSxcclxuICAgICAgICAgICAgICAgIHR5cGU6ICdQT1NUJyxcclxuICAgICAgICAgICAgICAgIGNvbnRlbnRUeXBlOiAnYXBwbGljYXRpb24vanNvbicsXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICApXHJcbiAgICAgICAgYXdhaXQgc2xlZXAoMjAwMCk7XHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdFxyXG4gICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGUpXHJcbiAgICB9XHJcbn0iLCJmdW5jdGlvbiBwYXJhbXNUb09iamVjdChlbnRyaWVzKSB7XHJcbiAgY29uc3QgcmVzdWx0ID0ge31cclxuICAvLyBlYWNoICdlbnRyeScgaXMgYSBba2V5LCB2YWx1ZV0gdHVwcGxlXHJcbiAgZm9yIChjb25zdCBba2V5LCB2YWx1ZV0gb2YgZW50cmllcykge1xyXG4gICAgcmVzdWx0W2tleV0gPSB2YWx1ZTtcclxuICB9XHJcbiAgcmV0dXJuIHJlc3VsdDtcclxufVxyXG4vLyBJbiBzcmMvdXRpbHMudHMgb3IgYXQgdGhlIHRvcCBvZiBzcmMvbWFpbi50c1xyXG5mdW5jdGlvbiBmaXhTcGFjaW5nKGlucHV0OiBzdHJpbmcpOiBzdHJpbmcge1xyXG4gIC8vIFJlbW92ZSBhbGwgc3BhY2VzLlxyXG4gIGxldCBvdXRwdXQgPSBpbnB1dC5yZXBsYWNlKC9cXHMrL2csIFwiXCIpO1xyXG4gIC8vIEFkZCBhIHNwYWNlIGJlZm9yZSBldmVyeSBiYWNrc2xhc2guXHJcbiAgb3V0cHV0ID0gb3V0cHV0LnJlcGxhY2UoL1xcXFwvZywgXCIgXFxcXFwiKTtcclxuICAvLyBBZGQgYSBzcGFjZSBiZWZvcmUgYW5kIGFmdGVyIGV2ZXJ5IHBsdXMsIG1pbnVzLCBhbmQgZXF1YWwgc2lnbi5cclxuICBvdXRwdXQgPSBvdXRwdXQucmVwbGFjZSgvKFtcXCtcXC1cXD1dKS9nLCBcIiAkMSBcIik7XHJcbiAgLy8gQ29sbGFwc2UgbXVsdGlwbGUgc3BhY2VzIGludG8gb25lLlxyXG4gIG91dHB1dCA9IG91dHB1dC5yZXBsYWNlKC9cXHMrL2csIFwiIFwiKTtcclxuICByZXR1cm4gb3V0cHV0O1xyXG59XHJcblxyXG5cclxuXHJcbmV4cG9ydCB7IHBhcmFtc1RvT2JqZWN0LCBmaXhTcGFjaW5nIH0iLCJpbXBvcnQgeyBERVZNT0RFIH0gZnJvbSBcIi4vZ2xvYmFsc1wiXHJcbmV4cG9ydCB2YXIgVUlEOiBzdHJpbmdcclxuZXhwb3J0IHZhciBNT0NLTU9ERTogYm9vbGVhbiA9IGZhbHNlXHJcbmltcG9ydCB7IGxvYWRfZGF0YSwgbG9nX2RhdGEgfSBmcm9tICcuL2Nvbm5lY3RvcidcclxuaW1wb3J0IHsgcGFyYW1zVG9PYmplY3QsIGZpeFNwYWNpbmcgfSBmcm9tIFwiLi91dGlsc1wiXHJcblxyXG52YXIgZGF0YTogYW55W10gPSBbXVxyXG5sZXQgcXVlc3Rpb246IGFueSA9IG51bGxcclxubGV0IGNvbmZpZGVuY2VSYXRpbmc6IG51bWJlciA9IC0xO1xyXG5sZXQgcGFydDFUaW1lcjogbnVtYmVyID0gMDtcclxubGV0IHBhcnQxSW50ZXJ2YWw6IG51bWJlciA9IDA7XHJcbmxldCByZW1haW5pbmdUaW1lOiBudW1iZXIgPSAyMDtcclxubGV0IGN1cnJlbnRDb25kaXRpb25JbmRleCA9IDA7XHJcbmxldCBjdXJyZW50UXVlc3Rpb25JbmRleCA9IDA7XHJcbmxldCBwcmVTdXJ2ZXlMb2dnZWQgPSBmYWxzZTtcclxubGV0IHF1ZXN0aW9uU3RhcnRUaW1lOiBudW1iZXIgPSBEYXRlLm5vdygpO1xyXG5cclxuXHJcblxyXG5cclxuXHJcbmxldCBiYWxhbmNlID0gMFxyXG5sZXQgYmFsYW5jZV9pbmNyZW1lbnQgPSAwLjEgICAgIC8vIEJhbGFuY2UgdXBkYXRlcyBieSAkMC4xMCBmb3IgZXZlcnkgY29ycmVjdCBzZWxlY3Rpb25cclxuXHJcbmxldCBpbnN0cnVjdGlvbl9pOiBudW1iZXIgPSAwXHJcbmxldCBjb3VudF9leGl0ZWRfcGFnZTogbnVtYmVyID0gMFxyXG5cclxuZnVuY3Rpb24gYXNzZXJ0KGNvbmRpdGlvbiwgbWVzc2FnZSkge1xyXG4gICAgaWYgKCFjb25kaXRpb24pIHtcclxuICAgICAgICB0aHJvdyBtZXNzYWdlIHx8IFwiQXNzZXJ0aW9uIGZhaWxlZFwiO1xyXG4gICAgfVxyXG59XHJcblxyXG5cclxuZnVuY3Rpb24gY2hlY2tQcmVTdXJ2ZXkoKTogYm9vbGVhbiB7XHJcbiAgICBjb25zdCBsYXRleEV4cCA9ICQoXCJpbnB1dFtuYW1lPSdsYXRleEV4cGVyaWVuY2UnXTpjaGVja2VkXCIpLnZhbCgpO1xyXG4gICAgY29uc3QgbGF0ZXhGcmVxID0gJChcImlucHV0W25hbWU9J2xhdGV4RnJlcXVlbmN5J106Y2hlY2tlZFwiKS52YWwoKTtcclxuICAgIGNvbnN0IGNoYXRib3RGcmVxID0gJChcImlucHV0W25hbWU9J2NoYXRib3RGcmVxdWVuY3knXTpjaGVja2VkXCIpLnZhbCgpO1xyXG4gIFxyXG4gICAgaWYgKGxhdGV4RXhwICYmIGxhdGV4RnJlcSAmJiBjaGF0Ym90RnJlcSkge1xyXG4gICAgICAkKFwiI2J1dHRvbl9pbnN0cnVjdGlvbnNfbmV4dFwiKS5zaG93KCk7XHJcbiAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgJChcIiNidXR0b25faW5zdHJ1Y3Rpb25zX25leHRcIikuaGlkZSgpO1xyXG4gICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGxvZ0lucHV0RXZlbnQoZXZlbnRUeXBlOiBzdHJpbmcpIHtcclxuICAgIGNvbnN0IHByZWNpc2VUaW1lID0gKChEYXRlLm5vdygpIC0gcXVlc3Rpb25TdGFydFRpbWUpIC8gMTAwMCkudG9GaXhlZCgzKTtcclxuICAgIGNvbnN0IHFpZCA9IGN1cnJlbnRRdWVzdGlvbkluZGV4OyAvLyBVc2luZyB0aGUgY3VycmVudFF1ZXN0aW9uSW5kZXggYXMgdGhlIHF1ZXN0aW9uIGlkLlxyXG4gICAgY29uc3QgY29uZGl0aW9uID0gZGF0YVtjdXJyZW50Q29uZGl0aW9uSW5kZXhdLmNvbmRpdGlvbjtcclxuICAgIGNvbnN0IGN1cnJlbnRUZXh0ID0gJChcIiN0b2tlbl9pbnB1dFwiKS52YWwoKTtcclxuXHJcbiAgICBsb2dfZGF0YSh7XHJcbiAgICAgICAga2V5bG9nOiB7XHJcbiAgICAgICAgICAgIGV2ZW50OiBldmVudFR5cGUsXHJcbiAgICAgICAgICAgIHFpZDogcWlkLFxyXG4gICAgICAgICAgICBjb25kaXRpb246IGNvbmRpdGlvbixcclxuICAgICAgICAgICAgY29uZGl0aW9uX2luZGV4OiBjdXJyZW50Q29uZGl0aW9uSW5kZXgsXHJcbiAgICAgICAgICAgIHByZWNpc2VfdGltZTogcHJlY2lzZVRpbWUsXHJcbiAgICAgICAgICAgIGlucHV0OiBjdXJyZW50VGV4dFxyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG59XHJcblxyXG5cclxuXHJcbmZ1bmN0aW9uIG5leHRfaW5zdHJ1Y3Rpb25zKGluY3JlbWVudDogbnVtYmVyKSB7XHJcbiAgICBpbnN0cnVjdGlvbl9pICs9IGluY3JlbWVudFxyXG5cclxuICAgIGlmIChpbnN0cnVjdGlvbl9pID09IDApIHtcclxuICAgICAgICAkKFwiI2J1dHRvbl9pbnN0cnVjdGlvbnNfcHJldlwiKS5hdHRyKFwiZGlzYWJsZWRcIiwgXCJ0cnVlXCIpXHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgICQoXCIjYnV0dG9uX2luc3RydWN0aW9uc19wcmV2XCIpLnJlbW92ZUF0dHIoXCJkaXNhYmxlZFwiKVxyXG4gICAgfVxyXG4gICAgaWYoaW5zdHJ1Y3Rpb25faSA9PSAzICYmICFjaGVja1ByZVN1cnZleSgpKSB7XHJcbiAgICAgICAgJChcIiNidXR0b25faW5zdHJ1Y3Rpb25zX25leHRcIikuYXR0cihcImRpc2FibGVkXCIsIFwidHJ1ZVwiKVxyXG4gICAgICAgICQoXCIjYnV0dG9uX2luc3RydWN0aW9uc19uZXh0XCIpLmhpZGUoKVxyXG4gICAgfVxyXG4gICAgZWxzZXtcclxuICAgICAgICAkKFwiI2J1dHRvbl9pbnN0cnVjdGlvbnNfbmV4dFwiKS5yZW1vdmVBdHRyKFwiZGlzYWJsZWRcIilcclxuICAgICAgICAkKFwiI2J1dHRvbl9pbnN0cnVjdGlvbnNfbmV4dFwiKS5zaG93KClcclxuICAgIH1cclxuICAgIGlmIChpbnN0cnVjdGlvbl9pID49IDQpIHtcclxuICAgICAgICAkKFwiI2luc3RydWN0aW9uc19hbmRfZGVjb3JhdGlvbnNcIikuc2hvdygpXHJcbiAgICAgICAgJChcIiNidXR0b25faW5zdHJ1Y3Rpb25zX25leHRcIikudmFsKFwiU3RhcnQgc3R1ZHlcIilcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgJChcIiNpbnN0cnVjdGlvbnNfYW5kX2RlY29yYXRpb25zXCIpLmhpZGUoKVxyXG4gICAgICAgICQoXCIjYnV0dG9uX2luc3RydWN0aW9uc19uZXh0XCIpLnZhbChcIk5leHRcIilcclxuICAgIH1cclxuICAgIGlmIChpbnN0cnVjdGlvbl9pID09IDUpIHtcclxuICAgICAgICAkKFwiI2luc3RydWN0aW9uc19hbmRfZGVjb3JhdGlvbnNcIikuc2hvdygpXHJcbiAgICAgICAgJChcIiNtYWluX2JveF9pbnN0cnVjdGlvbnNcIikuaGlkZSgpXHJcbiAgICAgICAgJChcIiNtYWluX2JveF9leHBlcmltZW50XCIpLnNob3coKVxyXG4gICAgICAgIC8vIFJlc2V0IG91ciBjb25kaXRpb24gaW5kaWNlcyBiZWZvcmUgc3RhcnRpbmcgdGhlIGV4cGVyaW1lbnRcclxuICAgICAgICBpZiAoIXByZVN1cnZleUxvZ2dlZCkge1xyXG4gICAgICAgICAgICBjb25zdCBwcmVTdXJ2ZXlEYXRhID0ge1xyXG4gICAgICAgICAgICAgICAgbGF0ZXhFeHBlcmllbmNlOiAkKFwiaW5wdXRbbmFtZT0nbGF0ZXhFeHBlcmllbmNlJ106Y2hlY2tlZFwiKS52YWwoKSxcclxuICAgICAgICAgICAgICAgIGxhdGV4RnJlcXVlbmN5OiAkKFwiaW5wdXRbbmFtZT0nbGF0ZXhGcmVxdWVuY3knXTpjaGVja2VkXCIpLnZhbCgpLFxyXG4gICAgICAgICAgICAgICAgY2hhdGJvdEZyZXF1ZW5jeTogJChcImlucHV0W25hbWU9J2NoYXRib3RGcmVxdWVuY3knXTpjaGVja2VkXCIpLnZhbCgpXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIGxvZ19kYXRhKHsgcHJlX3N1cnZleTogcHJlU3VydmV5RGF0YSB9KTtcclxuICAgICAgICAgICAgcHJlU3VydmV5TG9nZ2VkID0gdHJ1ZTtcclxuICAgICAgICB9XHJcblxyXG5cclxuICAgICAgICBuZXh0X3F1ZXN0aW9uKClcclxuICAgIH1cclxuXHJcbiAgICAkKFwiI21haW5fYm94X2luc3RydWN0aW9uc1wiKS5jaGlsZHJlbihcIjpub3QoaW5wdXQpXCIpLmVhY2goKF8sIGVsKSA9PiB7XHJcbiAgICAgICAgJChlbCkuaGlkZSgpXHJcbiAgICB9KVxyXG4gICAgJChgI2luc3RydWN0aW9uc18ke2luc3RydWN0aW9uX2l9YCkuc2hvdygpXHJcbn1cclxuJChcIiNidXR0b25faW5zdHJ1Y3Rpb25zX25leHRcIikub24oXCJjbGlja1wiLCAoKSA9PiBuZXh0X2luc3RydWN0aW9ucygrMSkpXHJcbiQoXCIjYnV0dG9uX2luc3RydWN0aW9uc19wcmV2XCIpLm9uKFwiY2xpY2tcIiwgKCkgPT4gbmV4dF9pbnN0cnVjdGlvbnMoLTEpKVxyXG5cclxuXHJcbi8qIE5ldyBmdW5jdGlvbjogU2hvdyBzdGFydC1vZi1jb25kaXRpb24gcGFnZSAqL1xyXG5mdW5jdGlvbiBzaG93U3RhcnRDb25kaXRpb25QYWdlKGNvbmRpdGlvbjogc3RyaW5nKSB7XHJcbiAgICAkKFwiI21haW5fYm94X2V4cGVyaW1lbnRcIikuaGlkZSgpO1xyXG4gICAgLy8gQ2xlYXIgdGhlIGNvbnRhaW5lciBvbmNlLlxyXG4gICAgJChcIiNzdGFydF9jb25kaXRpb25fcGFnZVwiKS5lbXB0eSgpLnNob3coKTtcclxuXHJcbiAgICAvLyBEZXRlcm1pbmUgaGVhZGVyIHRleHQgYmFzZWQgb24gY29uZGl0aW9uLlxyXG4gICAgY29uc3QgaGVhZGVyVGV4dCA9IChjb25kaXRpb24gPT09IFwiaGlnaGxpZ2h0ZWRcIikgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICA/IFwiVW5jZXJ0YWludHkgSGlnaGxpZ2h0ZWQgU2VjdGlvblwiIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgOiBcIk5vbi1IaWdobGlnaHRlZCBTZWN0aW9uXCI7XHJcblxyXG4gICAgLy8gQ3JlYXRlIGEgZmxleCBjb250YWluZXIgd2l0aCBoZWFkZXIgYW5kIFN0YXJ0IEV4cGVyaW1lbnQgYnV0dG9uLlxyXG4gICAgY29uc3QgaGVhZGVySHRtbCA9IGBcclxuICAgICAgPGRpdiBzdHlsZT1cImRpc3BsYXk6IGZsZXg7IGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2VlbjsgYWxpZ24taXRlbXM6IGNlbnRlcjtcIj5cclxuICAgICAgICAgIDxoMiBzdHlsZT1cIm1hcmdpbjogMDtcIj4ke2hlYWRlclRleHR9PC9oMj5cclxuICAgICAgICAgIDxpbnB1dCBpZD1cInN0YXJ0X2NvbmRpdGlvbl9uZXh0XCIgdHlwZT1cImJ1dHRvblwiIHZhbHVlPVwiU3RhcnQgU2VjdGlvblwiIHN0eWxlPVwibWFyZ2luOiAwO1wiLz5cclxuICAgICAgPC9kaXY+XHJcbiAgICBgO1xyXG4gICAgJChcIiNzdGFydF9jb25kaXRpb25fcGFnZVwiKS5hcHBlbmQoaGVhZGVySHRtbCk7XHJcblxyXG4gICAgLy8gQXBwZW5kIGEgY29udGFpbmVyIGZvciB0aGUgcHJhY3RpY2Ugcm91bmQgY29udGVudCBpZiBub3QgYWxyZWFkeSBwcmVzZW50LlxyXG4gICAgaWYgKCQoXCIjcHJhY3RpY2VfY29udGFpbmVyXCIpLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAkKFwiI3N0YXJ0X2NvbmRpdGlvbl9wYWdlXCIpLmFwcGVuZCgnPGRpdiBpZD1cInByYWN0aWNlX2NvbnRhaW5lclwiIHN0eWxlPVwibWFyZ2luLXRvcDoxMHB4O1wiPjwvZGl2PicpO1xyXG4gICAgfVxyXG5cclxuICAgIGxvYWRQcmFjdGljZVF1ZXN0aW9ucygpLnRoZW4oKGRhdGEpID0+IHtcclxuICAgICAgICBwcmFjdGljZVF1ZXN0aW9ucyA9IGRhdGE7XHJcbiAgICAgICAgLy8gY29uc29sZS5sb2coXCJQcmFjdGljZSBxdWVzdGlvbnMgbG9hZGVkOlwiLCBwcmFjdGljZVF1ZXN0aW9ucyk7XHJcbiAgICAgICAgcHJhY3RpY2VJbmRleCA9IDA7IC8vIFN0YXJ0IGF0IHRoZSBmaXJzdCBwcmFjdGljZSBxdWVzdGlvbi5cclxuICAgICAgICAvLyBMYXVuY2ggdGhlIHByYWN0aWNlIHJvdW5kLlxyXG4gICAgICAgIHNob3dQcmFjdGljZVJvdW5kKCgpID0+IHtcclxuICAgICAgICAgIC8vIFdoZW4gcHJhY3RpY2UgaXMgY29tcGxldGUsIHJlc3VtZSB0aGUgbm9ybWFsIGV4cGVyaW1lbnQgZmxvdy5cclxuICAgICAgICAgIC8vIChBdCB0aGlzIHBvaW50LCB5b3UgY2FuIG5vdyBzYWZlbHkgdXBkYXRlIGV4cGVyaW1lbnQgc3RhdGUuKVxyXG4gICAgICAgICAgY3VycmVudFF1ZXN0aW9uSW5kZXggPSAxO1xyXG4gICAgICAgICAgbmV4dF9xdWVzdGlvbigpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICB9KS5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICAgICAgLy8gY29uc29sZS5lcnJvcihcIkVycm9yIGxvYWRpbmcgcHJhY3RpY2UgcXVlc3Rpb25zOlwiLCBlcnIpO1xyXG4gICAgICB9KTtcclxuICAgIFxyXG5cclxuICAgICQoXCIjc3RhcnRfY29uZGl0aW9uX25leHRcIikub24oXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgICAgJChcIiNzdGFydF9jb25kaXRpb25fcGFnZVwiKS5oaWRlKCk7XHJcbiAgICAgICAgLy8gQWZ0ZXIgc3RhcnQgcGFnZSwgYmVnaW4gd2l0aCBmaXJzdCBxdWVzdGlvbiAoc2V0IGluZGV4IHRvIDEpXHJcbiAgICAgICAgY3VycmVudFF1ZXN0aW9uSW5kZXggPSAxO1xyXG4gICAgICAgIG5leHRfcXVlc3Rpb24oKTtcclxuICAgIH0pO1xyXG59XHJcbmxldCBwcmFjdGljZVF1ZXN0aW9uczogYW55W10gPSBbXTtcclxubGV0IHByYWN0aWNlSW5kZXg6IG51bWJlciA9IDA7XHJcblxyXG4vLyBGdW5jdGlvbiB0byBsb2FkIHByYWN0aWNlIHF1ZXN0aW9ucyAoYXNzdW1lcyBhIEpTT04gZmlsZSB3aXRoIGFuIGFycmF5IG9mIGV4YW1wbGUgcXVlc3Rpb25zKVxyXG5mdW5jdGlvbiBsb2FkUHJhY3RpY2VRdWVzdGlvbnMoKTogUHJvbWlzZTxhbnlbXT4ge1xyXG4gIHJldHVybiBuZXcgUHJvbWlzZTxhbnlbXT4oKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG4gICAgJC5nZXRKU09OKFwicHJhY3RpY2VfcXVlc3Rpb25zL1F3ZW5fcHJhY3RpY2VfUXMuanNvblwiKVxyXG4gICAgICAuZG9uZShkYXRhID0+IHJlc29sdmUoZGF0YSkpXHJcbiAgICAgIC5mYWlsKChqcXhociwgdGV4dFN0YXR1cywgZXJyb3IpID0+IHJlamVjdChlcnJvcikpO1xyXG4gIH0pO1xyXG59XHJcbmZ1bmN0aW9uIHNob3dQcmFjdGljZVJvdW5kKG9uQ29tcGxldGU6ICgpID0+IHZvaWQpIHtcclxuICAgIC8vIEluc3RlYWQgb2YgZW1wdHlpbmcgdGhlIGVudGlyZSBwYWdlLCB1cGRhdGUgb25seSB0aGUgcHJhY3RpY2UgY29udGFpbmVyLlxyXG4gICAgJChcIiNwcmFjdGljZV9jb250YWluZXJcIikuZW1wdHkoKS5zaG93KCk7XHJcbiAgXHJcbiAgICAvLyBCdWlsZCB0aGUgcHJhY3RpY2Ugcm91bmQgY29udGVudCBpbnNpZGUgYSBmaXhlZCBjb250YWluZXIuXHJcbiAgICBjb25zdCBwcmFjdGljZUNvbnRlbnQgPSAkKGBcclxuICAgICAgPGRpdiBpZD1cInByYWN0aWNlX2lubmVyX2NvbnRhaW5lclwiIHN0eWxlPVwicGFkZGluZzogMjBweDsgcGFkZGluZy10b3A6MHB4OyBvdmVyZmxvdy15OiBhdXRvO1wiPlxyXG4gICAgICAgIDxkaXYgaWQ9XCJwcmFjdGljZV9pbnN0cnVjdGlvbnNcIj48L2Rpdj5cclxuICAgICAgICA8ZGl2IGlkPVwicHJhY3RpY2VfaGVhZGVyXCI+PC9kaXY+XHJcbiAgICAgICAgPGRpdiBpZD1cInByYWN0aWNlX2NvbnRlbnRcIiBzdHlsZT1cIm1hcmdpbi10b3A6IDEwcHg7XCI+PC9kaXY+XHJcbiAgICAgICAgPGRpdiBpZD1cInByYWN0aWNlX25hdlwiIHN0eWxlPVwibWFyZ2luLXRvcDogMjBweDsgbWFyZ2luLWJvdHRvbTogMjVweDtcIj48L2Rpdj5cclxuICAgICAgPC9kaXY+XHJcbiAgICBgKTtcclxuICAgICQoXCIjcHJhY3RpY2VfY29udGFpbmVyXCIpLmFwcGVuZChwcmFjdGljZUNvbnRlbnQpO1xyXG4gIFxyXG4gICAgLy8gU2V0IGhlYWRlciBmb3IgdGhlIHByYWN0aWNlIHJvdW5kLlxyXG4gICAgJChcIiNwcmFjdGljZV9oZWFkZXJcIikuaHRtbChgPGgyPlByYWN0aWNlIFJvdW5kICgke3ByYWN0aWNlSW5kZXggKyAxfSBvZiAke3ByYWN0aWNlUXVlc3Rpb25zLmxlbmd0aH0pPC9oMj5gKTtcclxuICBcclxuICAgIGNvbnN0IGNvbmRpdGlvbiA9IGRhdGFbY3VycmVudENvbmRpdGlvbkluZGV4XS5jb25kaXRpb247XHJcbiAgICBjb25zdCBidWxsZXRQb2ludHM6IHN0cmluZ1tdID0gW107XHJcblxyXG4gICAgaWYgKGNvbmRpdGlvbiA9PT0gXCJoaWdobGlnaHRlZFwiKSB7XHJcbiAgICBidWxsZXRQb2ludHMucHVzaChcIlRoZSB0ZXh0IGlzIHJlZCBpZiB0aGUgbW9kZWwgaXMgdW5jZXJ0YWluIGFib3V0IGl0LiBUaGUgYnJpZ2h0ZXIgdGhlIHJlZCwgdGhlIG1vcmUgdW5jZXJ0YWluIHRoZSBtb2RlbCBpcyBhYm91dCB0aGF0IHNwZWNpZmljIHRleHQuXCIpO1xyXG4gICAgYnVsbGV0UG9pbnRzLnB1c2goXCJSZXZpZXcgdGhlIHRyYW5zY3JpcHRpb24gY2FyZWZ1bGx5IGFuZCBmaXggYW55IGVycm9ycyBieSBlZGl0aW5nIHRoZSBpbnB1dCBib3guXCIpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgIGJ1bGxldFBvaW50cy5wdXNoKFwiUmV2aWV3IHRoZSB0cmFuc2NyaXB0aW9uIGNhcmVmdWxseSBhbmQgZml4IGFueSBlcnJvcnMgYnkgZWRpdGluZyB0aGUgaW5wdXQgYm94LlwiKTtcclxuICAgIH1cclxuICAgIGJ1bGxldFBvaW50cy5wdXNoKFwiV2hlbiB0aGUgc2Vzc2lvbiBzdGFydHMsIHlvdSB3aWxsIGhhdmUgMjAgc2Vjb25kcyB0byBtb2RpZnkgZWFjaCB0cmFuc2NyaXB0aW9uLlwiKTtcclxuXHJcbiAgICAvLyBCdWlsZCBIVE1MIGZvciB0aGUgYnVsbGV0IGxpc3QgZHluYW1pY2FsbHlcclxuICAgIGNvbnN0IGJ1bGxldEh0bWwgPSBidWxsZXRQb2ludHMubWFwKHBvaW50ID0+IGA8bGk+JHtwb2ludH08L2xpPmApLmpvaW4oXCJcIik7XHJcblxyXG4gICAgLy8gSW5zZXJ0IHRoZSBpbnN0cnVjdGlvbnMgaW4gdGhlIHByYWN0aWNlIHJvdW5kIFVJXHJcbiAgICAkKFwiI3ByYWN0aWNlX2luc3RydWN0aW9uc1wiKS5odG1sKGBcclxuICAgIDxoMyBzdHlsZT1cImZvbnQtc2l6ZTogMS4xZW07IG1hcmdpbi1ib3R0b206IDVweDtcIj5JbnN0cnVjdGlvbnM6PC9oMz5cclxuICAgIDx1bCBzdHlsZT1cIm1hcmdpbi1sZWZ0OiAyMHB4O1wiPlxyXG4gICAgICAgICR7YnVsbGV0SHRtbH1cclxuICAgIDwvdWw+XHJcbiAgICBgKTtcclxuXHJcbiAgICAvLyBCdWlsZCBjb250ZW50OiBpbWFnZSwgcHJlZGljdGVkIHRleHQsIGFuZCBpbnB1dC5cclxuICAgIGNvbnN0IGNvbnRlbnRIdG1sID0gYFxyXG4gICAgICA8ZGl2IGlkPVwicHJhY3RpY2VfcXVlc3Rpb25fZGlzcGxheVwiIHN0eWxlPVwibWFyZ2luLXRvcDogMTBweDtcIj5cclxuICAgICAgICA8aW1nIGlkPVwicHJhY3RpY2VfcXVlc3Rpb25faW1hZ2VcIiBzcmM9XCJcIiBhbHQ9XCJQcmFjdGljZSBRdWVzdGlvbiBJbWFnZVwiIHN0eWxlPVwibWF4LXdpZHRoOiAxMDAlOyBoZWlnaHQ6IDExMHB4OyBvYmplY3QtZml0OiBjb250YWluO21hcmdpbi10b3A6IDIwcHg7XCI+XHJcbiAgICAgICAgPGRpdiBpZD1cInByYWN0aWNlX3ByZWRpY3RlZF90ZXh0X2NvbnRhaW5lclwiIHN0eWxlPVwibWFyZ2luLXRvcDogMjBweDtcIj5cclxuICAgICAgICAgIDxkaXYgc3R5bGU9XCJtYXJnaW4tdG9wOiAxMHB4O1wiPlByZWRpY3RlZCBUZXh0OjwvZGl2PlxyXG4gICAgICAgICAgPGRpdiBpZD1cInByYWN0aWNlX3ByZWRpY3RlZF90ZXh0XCIgc3R5bGU9XCJtYXJnaW4tdG9wOiAyMHB4O1wiPjwvZGl2PlxyXG4gICAgICAgIDwvZGl2PlxyXG4gICAgICAgIDxkaXYgaWQ9XCJwcmFjdGljZV90b2tlbl9pbnB1dF9jb250YWluZXJcIiBzdHlsZT1cIm1hcmdpbi10b3A6IDIwcHg7XCI+XHJcbiAgICAgICAgICA8aW5wdXQgaWQ9XCJwcmFjdGljZV90b2tlbl9pbnB1dFwiIHR5cGU9XCJ0ZXh0XCIgc3R5bGU9XCJ3aWR0aDogMTAwJTsgZm9udC1zaXplOiAxNnB4OyBwYWRkaW5nOiA4cHg7XCI+XHJcbiAgICAgICAgPC9kaXY+XHJcbiAgICAgIDwvZGl2PlxyXG4gICAgYDtcclxuICAgICQoXCIjcHJhY3RpY2VfY29udGVudFwiKS5odG1sKGNvbnRlbnRIdG1sKTtcclxuICBcclxuICAgIC8vIEdldCB0aGUgY3VycmVudCBwcmFjdGljZSBxdWVzdGlvbi5cclxuICAgIGNvbnN0IHF1ZXN0aW9uID0gcHJhY3RpY2VRdWVzdGlvbnNbcHJhY3RpY2VJbmRleF07XHJcbiAgXHJcbiAgICAvLyBTZXQgdGhlIHF1ZXN0aW9uIGltYWdlLlxyXG4gICAgaWYgKHF1ZXN0aW9uW1wiaW1hZ2VcIl0pIHtcclxuICAgICAgJChcIiNwcmFjdGljZV9xdWVzdGlvbl9pbWFnZVwiKS5hdHRyKFwic3JjXCIsIFwiZGF0YTppbWFnZS9wbmc7YmFzZTY0LFwiICsgcXVlc3Rpb25bXCJpbWFnZVwiXSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAkKFwiI3ByYWN0aWNlX3F1ZXN0aW9uX2ltYWdlXCIpLmF0dHIoXCJzcmNcIiwgXCJcIik7XHJcbiAgICB9XHJcbiAgXHJcbiAgICAvLyBSZW5kZXIgcHJlZGljdGVkIHRleHQgdXNpbmcgdG9rZW5faW5mby5cclxuICAgIGxldCBwcmVkaWN0ZWRIdG1sID0gXCJcIjtcclxuICAgIGlmIChxdWVzdGlvbltcInRva2VuX2luZm9cIl0gJiYgQXJyYXkuaXNBcnJheShxdWVzdGlvbltcInRva2VuX2luZm9cIl0pKSB7XHJcbiAgICAgICAgcHJlZGljdGVkSHRtbCA9IHF1ZXN0aW9uW1widG9rZW5faW5mb1wiXVxyXG4gICAgICAgIC5maWx0ZXIoaXRlbSA9PiBpdGVtLnRva2VuICE9PSBcIjx8aW1fZW5kfD5cIilcclxuICAgICAgICAubWFwKGl0ZW0gPT4ge1xyXG4gICAgICAgICAgLy8gUmVwbGFjZSB0aGUgc3BlY2lhbCBcIsSgXCIgd2l0aCBhIHNwYWNlXHJcbiAgICAgICAgICBsZXQgdG9rZW5UZXh0ID0gaXRlbS50b2tlbi5yZXBsYWNlKC/EoC9nLCBcIiBcIik7XHJcbiAgICAgICAgICBpZiAoZGF0YVtjdXJyZW50Q29uZGl0aW9uSW5kZXhdLmNvbmRpdGlvbiA9PT0gXCJoaWdobGlnaHRlZFwiKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHByb2IgPSAoaXRlbS50b3BfNV90b2tlbnMgJiZcclxuICAgICAgICAgICAgICAgICAgICAgICAgICBpdGVtLnRvcF81X3Rva2Vuc1swXSAmJlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGVvZiBpdGVtLnRvcF81X3Rva2Vuc1swXS5wcm9iYWJpbGl0eSA9PT0gXCJudW1iZXJcIilcclxuICAgICAgICAgICAgICAgICAgICAgICAgICA/IGl0ZW0udG9wXzVfdG9rZW5zWzBdLnByb2JhYmlsaXR5XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgOiAxO1xyXG4gICAgICAgICAgICBjb25zdCBpbnRlbnNpdHkgPSAxIC0gcHJvYjtcclxuICAgICAgICAgICAgLy8gQXBwbHkgZml4U3BhY2luZyB0byB0b2tlblRleHQgQkVGT1JFIHdyYXBwaW5nIGluIGEgc3Bhbi5cclxuICAgICAgICAgICAgdG9rZW5UZXh0ID0gZml4U3BhY2luZyh0b2tlblRleHQpO1xyXG4gICAgICAgICAgICByZXR1cm4gYDxzcGFuIHN0eWxlPVwiYmFja2dyb3VuZC1jb2xvcjogcmdiYSgyNTUsIDAsIDAsICR7aW50ZW5zaXR5fSk7XCI+JHt0b2tlblRleHR9PC9zcGFuPmA7XHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAvLyBGb3Igbm9uLWhpZ2hsaWdodGVkLCB5b3UgY2FuIGVpdGhlciBmaXggdGhlIGVudGlyZSBzdHJpbmcgbGF0ZXIgb3IgZml4IGVhY2ggdG9rZW4gaGVyZS5cclxuICAgICAgICAgICAgcmV0dXJuIGZpeFNwYWNpbmcodG9rZW5UZXh0KTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9KVxyXG4gICAgICAgIC5qb2luKCcnKTsgICAgICBcclxuICAgIH1cclxuICAgICQoXCIjcHJhY3RpY2VfcHJlZGljdGVkX3RleHRcIikuaHRtbChwcmVkaWN0ZWRIdG1sKTtcclxuICBcclxuICAgIC8vIFByZXBvcHVsYXRlIHRoZSB0ZXh0IGlucHV0LlxyXG4gICAgbGV0IHRva2Vuc0NvbmNhdGVuYXRlZCA9IFwiXCI7XHJcbiAgICBpZiAocXVlc3Rpb25bXCJ0b2tlbl9pbmZvXCJdICYmIEFycmF5LmlzQXJyYXkocXVlc3Rpb25bXCJ0b2tlbl9pbmZvXCJdKSkge1xyXG4gICAgICB0b2tlbnNDb25jYXRlbmF0ZWQgPSBxdWVzdGlvbltcInRva2VuX2luZm9cIl1cclxuICAgICAgICAubWFwKGl0ZW0gPT4gaXRlbS50b2tlbilcclxuICAgICAgICAuZmlsdGVyKHRva2VuID0+IHRva2VuICE9PSBcIjx8aW1fZW5kfD5cIilcclxuICAgICAgICAubWFwKHRva2VuID0+IHRva2VuLnJlcGxhY2UoL8SgL2csIFwiIFwiKSlcclxuICAgICAgICAuam9pbignJyk7XHJcbiAgICB9XHJcbiAgICAkKFwiI3ByYWN0aWNlX3Rva2VuX2lucHV0XCIpLnZhbChmaXhTcGFjaW5nKHRva2Vuc0NvbmNhdGVuYXRlZCkpO1xyXG4gIFxyXG4gICAgLy8gQWZ0ZXIgc2V0dGluZyB0aGUgcHJlZGljdGVkIHRleHQgaW4gI3ByYWN0aWNlX3ByZWRpY3RlZF90ZXh0LCBhZGQ6XHJcbiAgICBpZiAoY29uZGl0aW9uID09PSBcImhpZ2hsaWdodGVkXCIpe1xyXG4gICAgICAgIGxldCBhZGRpdGlvbmFsVGV4dCA9IFwiXCI7XHJcbiAgICAgICAgaWYgKHByYWN0aWNlSW5kZXggPT09IDApIHtcclxuICAgICAgICBhZGRpdGlvbmFsVGV4dCA9IFwiVGhlIG1vZGVsIGlzIHVuY2VydGFpbiBhYm91dCB0aGUgdGV4dCBcXFxcYm94ZWRcIjtcclxuICAgICAgICB9IGVsc2UgaWYgKHByYWN0aWNlSW5kZXggPT09IDEpIHtcclxuICAgICAgICBhZGRpdGlvbmFsVGV4dCA9IFwidGhlIG1vZGVsIHNob3dzIG5vIHVuY2VydGFpbnR5XCI7XHJcbiAgICAgICAgfSBlbHNlIGlmIChwcmFjdGljZUluZGV4ID09PSAyKSB7XHJcbiAgICAgICAgYWRkaXRpb25hbFRleHQgPSBcIlRoZSBtb2RlbCBpcyB1bmNlcnRhaW4gYWJvdXQgdGhyZWUgY2hhcmFjdGVyc1wiO1xyXG4gICAgICAgIH1cclxuICAgICAgICAkKFwiI3ByYWN0aWNlX3ByZWRpY3RlZF90ZXh0XCIpLmFwcGVuZChcclxuICAgICAgICBgPHNwYW4gc3R5bGU9XCJmb250LXN0eWxlOiBpdGFsaWM7IG1hcmdpbi1sZWZ0OiAyMHB4OyB2ZXJ0aWNhbC1hbGlnbjogbWlkZGxlO1wiPiR7YWRkaXRpb25hbFRleHR9PC9zcGFuPmBcclxuICAgICAgICApO1xyXG4gICAgXHJcbiAgICB9XHJcblxyXG5cclxuICAgIC8vIEJ1aWxkIG5hdmlnYXRpb24gYnV0dG9ucy5cclxuICAgIGNvbnN0IG5hdkh0bWwgPSBgXHJcbiAgICAgIDxkaXY+XHJcbiAgICAgICAgPGlucHV0IGlkPVwicHJhY3RpY2VfcHJldlwiIHR5cGU9XCJidXR0b25cIiB2YWx1ZT1cIlByZXZpb3VzIEV4YW1wbGVcIj5cclxuICAgICAgICA8aW5wdXQgaWQ9XCJwcmFjdGljZV9uZXh0XCIgdHlwZT1cImJ1dHRvblwiIHZhbHVlPVwiTmV4dCBFeGFtcGxlXCIgc3R5bGU9XCJtYXJnaW4tbGVmdDogMTBweDtcIj5cclxuICAgICAgPC9kaXY+XHJcbiAgICBgO1xyXG4gICAgJChcIiNwcmFjdGljZV9uYXZcIikuaHRtbChuYXZIdG1sKTtcclxuICBcclxuICAgIC8vIEF0dGFjaCBidXR0b24gaGFuZGxlcnMuXHJcbiAgICAkKFwiI3ByYWN0aWNlX3ByZXZcIikub2ZmKFwiY2xpY2tcIikub24oXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgIHByYWN0aWNlSW5kZXggPSAocHJhY3RpY2VJbmRleCAtIDEgKyBwcmFjdGljZVF1ZXN0aW9ucy5sZW5ndGgpICUgcHJhY3RpY2VRdWVzdGlvbnMubGVuZ3RoO1xyXG4gICAgICBzaG93UHJhY3RpY2VSb3VuZChvbkNvbXBsZXRlKTtcclxuICAgIH0pO1xyXG4gICAgJChcIiNwcmFjdGljZV9uZXh0XCIpLm9mZihcImNsaWNrXCIpLm9uKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICBwcmFjdGljZUluZGV4ID0gKHByYWN0aWNlSW5kZXggKyAxKSAlIHByYWN0aWNlUXVlc3Rpb25zLmxlbmd0aDtcclxuICAgICAgc2hvd1ByYWN0aWNlUm91bmQob25Db21wbGV0ZSk7XHJcbiAgICB9KTtcclxuICB9XHJcbiAgXHJcblxyXG5cclxuLyogTmV3IGZ1bmN0aW9uOiBTaG93IGVuZC1vZi1jb25kaXRpb24gcGFnZSAqL1xyXG5mdW5jdGlvbiBzaG93RW5kQ29uZGl0aW9uUGFnZShjb25kaXRpb246IHN0cmluZykge1xyXG4gICAgJChcIiNtYWluX2JveF9leHBlcmltZW50XCIpLmhpZGUoKTtcclxuICAgIGNvbnN0IGN1cnJlbnRDb25kaXRpb24gPSBkYXRhW2N1cnJlbnRDb25kaXRpb25JbmRleF0uY29uZGl0aW9uO1xyXG4gICAgJChcIiNjb25kaXRpb25fbGFiZWxcIikudGV4dChjdXJyZW50Q29uZGl0aW9uKTtcclxuICAgIC8vIFJlc2V0IGVhY2ggc2xpZGVyIHRvIGEgZGVmYXVsdCwgZS5nLiwgMFxyXG4gICAgJChcIiNtZW50YWxfZGVtYW5kXCIpLnZhbChcIjBcIik7XHJcbiAgICAkKFwiI2h1cnJpZWRfZGVtYW5kXCIpLnZhbChcIjBcIik7XHJcbiAgICAkKFwiI3BlcmZvcm1hbmNlXCIpLnZhbChcIjBcIik7XHJcbiAgICAkKFwiI2VmZm9ydFwiKS52YWwoXCIwXCIpO1xyXG4gICAgJChcIiNmcnVzdHJhdGlvblwiKS52YWwoXCIwXCIpO1xyXG5cclxuICAgICQoXCIjbmFzYV90bHhfc3VydmV5XCIpLnNob3coKTtcclxuICAgXHJcbn1cclxuXHJcblxyXG5cclxuZnVuY3Rpb24gbmV4dF9xdWVzdGlvbigpIHtcclxuICAgIC8vIHJlc3RvcmUgcHJldmlvdXMgc3RhdGUgb2YgVUlcclxuICAgICQoXCIjbWFpbl9ib3hfZXhwZXJpbWVudFwiKS5zaG93KCk7XHJcbiAgICAkKFwiI2J1dHRvbl9uZXh0XCIpLmhpZGUoKVxyXG4gICAgJCgnI2J1dHRvbl9xdWl0JykuaGlkZSgpXHJcbiAgICAvLyQoXCIjcmFuZ2VfdmFsXCIpLnZhbCh1c2VyX3RydXN0KVxyXG4gICAgLy8gY29uc29sZS5sb2coXCJxdWVzdGlvbiBpbmRleCwgY29uZGl0aW9uIGluZGV4XCIsIGN1cnJlbnRRdWVzdGlvbkluZGV4LCBjdXJyZW50Q29uZGl0aW9uSW5kZXgpICAgICAgICBcclxuXHJcbiAgICBpZiAoY3VycmVudENvbmRpdGlvbkluZGV4ID49IGRhdGEubGVuZ3RoKSB7XHJcbiAgICAgICAgJChcIiNtYWluX2JveF9leHBlcmltZW50XCIpLmhpZGUoKTtcclxuICAgICAgICAkKFwiI3F1YWxpdGF0aXZlX3NlY3Rpb25cIikuc2hvdygpO1xyXG4gICAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIGxldCBjb25kaXRpb25CbG9jayA9IGRhdGFbY3VycmVudENvbmRpdGlvbkluZGV4XTtcclxuICAgIC8vIGNvbnNvbGUubG9nKFwiQ29uZGl0aW9uIGJsb2NrXCIsIGNvbmRpdGlvbkJsb2NrKVxyXG4gICAgLy8gY29uc29sZS5sb2coZGF0YSlcclxuXHJcbiAgICAvLyBJZiB3ZSBhcmUgYXQgdGhlIHN0YXJ0IHBhZ2UgZm9yIHRoaXMgY29uZGl0aW9uLCBzaG93IGl0LlxyXG4gICAgaWYgKGN1cnJlbnRRdWVzdGlvbkluZGV4ID09PSAwKSB7XHJcbiAgICAgICAgc2hvd1N0YXJ0Q29uZGl0aW9uUGFnZShjb25kaXRpb25CbG9jay5jb25kaXRpb24pO1xyXG4gICAgICAgIHJldHVybjtcclxuICAgIH1cclxuXHJcbiAgICAvLyBJZiB3ZSd2ZSBnb25lIHBhc3QgYWxsIHF1ZXN0aW9ucyBpbiB0aGlzIGNvbmRpdGlvbiwgc2hvdyB0aGUgZW5kLW9mLWNvbmRpdGlvbiBwYWdlLlxyXG4gICAgaWYgKGN1cnJlbnRRdWVzdGlvbkluZGV4ID4gY29uZGl0aW9uQmxvY2sucXVlc3Rpb25zLmxlbmd0aCkge1xyXG4gICAgICAgIHNob3dFbmRDb25kaXRpb25QYWdlKGNvbmRpdGlvbkJsb2NrLmNvbmRpdGlvbik7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG5cclxuXHJcbiAgICBxdWVzdGlvbiA9IGNvbmRpdGlvbkJsb2NrLnF1ZXN0aW9uc1tjdXJyZW50UXVlc3Rpb25JbmRleCAtIDFdO1xyXG4gICAgLy8gY29uc29sZS5sb2coXCJRdWVzdGlvblwiLCBjdXJyZW50UXVlc3Rpb25JbmRleCwgcXVlc3Rpb24pXHJcbiAgICBcclxuICAgIFxyXG4gICAgLy8gLS0tIFVwZGF0ZSBQYXJ0IDEgZWxlbWVudHMgLS0tXHJcbiAgICAvLyBGb3IgdGhlIGltYWdlOiBhc3N1bWUgYSB2YWxpZCBCYXNlNjQgc3RyaW5nIGZvciBub3cuXHJcbiAgICBpZiAocXVlc3Rpb25bXCJpbWFnZVwiXSkge1xyXG4gICAgICAkKFwiI3F1ZXN0aW9uX2ltYWdlXCIpLmF0dHIoXCJzcmNcIiwgXCJkYXRhOmltYWdlL3BuZztiYXNlNjQsXCIgKyBxdWVzdGlvbltcImltYWdlXCJdKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICQoXCIjcXVlc3Rpb25faW1hZ2VcIikuYXR0cihcInNyY1wiLCBcIlwiKTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8gRGlzcGxheSB0aGUgcHJlZGljdGVkIHRleHQuXHJcbiAgICAvLyBCdWlsZCB0aGUgcHJlZGljdGVkIHRleHQgSFRNTCBieSBjb25jYXRlbmF0aW5nIHRva2VuX2luZm9cclxuICAgIGxldCBwcmVkaWN0ZWRIdG1sID0gXCJcIjtcclxuICAgIGlmIChxdWVzdGlvbltcInRva2VuX2luZm9cIl0gJiYgQXJyYXkuaXNBcnJheShxdWVzdGlvbltcInRva2VuX2luZm9cIl0pKSB7XHJcbiAgICAgICAgcHJlZGljdGVkSHRtbCA9IHF1ZXN0aW9uW1widG9rZW5faW5mb1wiXVxyXG4gICAgICAgIC5maWx0ZXIoaXRlbSA9PiBpdGVtLnRva2VuICE9PSBcIjx8aW1fZW5kfD5cIilcclxuICAgICAgICAubWFwKGl0ZW0gPT4ge1xyXG4gICAgICAgIGxldCB0b2tlblRleHQgPSBpdGVtLnRva2VuLnJlcGxhY2UoL8SgL2csIFwiIFwiKTtcclxuICAgICAgICBsZXQgcHJvYiA9IChpdGVtLnRvcF81X3Rva2VucyAmJlxyXG4gICAgICAgICAgICAgICAgICAgIGl0ZW0udG9wXzVfdG9rZW5zWzBdICYmXHJcbiAgICAgICAgICAgICAgICAgICAgdHlwZW9mIGl0ZW0udG9wXzVfdG9rZW5zWzBdLnByb2JhYmlsaXR5ID09PSBcIm51bWJlclwiKVxyXG4gICAgICAgICAgICAgICAgICAgID8gaXRlbS50b3BfNV90b2tlbnNbMF0ucHJvYmFiaWxpdHlcclxuICAgICAgICAgICAgICAgICAgICA6IDE7XHJcbiAgICAgICAgbGV0IGludGVuc2l0eSA9IDEgLSBwcm9iO1xyXG4gICAgICAgIGlmIChkYXRhW2N1cnJlbnRDb25kaXRpb25JbmRleF0uY29uZGl0aW9uID09IFwiaGlnaGxpZ2h0ZWRcIikge1xyXG4gICAgICAgICAgICAvLyBBcHBseSBmaXhTcGFjaW5nIG9uIHRoZSB0b2tlbiB0ZXh0IGJlZm9yZSB3cmFwcGluZyBpbiBzcGFuLlxyXG4gICAgICAgICAgICByZXR1cm4gYDxzcGFuIHN0eWxlPVwiYmFja2dyb3VuZC1jb2xvcjogcmdiYSgyNTUsIDAsIDAsICR7aW50ZW5zaXR5fSk7XCI+JHtmaXhTcGFjaW5nKHRva2VuVGV4dCl9PC9zcGFuPmA7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgLy8gRm9yIG5vbi1oaWdobGlnaHRlZCwgeW91IGNhbiBmaXggdGhlIHdob2xlIHN0cmluZyBhZnRlcndhcmRzIG9yIHBlciB0b2tlbi5cclxuICAgICAgICAgICAgcmV0dXJuIGZpeFNwYWNpbmcodG9rZW5UZXh0KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgfSlcclxuICAgICAgICAuam9pbignJyk7XHJcbiAgICB9XHJcbiQoXCIjcHJlZGljdGVkX3RleHRcIikuaHRtbChwcmVkaWN0ZWRIdG1sKTtcclxuXHJcbiAgICAgIFxyXG4gICAgXHJcbiAgICAvLyBDb25jYXRlbmF0ZSB0b2tlbnMgKHdpdGggcmVwbGFjZW1lbnQgb2YgxKAgYW5kIHNraXBwaW5nIDx8aW1fZW5kfD4pLlxyXG4gICAgbGV0IHRva2Vuc0NvbmNhdGVuYXRlZCA9IFwiXCI7XHJcbiAgICBpZiAocXVlc3Rpb25bXCJ0b2tlbl9pbmZvXCJdICYmIEFycmF5LmlzQXJyYXkocXVlc3Rpb25bXCJ0b2tlbl9pbmZvXCJdKSkge1xyXG4gICAgICAgIHRva2Vuc0NvbmNhdGVuYXRlZCA9IHF1ZXN0aW9uW1widG9rZW5faW5mb1wiXVxyXG4gICAgICAgICAgLm1hcChpdGVtID0+IGl0ZW0udG9rZW4pXHJcbiAgICAgICAgICAuZmlsdGVyKHRva2VuID0+IHRva2VuICE9PSBcIjx8aW1fZW5kfD5cIilcclxuICAgICAgICAgIC5tYXAodG9rZW4gPT4gdG9rZW4ucmVwbGFjZSgvxKAvZywgXCIgXCIpKVxyXG4gICAgICAgICAgLmpvaW4oJycpO1xyXG4gICAgfVxyXG4gICAgJChcIiN0b2tlbl9pbnB1dFwiKS52YWwoZml4U3BhY2luZyh0b2tlbnNDb25jYXRlbmF0ZWQpKTtcclxuICAgIFxyXG4gICAgLy8gKFVwZGF0ZSBwcm9ncmVzcyBhbmQgb3RoZXIgZWxlbWVudHMgYXMgbmVjZXNzYXJ5KVxyXG4gICAgJChcIiNwcm9ncmVzc1wiKS50ZXh0KGBTZWN0aW9uICR7Y3VycmVudENvbmRpdGlvbkluZGV4ICsgMX0gb2YgJHtkYXRhLmxlbmd0aH0gfCBRdWVzdGlvbiAke2N1cnJlbnRRdWVzdGlvbkluZGV4fSBvZiAke2NvbmRpdGlvbkJsb2NrLnF1ZXN0aW9ucy5sZW5ndGh9YCk7XHJcbiAgICAgICAgLy8gQWx3YXlzIHNob3cgUGFydCAxIGFuZCBoaWRlIFBhcnQgMiB3aGVuIGEgbmV3IHF1ZXN0aW9uIGxvYWRzLlxyXG4gICAgICAgICQoXCIjcGFydDFcIikuc2hvdygpO1xyXG4gICAgICAgICQoXCIjcGFydDJcIikuaGlkZSgpO1xyXG4gICAgXHJcbi8vIEF0IHRoZSBlbmQgb2YgbmV4dF9xdWVzdGlvbigpLCBhZnRlciB1cGRhdGluZyBhbGwgUGFydCAxIGVsZW1lbnRzOlxyXG4kKFwiI3Rva2VuX2lucHV0X2NvbnRhaW5lclwiKS5oaWRlKCk7XHJcbiQoXCIjYnV0dG9uX25leHRfcGFydDFcIikuaGlkZSgpO1xyXG5cclxuICAgIC8vIFNldCB0aGUgcHJlY2lzZSBxdWVzdGlvbiBzdGFydCB0aW1lIChpbiBtcylcclxuICAgIHF1ZXN0aW9uU3RhcnRUaW1lID0gRGF0ZS5ub3coKTtcclxuXHJcblxyXG4vLyBTdGFydCBhIDIwLXNlY29uZCB0aW1lciBmb3IgUGFydCAxXHJcbmNsZWFyVGltZW91dChwYXJ0MVRpbWVyKTtcclxucGFydDFUaW1lciA9IHdpbmRvdy5zZXRUaW1lb3V0KGF1dG9TdWJtaXRQYXJ0MSwgMjAwMDApO1xyXG5cclxuLy8gUmVzZXQgYW5kIHN0YXJ0IHRoZSB0aW1lciBmb3IgUGFydCAxXHJcbnJlbWFpbmluZ1RpbWUgPSAyMDtcclxuJChcIiN0aW1lclwiKS50ZXh0KHJlbWFpbmluZ1RpbWUpO1xyXG4kKFwiI3RpbWVyXCIpLnNob3coKTtcclxuXHJcbi8vIENsZWFyIGFueSBwcmV2aW91cyBpbnRlcnZhbFxyXG5pZiAocGFydDFJbnRlcnZhbCkge1xyXG4gICAgY2xlYXJJbnRlcnZhbChwYXJ0MUludGVydmFsKTtcclxufVxyXG5cclxuLy8gU3RhcnQgYSBuZXcgaW50ZXJ2YWwgdGhhdCBjb3VudHMgZG93biBldmVyeSBzZWNvbmRcclxucGFydDFJbnRlcnZhbCA9IHdpbmRvdy5zZXRJbnRlcnZhbCgoKSA9PiB7XHJcbiAgICByZW1haW5pbmdUaW1lIC09IDE7XHJcbiAgICAkKFwiI3RpbWVyXCIpLnRleHQocmVtYWluaW5nVGltZSk7XHJcblxyXG4gICAgLy8gV2hlbiB0aGVyZSBhcmUgMTUgc2Vjb25kcyBvciBsZXNzIHJlbWFpbmluZywgc2hvdyB0aGUgaW5wdXQgYm94IGFuZCBOZXh0IGJ1dHRvblxyXG4gICAgaWYgKHJlbWFpbmluZ1RpbWUgPD0gMTUpIHtcclxuICAgICAgICAkKFwiI3Rva2VuX2lucHV0X2NvbnRhaW5lclwiKS5zaG93KCk7XHJcbiAgICAgICAgJChcIiNidXR0b25fbmV4dF9wYXJ0MVwiKS5zaG93KCk7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKHJlbWFpbmluZ1RpbWUgPD0gMCkge1xyXG4gICAgICAgIGNsZWFySW50ZXJ2YWwocGFydDFJbnRlcnZhbCk7XHJcbiAgICAgICAgYXV0b1N1Ym1pdFBhcnQxKCk7XHJcbiAgICAgICAgJChcIiN0aW1lclwiKS5oaWRlKCk7XHJcbiAgICB9XHJcbn0sIDEwMDApO1xyXG5cclxuXHJcbn1cclxuXHJcbi8vIGdldCB1c2VyIGlkIGFuZCBsb2FkIHF1ZXVlXHJcbi8vIHRyeSB0byBzZWUgaWYgc3RhcnQgb3ZlcnJpZGUgd2FzIHBhc3NlZFxyXG5jb25zdCB1cmxQYXJhbXMgPSBuZXcgVVJMU2VhcmNoUGFyYW1zKHdpbmRvdy5sb2NhdGlvbi5zZWFyY2gpO1xyXG5jb25zdCBzdGFydE92ZXJyaWRlID0gdXJsUGFyYW1zLmdldCgnc3RhcnQnKTtcclxuY29uc3QgVUlERnJvbVVSTCA9IHVybFBhcmFtcy5nZXQoXCJ1aWRcIilcclxuZ2xvYmFsVGhpcy51cmxfZGF0YSA9IHBhcmFtc1RvT2JqZWN0KHVybFBhcmFtcy5lbnRyaWVzKCkpXHJcblxyXG5pZiAoZ2xvYmFsVGhpcy51cmxfZGF0YVsnc3R1ZHlfaWQnXSA9PSBudWxsKSB7XHJcbiAgICBnbG9iYWxUaGlzLnVybF9kYXRhWydzdHVkeV9pZCddID0gXCJkZW1vX3N0dWR5XCJcclxufVxyXG5pZiAoZ2xvYmFsVGhpcy51cmxfZGF0YVsncHJvbGlmaWNfaWQnXSA9PSBudWxsKSB7XHJcbiAgICBnbG9iYWxUaGlzLnVybF9kYXRhWydwcm9saWZpY19pZCddID0gXCJkZW1vX3VzZXJcIlxyXG59XHJcbmlmIChnbG9iYWxUaGlzLnVybF9kYXRhWydzZXNzaW9uX2lkJ10gPT0gbnVsbCkge1xyXG4gICAgZ2xvYmFsVGhpcy51cmxfZGF0YVsnc2Vzc2lvbl9pZCddID0gXCJkZW1vX3Nlc3Npb25cIlxyXG59XHJcblxyXG5pZiAoVUlERnJvbVVSTCAhPSBudWxsKSB7XHJcbiAgICBnbG9iYWxUaGlzLnVpZCA9IFVJREZyb21VUkwgYXMgc3RyaW5nXHJcbiAgICBpZiAoZ2xvYmFsVGhpcy51aWQgPT0gXCJwcm9saWZpY19yYW5kb21cIikge1xyXG4gICAgICAgIGxldCBxdWV1ZV9pZCA9IGAke01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwKX1gLnBhZFN0YXJ0KDMsIFwiMFwiKVxyXG4gICAgICAgIGdsb2JhbFRoaXMudWlkID0gYCR7dXJsUGFyYW1zLmdldChcInByb2xpZmljX3F1ZXVlX25hbWVcIil9LyR7cXVldWVfaWR9YFxyXG4gICAgfVxyXG59IGVsc2UgaWYgKERFVk1PREUpIHtcclxuICAgIGdsb2JhbFRoaXMudWlkID0gXCJkZW1vXCJcclxufSBlbHNlIHtcclxuICAgIGxldCBVSURfbWF5YmU6IGFueSA9IG51bGxcclxuICAgIHdoaWxlIChVSURfbWF5YmUgPT0gbnVsbCkge1xyXG4gICAgICAgIFVJRF9tYXliZSA9IHByb21wdChcIkVudGVyIHlvdXIgdXNlciBpZC4gUGxlYXNlIGdldCBpbiB0b3VjaCBpZiB5b3Ugd2VyZSBub3QgYXNzaWduZWQgYW4gaWQgYnV0IHdpc2ggdG8gcGFydGljaXBhdGUgaW4gdGhpcyBleHBlcmltZW50LlwiKVxyXG4gICAgfVxyXG4gICAgZ2xvYmFsVGhpcy51aWQgPSBVSURfbWF5YmUhXHJcbn1cclxuXHJcbi8vIHZlcnNpb24gZm9yIHBhcGVyXHJcbmlmIChERVZNT0RFKSB7XHJcbiAgICBNT0NLTU9ERSA9IHRydWVcclxufSBlbHNlIGlmIChnbG9iYWxUaGlzLnVybF9kYXRhWydzZXNzaW9uX2lkJ10uc3RhcnRzV2l0aChcImRlbW9cIikpIHtcclxuICAgIE1PQ0tNT0RFID0gdHJ1ZVxyXG59XHJcblxyXG4vLyBjb25zb2xlLmxvZyhcIlJ1bm5pbmcgd2l0aCBVSURcIiwgZ2xvYmFsVGhpcy51aWQpXHJcbmxvYWRfZGF0YSgpLmNhdGNoKChfZXJyb3IpID0+IHtcclxuICAgIC8vYWxlcnQoXCJJbnZhbGlkIHVzZXIgaWQuXCIpXHJcbiAgICAvLyBjb25zb2xlLmxvZyhcIkludmFsaWQgdXNlciBpZC5cIilcclxuICAgIC8vIGNvbnNvbGUubG9nKGdsb2JhbFRoaXMudWlkISlcclxuICAgIHdpbmRvdy5sb2NhdGlvbi5yZWxvYWQoKVxyXG59XHJcbikudGhlbigobmV3X2RhdGEpID0+IHtcclxuICAgIGRhdGEgPSBuZXdfZGF0YVxyXG4gICAgaWYgKHN0YXJ0T3ZlcnJpZGUgIT0gbnVsbCkge1xyXG4gICAgICAgIGN1cnJlbnRRdWVzdGlvbkluZGV4ID0gcGFyc2VJbnQoc3RhcnRPdmVycmlkZSkgLSAxXHJcbiAgICAgICAgLy8gY29uc29sZS5sb2coXCJTdGFydGluZyBmcm9tXCIsIGN1cnJlbnRRdWVzdGlvbkluZGV4KVxyXG4gICAgfVxyXG4gICAgLy8gbmV4dF9xdWVzdGlvbigpXHJcbiAgICBuZXh0X2luc3RydWN0aW9ucygwKVxyXG4gICAgJChcIiNtYWluX2JveF9pbnN0cnVjdGlvbnNcIikuc2hvdygpXHJcbiAgICAkKFwiI2luc3RydWN0aW9uc19hbmRfZGVjb3JhdGlvbnNcIikuaGlkZSgpXHJcbn0pXHJcblxyXG4vLyBjb25zb2xlLmxvZyhcIlN0YXJ0aW5nIHNlc3Npb24gd2l0aCBVSUQ6XCIsIGdsb2JhbFRoaXMudWlkISlcclxuXHJcbmxldCBhbGVydF9hY3RpdmUgPSBmYWxzZVxyXG5kb2N1bWVudC5vbnZpc2liaWxpdHljaGFuZ2UgPSAoKSA9PiB7XHJcbiAgICBpZiAoIWFsZXJ0X2FjdGl2ZSkge1xyXG4gICAgICAgIGNvdW50X2V4aXRlZF9wYWdlICs9IDFcclxuICAgICAgICBhbGVydF9hY3RpdmUgPSB0cnVlXHJcbiAgICAgICAgLy9pZiAoIShnbG9iYWxUaGlzLnVpZCEuc3RhcnRzV2l0aChcImRlbW9cIikpKSB7XHJcbiAgICAgICAgLy8gICAgYWxlcnQoXCJQbGVhc2UgZG9uJ3QgbGVhdmUgdGhlIHBhZ2UuIElmIHlvdSBkbyBzbyBhZ2Fpbiwgd2UgbWF5IHJlc3RyaWN0IHBheWluZyB5b3UuXCIpXHJcbiAgICAgICAgLy99XHJcbiAgICAgICAgYWxlcnRfYWN0aXZlID0gZmFsc2VcclxuICAgIH1cclxufVxyXG5cclxuLy8gV2hlbiB0aGUgRE9NIGlzIHJlYWR5OlxyXG4kKGRvY3VtZW50KS5yZWFkeSgoKSA9PiB7XHJcbiAgICAvLyBUcmFuc2l0aW9uIGZyb20gUGFydCAxIChxdWVzdGlvbikgdG8gUGFydCAyIChjb25maWRlbmNlIHJhdGluZylcclxuICAgICQoXCIjYnV0dG9uX25leHRfcGFydDFcIikub24oXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgICAgLy8gQ2xlYXIgdGltZXIgYW5kIHRyYW5zaXRpb24gdG8gUGFydCAyIChjb25maWRlbmNlIHJhdGluZylcclxuICAgICAgICBsb2dJbnB1dEV2ZW50KFwibmV4dF9idXR0b25fc3VibWl0dGVkXCIpO1xyXG4gICAgICAgIGNsZWFyVGltZW91dChwYXJ0MVRpbWVyKTtcclxuICAgICAgICAkKFwiI3RpbWVyXCIpLmhpZGUoKTtcclxuICAgICAgICAkKFwiI3BhcnQxXCIpLmhpZGUoKTtcclxuICAgICAgICAkKFwiI3BhcnQyXCIpLnNob3coKTtcclxuXHJcbiAgICB9KTtcclxuICBcclxuICAgIC8vIEhhbmRsZSBjb25maWRlbmNlIHJhdGluZyBzZWxlY3Rpb25zOlxyXG4gICAgJChcIi5jb25maWRlbmNlLWJ1dHRvblwiKS5vbihcImNsaWNrXCIsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGxldCByYXRpbmcgPSBwYXJzZUludCgkKHRoaXMpLmF0dHIoXCJkYXRhLXJhdGluZ1wiKSBhcyBzdHJpbmcpO1xyXG4gICAgICAgIC8vIFJlbW92ZSAnc2VsZWN0ZWQnIGZyb20gYWxsIGJ1dHRvbnMsIHRoZW4gYWRkIGl0IHRvIHRoZSBjbGlja2VkIG9uZS5cclxuICAgICAgICAkKFwiLmNvbmZpZGVuY2UtYnV0dG9uXCIpLnJlbW92ZUNsYXNzKFwic2VsZWN0ZWRcIik7XHJcbiAgICAgICAgJCh0aGlzKS5hZGRDbGFzcyhcInNlbGVjdGVkXCIpO1xyXG4gICAgICAgIC8vIFN0b3JlIHRoZSByYXRpbmcgYW5kIGVuYWJsZSB0aGUgUGFydCAyIE5leHQgYnV0dG9uLlxyXG4gICAgICAgIGNvbmZpZGVuY2VSYXRpbmcgPSByYXRpbmc7XHJcbiAgICAgICAgJChcIiNidXR0b25fbmV4dF9wYXJ0MlwiKS5yZW1vdmVBdHRyKFwiZGlzYWJsZWRcIik7XHJcbiAgICB9KTtcclxuICBcclxuICAgIC8vIFRyYW5zaXRpb24gZnJvbSBQYXJ0IDIgKGNvbmZpZGVuY2UgcmF0aW5nKSB0byB0aGUgbmV4dCBxdWVzdGlvbi5cclxuICAgICQoXCIjYnV0dG9uX25leHRfcGFydDJcIikub24oXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgIC8vIExvZyB0aGUgY29uZmlkZW5jZSByYXRpbmcgYWxvbmcgd2l0aCBvdGhlciBkYXRhIGlmIG5lZWRlZC5cclxuICAgICAgbGV0IGxvZ2dlZF9kYXRhID0ge1xyXG4gICAgICAgIFwicXVlc3Rpb25faVwiOiBjdXJyZW50UXVlc3Rpb25JbmRleCxcclxuICAgICAgICBcInFpZFwiIDogcXVlc3Rpb25bXCJxaWRcIl0sXHJcbiAgICAgICAgXCJjb25kaXRpb25cIjogZGF0YVtjdXJyZW50Q29uZGl0aW9uSW5kZXhdLmNvbmRpdGlvbixcclxuICAgICAgICBcImNvbmZpZGVuY2VfcmF0aW5nXCI6IGNvbmZpZGVuY2VSYXRpbmcsXHJcbiAgICAgICAgLy8gLi4uIGluY2x1ZGUgb3RoZXIgbG9nZ2luZyBmaWVsZHMgYXMgZGVzaXJlZFxyXG4gICAgICB9O1xyXG4gICAgICBsb2dfZGF0YShsb2dnZWRfZGF0YSk7XHJcbiAgICAgIFxyXG4gICAgICAvLyBSZXNldCBQYXJ0IDIgVUkgZWxlbWVudHMgZm9yIHRoZSBuZXh0IHF1ZXN0aW9uLlxyXG4gICAgICAkKFwiI2J1dHRvbl9uZXh0X3BhcnQyXCIpLmF0dHIoXCJkaXNhYmxlZFwiLCBcInRydWVcIik7XHJcbiAgICAgICQoXCIuY29uZmlkZW5jZS1idXR0b25cIikucmVtb3ZlQ2xhc3MoXCJzZWxlY3RlZFwiKTtcclxuICAgICAgY29uZmlkZW5jZVJhdGluZyA9IC0xO1xyXG4gICAgICBcclxuICAgICAgLy8gU3dpdGNoIGJhY2sgdG8gUGFydCAxIGFuZCBsb2FkIHRoZSBuZXh0IHF1ZXN0aW9uLlxyXG4gICAgICAkKFwiI3BhcnQyXCIpLmhpZGUoKTtcclxuICAgICAgJChcIiNwYXJ0MVwiKS5zaG93KCk7XHJcbiAgICAgIGN1cnJlbnRRdWVzdGlvbkluZGV4Kys7XHJcbiAgICAgIG5leHRfcXVlc3Rpb24oKTtcclxuICAgIH0pO1xyXG4gICAgJChcImlucHV0W25hbWU9J2xhdGV4RXhwZXJpZW5jZSddLCBpbnB1dFtuYW1lPSdsYXRleEZyZXF1ZW5jeSddLCBpbnB1dFtuYW1lPSdjaGF0Ym90RnJlcXVlbmN5J11cIikub24oXCJjaGFuZ2VcIiwgKCkgPT4ge1xyXG4gICAgICAgIGlmKGNoZWNrUHJlU3VydmV5KCkpIHtcclxuICAgICAgICAgICAgJChcIiNidXR0b25faW5zdHJ1Y3Rpb25zX25leHRcIikucmVtb3ZlQXR0cihcImRpc2FibGVkXCIpXHJcbiAgICAgICAgICAgICQoXCIjYnV0dG9uX2luc3RydWN0aW9uc19uZXh0XCIpLnNob3coKSAgICAgICAgICAgIFxyXG4gICAgICAgIH1cclxuXHJcbiAgICB9KTtcclxuICAgIC8vIGtleWxvZyB0aGUgaW5wdXRcclxuICAgICQoXCIjdG9rZW5faW5wdXRcIikub24oXCJpbnB1dFwiLCBmdW5jdGlvbigpIHtcclxuICAgICAgICBsb2dJbnB1dEV2ZW50KFwiaW5wdXRfY2hhbmdlXCIpO1xyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIFxyXG4vLyBHbG9iYWwgb2JqZWN0IHRvIHRyYWNrIHdoZXRoZXIgYSBzbGlkZXIgd2FzIGNoYW5nZWQuXHJcbmludGVyZmFjZSBTbGlkZXJTdGF0ZSB7XHJcbiAgICBtZW50YWxfZGVtYW5kOiBib29sZWFuO1xyXG4gICAgaHVycmllZF9kZW1hbmQ6IGJvb2xlYW47XHJcbiAgICBwZXJmb3JtYW5jZTogYm9vbGVhbjtcclxuICAgIGVmZm9ydDogYm9vbGVhbjtcclxuICAgIGZydXN0cmF0aW9uOiBib29sZWFuO1xyXG59XHJcblxyXG5jb25zdCBzbGlkZXJDaGFuZ2VkOiBTbGlkZXJTdGF0ZSA9IHtcclxuICAgIG1lbnRhbF9kZW1hbmQ6IGZhbHNlLFxyXG4gICAgaHVycmllZF9kZW1hbmQ6IGZhbHNlLFxyXG4gICAgcGVyZm9ybWFuY2U6IGZhbHNlLFxyXG4gICAgZWZmb3J0OiBmYWxzZSxcclxuICAgIGZydXN0cmF0aW9uOiBmYWxzZVxyXG59O1xyXG5cclxuLy8gR2xvYmFsIG9iamVjdCB0byBzdG9yZSB0aGUgc2VsZWN0ZWQgdmFsdWVzLiAobnVsbCBpbmRpY2F0ZXMgbm8gc2VsZWN0aW9uIHlldClcclxuY29uc3QgdGx4VmFsdWVzOiB7IFtrZXk6IHN0cmluZ106IG51bWJlciB8IG51bGwgfSA9IHtcclxuICAgIG1lbnRhbF9kZW1hbmQ6IG51bGwsXHJcbiAgICBodXJyaWVkX2RlbWFuZDogbnVsbCxcclxuICAgIHBlcmZvcm1hbmNlOiBudWxsLFxyXG4gICAgZWZmb3J0OiBudWxsLFxyXG4gICAgZnJ1c3RyYXRpb246IG51bGxcclxufTtcclxuXHJcbmZ1bmN0aW9uIGNoZWNrQWxsU2xpZGVyc0NoYW5nZWQoKTogYm9vbGVhbiB7XHJcbiAgICByZXR1cm4gT2JqZWN0LnZhbHVlcyhzbGlkZXJDaGFuZ2VkKS5ldmVyeSh2YWx1ZSA9PiB2YWx1ZSA9PT0gdHJ1ZSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHJlc2V0U2xpZGVycygpIHtcclxuICAgIC8vIFJlc2V0IHRyYWNraW5nIG9iamVjdCBhbmQgc2VsZWN0ZWQgdmFsdWVzXHJcbiAgICBmb3IgKGxldCBrZXkgaW4gc2xpZGVyQ2hhbmdlZCkge1xyXG4gICAgICAgIHNsaWRlckNoYW5nZWRba2V5IGFzIGtleW9mIFNsaWRlclN0YXRlXSA9IGZhbHNlO1xyXG4gICAgfVxyXG4gICAgZm9yIChsZXQga2V5IGluIHRseFZhbHVlcykge1xyXG4gICAgICAgIHRseFZhbHVlc1trZXldID0gbnVsbDtcclxuICAgIH1cclxuICAgIC8vIFJlbW92ZSBzZWxlY3Rpb24gaGlnaGxpZ2h0IGZyb20gYWxsIGJveGVzXHJcbiAgICAkKFwiLnRseC1ib3hcIikucmVtb3ZlQ2xhc3MoXCJzZWxlY3RlZFwiKTtcclxuICAgIG5leHRCdXR0b24ucHJvcChcImRpc2FibGVkXCIsIHRydWUpO1xyXG59XHJcblxyXG4vLyBEaXNhYmxlIHRoZSBcIk5leHRcIiBidXR0b24gaW5pdGlhbGx5XHJcbmNvbnN0IG5leHRCdXR0b24gPSAkKFwiI25hc2FfdGx4X25leHRcIikgYXMgSlF1ZXJ5PEhUTUxJbnB1dEVsZW1lbnQ+O1xyXG5uZXh0QnV0dG9uLnByb3AoXCJkaXNhYmxlZFwiLCB0cnVlKTtcclxuXHJcbi8vIEV2ZW50IGxpc3RlbmVyIGZvciBhbGwgc2xpZGVyc1xyXG4kKFwiLnRseC1ib3hcIikub24oXCJjbGlja1wiLCBmdW5jdGlvbigpIHtcclxuICAgIGNvbnN0IHNsaWRlcklkID0gJCh0aGlzKS5wYXJlbnQoKS5hdHRyKFwiaWRcIik7IC8vIGUuZy4sIFwibWVudGFsX2RlbWFuZFwiXHJcbiAgICBpZiAoIXNsaWRlcklkIHx8ICEoc2xpZGVySWQgaW4gc2xpZGVyQ2hhbmdlZCkpIHJldHVybjtcclxuICAgIGNvbnN0IHZhbHVlID0gcGFyc2VJbnQoJCh0aGlzKS5hdHRyKFwiZGF0YS12YWx1ZVwiKSBhcyBzdHJpbmcpO1xyXG4gICAgdGx4VmFsdWVzW3NsaWRlcklkXSA9IHZhbHVlO1xyXG4gICAgc2xpZGVyQ2hhbmdlZFtzbGlkZXJJZCBhcyBrZXlvZiBTbGlkZXJTdGF0ZV0gPSB0cnVlO1xyXG4gICAgXHJcbiAgICAvLyBVcGRhdGUgVUk6IG1hcmsgdGhpcyBib3ggYXMgc2VsZWN0ZWQgYW5kIHJlbW92ZSBzZWxlY3Rpb24gZnJvbSBzaWJsaW5ncy5cclxuICAgICQodGhpcykuc2libGluZ3MoKS5yZW1vdmVDbGFzcyhcInNlbGVjdGVkXCIpO1xyXG4gICAgJCh0aGlzKS5hZGRDbGFzcyhcInNlbGVjdGVkXCIpO1xyXG5cclxuICAgIC8vIEVuYWJsZSB0aGUgTmV4dCBidXR0b24gaWYgYWxsIHNsaWRlcnMgaGF2ZSBiZWVuIGNoYW5nZWQuXHJcbiAgICBpZiAoY2hlY2tBbGxTbGlkZXJzQ2hhbmdlZCgpKSB7XHJcbiAgICAgICAgbmV4dEJ1dHRvbi5wcm9wKFwiZGlzYWJsZWRcIiwgZmFsc2UpO1xyXG4gICAgfVxyXG59KTtcclxuXHJcbi8vIEV2ZW50IGxpc3RlbmVyIGZvciBcIk5leHRcIiBidXR0b24gaW4gTkFTQSBUTFggc3VydmV5XHJcbm5leHRCdXR0b24ub24oXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICBpZiAoIWNoZWNrQWxsU2xpZGVyc0NoYW5nZWQoKSkge1xyXG4gICAgICAgIGFsZXJ0KFwiUGxlYXNlIGFkanVzdCBhbGwgc2xpZGVycyBiZWZvcmUgY29udGludWluZy5cIik7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IHRseERhdGEgPSB7XHJcbiAgICAgICAgbWVudGFsX2RlbWFuZDogdGx4VmFsdWVzW1wibWVudGFsX2RlbWFuZFwiXSAhPT0gbnVsbCA/IHRseFZhbHVlc1tcIm1lbnRhbF9kZW1hbmRcIl0gOiAwLFxyXG4gICAgICAgIGh1cnJpZWRfZGVtYW5kOiB0bHhWYWx1ZXNbXCJodXJyaWVkX2RlbWFuZFwiXSAhPT0gbnVsbCA/IHRseFZhbHVlc1tcImh1cnJpZWRfZGVtYW5kXCJdIDogMCxcclxuICAgICAgICBwZXJmb3JtYW5jZTogdGx4VmFsdWVzW1wicGVyZm9ybWFuY2VcIl0gIT09IG51bGwgPyB0bHhWYWx1ZXNbXCJwZXJmb3JtYW5jZVwiXSA6IDAsXHJcbiAgICAgICAgZWZmb3J0OiB0bHhWYWx1ZXNbXCJlZmZvcnRcIl0gIT09IG51bGwgPyB0bHhWYWx1ZXNbXCJlZmZvcnRcIl0gOiAwLFxyXG4gICAgICAgIGZydXN0cmF0aW9uOiB0bHhWYWx1ZXNbXCJmcnVzdHJhdGlvblwiXSAhPT0gbnVsbCA/IHRseFZhbHVlc1tcImZydXN0cmF0aW9uXCJdIDogMFxyXG4gICAgfTtcclxuICAgIFxyXG5cclxuICAgIGxvZ19kYXRhKHtcclxuICAgICAgICBjb25kaXRpb246ICQoXCIjY29uZGl0aW9uX2xhYmVsXCIpLnRleHQoKSxcclxuICAgICAgICBjb25kaXRpb25faW5kZXg6IGN1cnJlbnRDb25kaXRpb25JbmRleCxcclxuICAgICAgICB0bHg6IHRseERhdGFcclxuICAgIH0pO1xyXG5cclxuICAgIC8vIEhpZGUgdGhlIE5BU0EgVExYIHBhZ2UgYW5kIG1vdmUgb25cclxuICAgIHJlc2V0U2xpZGVycygpO1xyXG4gICAgJChcIiNuYXNhX3RseF9zdXJ2ZXlcIikuaGlkZSgpO1xyXG4gICAgY3VycmVudENvbmRpdGlvbkluZGV4Kys7XHJcbiAgICBjdXJyZW50UXVlc3Rpb25JbmRleCA9IDA7XHJcbiAgICBuZXh0X3F1ZXN0aW9uKCk7XHJcbn0pO1xyXG5cclxuICAgIFxyXG5cclxufSk7XHJcbiAgZnVuY3Rpb24gYXV0b1N1Ym1pdFBhcnQxKCkge1xyXG4gICAgbG9nSW5wdXRFdmVudChcImF1dG9fc3VibWl0XCIpO1xyXG4gICAgLy8gU3RvcCB0aGUgdGltZXIgaWYgbm90IGFscmVhZHkgY2xlYXJlZFxyXG4gICAgY2xlYXJJbnRlcnZhbChwYXJ0MUludGVydmFsKTtcclxuICAgICQoXCIjdGltZXJcIikuaGlkZSgpO1xyXG4gICAgXHJcbiAgICAvLyBBdXRvbWF0aWNhbGx5IHRyYW5zaXRpb24gdG8gUGFydCAyXHJcbiAgICAkKFwiI3BhcnQxXCIpLmhpZGUoKTtcclxuICAgICQoXCIjcGFydDJcIikuc2hvdygpO1xyXG59XHJcbiQoXCIjcXVhbF9uZXh0XCIpLm9uKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgY29uc3QgcTEgPSAoJChcIiNxdWFsX3ExXCIpLnZhbCgpIGFzIHN0cmluZykgfHwgXCJcIjtcclxuICAgIGNvbnN0IHEyID0gKCQoXCIjcXVhbF9xMlwiKS52YWwoKSBhcyBzdHJpbmcpIHx8IFwiXCI7XHJcbiAgICBjb25zdCBxMyA9ICgkKFwiI3F1YWxfcTNcIikudmFsKCkgYXMgc3RyaW5nKSB8fCBcIlwiO1xyXG4gICAgXHJcbiAgICBsZXQgdmFsaWQgPSB0cnVlO1xyXG4gICAgXHJcbiAgICBpZiAocTEubGVuZ3RoIDwgMjUpIHtcclxuICAgICAgICAkKFwiI3dhcm5fcTFcIikuc2hvdygpO1xyXG4gICAgICAgIHZhbGlkID0gZmFsc2U7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgICQoXCIjd2Fybl9xMVwiKS5oaWRlKCk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGlmIChxMi5sZW5ndGggPCAyNSkge1xyXG4gICAgICAgICQoXCIjd2Fybl9xMlwiKS5zaG93KCk7XHJcbiAgICAgICAgdmFsaWQgPSBmYWxzZTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgJChcIiN3YXJuX3EyXCIpLmhpZGUoKTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgaWYgKHEzLmxlbmd0aCA8IDApIHtcclxuICAgICAgICAkKFwiI3dhcm5fcTNcIikuc2hvdygpO1xyXG4gICAgICAgIHZhbGlkID0gZmFsc2U7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgICQoXCIjd2Fybl9xM1wiKS5oaWRlKCk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIElmIHZhbGlkYXRpb24gZmFpbHMsIGRvIG5vdCBwcm9jZWVkXHJcbiAgICBpZiAoIXZhbGlkKSB7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyBJZiBhbGwgdGV4dCBib3hlcyBoYXZlIGF0IGxlYXN0IDUwIGNoYXJhY3RlcnMsIGxvZyBkYXRhIGFuZCBwcm9jZWVkXHJcbiAgICBjb25zdCBmaW5hbERhdGEgPSB7XHJcbiAgICAgICAgcXVhbGl0YXRpdmU6IHtcclxuICAgICAgICAgICAgcTE6IHExLFxyXG4gICAgICAgICAgICBxMjogcTIsXHJcbiAgICAgICAgICAgIHEzOiBxM1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgLy8gLi4uIGluY2x1ZGUgYW55IGFkZGl0aW9uYWwgZGF0YSBpZiBuZWVkZWRcclxuICAgIH07XHJcbiAgICBsb2dfZGF0YShmaW5hbERhdGEpO1xyXG4gICAgXHJcbiAgICAvLyBUcmFuc2l0aW9uIHRvIGVuZC1vZi1zdXJ2ZXkg4oCcVGhhbmsgeW914oCdIHNjcmVlbiBvciBzaW1pbGFyLlxyXG4gICAgJChcIiNxdWFsaXRhdGl2ZV9zZWN0aW9uXCIpLmhpZGUoKTtcclxuICAgIGlmIChNT0NLTU9ERSkge1xyXG4gICAgICAgICQoJyNyZXdhcmRfYm94X21vY2snKS50ZXh0KGBZb3VyIHRvdGFsIHJld2FyZCBpcyAkMy4wMC5gKTtcclxuICAgICAgICAkKCcjcmV3YXJkX2JveF9tb2NrJykuc2hvdygpO1xyXG4gICAgICAgICQoXCIjbWFpbl9ib3hfZW5kX21vY2tcIikuc2hvdygpOyAgICBcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgJCgnI3Jld2FyZF9ib3gnKS50ZXh0KGBZb3VyIHRvdGFsIHJld2FyZCBpcyAkMy4wMC5gKTtcclxuICAgICAgICAkKCcjcmV3YXJkX2JveCcpLnNob3coKTtcclxuICAgICAgICAkKFwiI21haW5fYm94X2VuZFwiKS5zaG93KCk7ICAgIFxyXG4gICAgfVxyXG59KTtcclxuIl0sIm5hbWVzIjpbIlNFUlZFUl9MT0dfUk9PVCIsImFzeW5jIiwibG9nX2RhdGEiLCJkYXRhIiwiZ2xvYmFsVGhpcyIsInVybF9kYXRhIiwiY29uc29sZSIsImxvZyIsInVpZCIsInJlc3VsdCIsIiQiLCJhamF4IiwiSlNPTiIsInN0cmluZ2lmeSIsInByb2plY3QiLCJwYXlsb2FkIiwidHlwZSIsImNvbnRlbnRUeXBlIiwiUHJvbWlzZSIsInJlc29sdmUiLCJzZXRUaW1lb3V0Iiwic2xlZXAiLCJlIiwiZml4U3BhY2luZyIsImlucHV0Iiwib3V0cHV0IiwicmVwbGFjZSIsIk1PQ0tNT0RFIiwicXVlc3Rpb24iLCJjb25maWRlbmNlUmF0aW5nIiwicGFydDFUaW1lciIsInBhcnQxSW50ZXJ2YWwiLCJyZW1haW5pbmdUaW1lIiwiY3VycmVudENvbmRpdGlvbkluZGV4IiwiY3VycmVudFF1ZXN0aW9uSW5kZXgiLCJwcmVTdXJ2ZXlMb2dnZWQiLCJxdWVzdGlvblN0YXJ0VGltZSIsIkRhdGUiLCJub3ciLCJpbnN0cnVjdGlvbl9pIiwiY291bnRfZXhpdGVkX3BhZ2UiLCJjaGVja1ByZVN1cnZleSIsImxhdGV4RXhwIiwidmFsIiwibGF0ZXhGcmVxIiwiY2hhdGJvdEZyZXEiLCJzaG93IiwiaGlkZSIsImxvZ0lucHV0RXZlbnQiLCJldmVudFR5cGUiLCJwcmVjaXNlVGltZSIsInRvRml4ZWQiLCJxaWQiLCJjb25kaXRpb24iLCJjdXJyZW50VGV4dCIsImtleWxvZyIsImV2ZW50IiwiY29uZGl0aW9uX2luZGV4IiwicHJlY2lzZV90aW1lIiwibmV4dF9pbnN0cnVjdGlvbnMiLCJpbmNyZW1lbnQiLCJhdHRyIiwicmVtb3ZlQXR0ciIsInByZV9zdXJ2ZXkiLCJsYXRleEV4cGVyaWVuY2UiLCJsYXRleEZyZXF1ZW5jeSIsImNoYXRib3RGcmVxdWVuY3kiLCJuZXh0X3F1ZXN0aW9uIiwiY2hpbGRyZW4iLCJlYWNoIiwiXyIsImVsIiwib24iLCJwcmFjdGljZVF1ZXN0aW9ucyIsInByYWN0aWNlSW5kZXgiLCJzaG93UHJhY3RpY2VSb3VuZCIsIm9uQ29tcGxldGUiLCJlbXB0eSIsInByYWN0aWNlQ29udGVudCIsImFwcGVuZCIsImh0bWwiLCJsZW5ndGgiLCJidWxsZXRQb2ludHMiLCJwdXNoIiwiYnVsbGV0SHRtbCIsIm1hcCIsInBvaW50Iiwiam9pbiIsInByZWRpY3RlZEh0bWwiLCJBcnJheSIsImlzQXJyYXkiLCJmaWx0ZXIiLCJpdGVtIiwidG9rZW4iLCJ0b2tlblRleHQiLCJpbnRlbnNpdHkiLCJ0b3BfNV90b2tlbnMiLCJwcm9iYWJpbGl0eSIsInRva2Vuc0NvbmNhdGVuYXRlZCIsImFkZGl0aW9uYWxUZXh0Iiwib2ZmIiwiY29uZGl0aW9uQmxvY2siLCJoZWFkZXJIdG1sIiwicmVqZWN0IiwiZ2V0SlNPTiIsImRvbmUiLCJmYWlsIiwianF4aHIiLCJ0ZXh0U3RhdHVzIiwiZXJyb3IiLCJ0aGVuIiwiY2F0Y2giLCJlcnIiLCJzaG93U3RhcnRDb25kaXRpb25QYWdlIiwicXVlc3Rpb25zIiwiY3VycmVudENvbmRpdGlvbiIsInRleHQiLCJzaG93RW5kQ29uZGl0aW9uUGFnZSIsImNsZWFyVGltZW91dCIsIndpbmRvdyIsImF1dG9TdWJtaXRQYXJ0MSIsImNsZWFySW50ZXJ2YWwiLCJzZXRJbnRlcnZhbCIsInVybFBhcmFtcyIsIlVSTFNlYXJjaFBhcmFtcyIsImxvY2F0aW9uIiwic2VhcmNoIiwic3RhcnRPdmVycmlkZSIsImdldCIsIlVJREZyb21VUkwiLCJlbnRyaWVzIiwia2V5IiwidmFsdWUiLCJwYXJhbXNUb09iamVjdCIsInF1ZXVlX2lkIiwiTWF0aCIsImZsb29yIiwicmFuZG9tIiwicGFkU3RhcnQiLCJVSURfbWF5YmUiLCJwcm9tcHQiLCJzdGFydHNXaXRoIiwibG9hZF9kYXRhIiwiX2Vycm9yIiwicmVsb2FkIiwibmV3X2RhdGEiLCJwYXJzZUludCIsImFsZXJ0X2FjdGl2ZSIsImRvY3VtZW50Iiwib252aXNpYmlsaXR5Y2hhbmdlIiwicmVhZHkiLCJyYXRpbmciLCJ0aGlzIiwicmVtb3ZlQ2xhc3MiLCJhZGRDbGFzcyIsInNsaWRlckNoYW5nZWQiLCJtZW50YWxfZGVtYW5kIiwiaHVycmllZF9kZW1hbmQiLCJwZXJmb3JtYW5jZSIsImVmZm9ydCIsImZydXN0cmF0aW9uIiwidGx4VmFsdWVzIiwiY2hlY2tBbGxTbGlkZXJzQ2hhbmdlZCIsIk9iamVjdCIsInZhbHVlcyIsImV2ZXJ5IiwibmV4dEJ1dHRvbiIsInByb3AiLCJzbGlkZXJJZCIsInBhcmVudCIsInNpYmxpbmdzIiwiYWxlcnQiLCJ0bHhEYXRhIiwidGx4IiwicmVzZXRTbGlkZXJzIiwicTEiLCJxMiIsInEzIiwidmFsaWQiLCJxdWFsaXRhdGl2ZSJdLCJzb3VyY2VSb290IjoiIn0=