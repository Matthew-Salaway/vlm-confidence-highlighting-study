(()=>{"use strict";let t="https://matthewsalaway.pythonanywhere.com/";async function e(e){e.url_data=globalThis.url_data,console.log("Data"),"study_id"in e.url_data||(e.url_data.study_id="demo_study"),"prolific_id"in e.url_data||(e.url_data.prolific_id="demo_user"),"session_id"in e.url_data||(e.url_data.session_id="demo_session"),e.url_data.queue_id=globalThis.uid,console.log("logged",e),console.log("Logging to",t+"log");try{let n=await $.ajax(t+"log",{data:JSON.stringify({project:"ocr-calibration-study/"+e.url_data.study_id,uid:globalThis.uid+"_"+e.url_data.prolific_id,payload:JSON.stringify(e)}),type:"POST",contentType:"application/json"});return await async function(){return new Promise((t=>setTimeout(t,2e3)))}(),n}catch(t){console.log(t)}}function n(t){let e=t.replace(/\s+/g,"");return e=e.replace(/\\/g," \\"),e=e.replace(/([\+\-\=])/g," $1 "),e=e.replace(/\s+/g," "),e}var i=!1,o=[];let a=null,r=-1,s=0,l=0,c=20,d=0,u=0,_=0,p=0;function h(){const t=$("input[name='latexExperience']:checked").val(),e=$("input[name='latexFrequency']:checked").val(),n=$("input[name='chatbotFrequency']:checked").val();return t&&e&&n?($("#button_instructions_next").show(),!0):($("#button_instructions_next").hide(),!1)}function m(t){_+=t,0==_?$("#button_instructions_prev").attr("disabled","true"):$("#button_instructions_prev").removeAttr("disabled"),3!=_||h()?($("#button_instructions_next").removeAttr("disabled"),$("#button_instructions_next").show()):($("#button_instructions_next").attr("disabled","true"),$("#button_instructions_next").hide()),_>=4?($("#instructions_and_decorations").show(),$("#button_instructions_next").val("Start study")):($("#instructions_and_decorations").hide(),$("#button_instructions_next").val("Next")),5==_&&($("#instructions_and_decorations").show(),$("#main_box_instructions").hide(),$("#main_box_experiment").show(),x()),$("#main_box_instructions").children(":not(input)").each(((t,e)=>{$(e).hide()})),$(`#instructions_${_}`).show()}$("#button_instructions_next").on("click",(()=>m(1))),$("#button_instructions_prev").on("click",(()=>m(-1)));let g=[],b=0;function f(t){$("#practice_container").empty().show();const e=$('\n      <div id="practice_inner_container" style="padding: 20px; padding-top:0px; overflow-y: auto;">\n        <div id="practice_instructions"></div>\n        <div id="practice_header"></div>\n        <div id="practice_content" style="margin-top: 10px;"></div>\n        <div id="practice_nav" style="margin-top: 20px; margin-bottom: 25px;"></div>\n      </div>\n    ');$("#practice_container").append(e),$("#practice_header").html(`<h2>Practice Round (${b+1} of ${g.length})</h2>`);const i=o[d].condition,a=[];"highlighted"===i?(a.push("The text is red if the model is uncertain about it. The brighter the red, the more uncertain the model is about that specific text."),a.push("Review the transcription carefully and fix any errors by editing the input box.")):a.push("Review the transcription carefully and fix any errors by editing the input box."),a.push("When the session starts, you will have 20 seconds to modify each transcription.");const r=a.map((t=>`<li>${t}</li>`)).join("");$("#practice_instructions").html(`\n    <h3 style="font-size: 1.1em; margin-bottom: 5px;">Instructions:</h3>\n    <ul style="margin-left: 20px;">\n        ${r}\n    </ul>\n    `),$("#practice_content").html('\n      <div id="practice_question_display" style="margin-top: 10px;">\n        <img id="practice_question_image" src="" alt="Practice Question Image" style="max-width: 100%; height: 110px; object-fit: contain;margin-top: 20px;">\n        <div id="practice_predicted_text_container" style="margin-top: 20px;">\n          <div style="margin-top: 10px;">Predicted Text:</div>\n          <div id="practice_predicted_text" style="margin-top: 20px;"></div>\n        </div>\n        <div id="practice_token_input_container" style="margin-top: 20px;">\n          <input id="practice_token_input" type="text" style="width: 100%; font-size: 16px; padding: 8px;">\n        </div>\n      </div>\n    ');const s=g[b];s.image?$("#practice_question_image").attr("src","data:image/png;base64,"+s.image):$("#practice_question_image").attr("src","");let l="";s.token_info&&Array.isArray(s.token_info)&&(l=s.token_info.filter((t=>"<|im_end|>"!==t.token)).map((t=>{let e=t.token.replace(/Ġ/g," ");if("highlighted"===o[d].condition){const i=1-(t.top_5_tokens&&t.top_5_tokens[0]&&"number"==typeof t.top_5_tokens[0].probability?t.top_5_tokens[0].probability:1);return e=n(e),`<span style="background-color: rgba(255, 0, 0, ${i});">${e}</span>`}return n(e)})).join("")),$("#practice_predicted_text").html(l);let c="";if(s.token_info&&Array.isArray(s.token_info)&&(c=s.token_info.map((t=>t.token)).filter((t=>"<|im_end|>"!==t)).map((t=>t.replace(/Ġ/g," "))).join("")),$("#practice_token_input").val(n(c)),"highlighted"===i){let t="";0===b?t="The model is uncertain about the text \\boxed":1===b?t="the model shows no uncertainty":2===b&&(t="The model is uncertain about three characters"),$("#practice_predicted_text").append(`<span style="font-style: italic; margin-left: 20px; vertical-align: middle;">${t}</span>`)}$("#practice_nav").html('\n      <div>\n        <input id="practice_prev" type="button" value="Previous Example">\n        <input id="practice_next" type="button" value="Next Example" style="margin-left: 10px;">\n      </div>\n    '),$("#practice_prev").off("click").on("click",(()=>{b=(b-1+g.length)%g.length,f(t)})),$("#practice_next").off("click").on("click",(()=>{b=(b+1)%g.length,f(t)}))}function x(){if($("#main_box_experiment").show(),$("#button_next").hide(),$("#button_quit").hide(),console.log("question index, condition index",u,d),d>=o.length)return $("#main_box_experiment").hide(),void $("#qualitative_section").show();let t=o[d];if(console.log("Condition block",t),console.log(o),0===u)return void function(t){$("#main_box_experiment").hide(),$("#start_condition_page").empty().show();const e=`\n      <div style="display: flex; justify-content: space-between; align-items: center;">\n          <h2 style="margin: 0;">${"highlighted"===t?"Uncertainty Highlighted Section":"Non-Highlighted Section"}</h2>\n          <input id="start_condition_next" type="button" value="Start Section" style="margin: 0;"/>\n      </div>\n    `;$("#start_condition_page").append(e),0===$("#practice_container").length&&$("#start_condition_page").append('<div id="practice_container" style="margin-top:10px;"></div>'),new Promise(((t,e)=>{$.getJSON("practice_questions/Qwen_practice_Qs.json").done((e=>t(e))).fail(((t,n,i)=>e(i)))})).then((t=>{g=t,console.log("Practice questions loaded:",g),b=0,f((()=>{u=1,x()}))})).catch((t=>{console.error("Error loading practice questions:",t)})),$("#start_condition_next").on("click",(()=>{$("#start_condition_page").hide(),u=1,x()}))}(t.condition);if(u>t.questions.length)return void function(){$("#main_box_experiment").hide();const t=o[d].condition;$("#condition_label").text(t),$("#mental_demand").val("0"),$("#hurried_demand").val("0"),$("#performance").val("0"),$("#effort").val("0"),$("#frustration").val("0"),$("#nasa_tlx_survey").show()}(t.condition);a=t.questions[u-1],console.log("Question",u,a),a.image?$("#question_image").attr("src","data:image/png;base64,"+a.image):$("#question_image").attr("src","");let e="";a.token_info&&Array.isArray(a.token_info)&&(e=a.token_info.filter((t=>"<|im_end|>"!==t.token)).map((t=>{let e=t.token.replace(/Ġ/g," "),i=1-(t.top_5_tokens&&t.top_5_tokens[0]&&"number"==typeof t.top_5_tokens[0].probability?t.top_5_tokens[0].probability:1);return"highlighted"==o[d].condition?`<span style="background-color: rgba(255, 0, 0, ${i});">${n(e)}</span>`:n(e)})).join("")),$("#predicted_text").html(e);let i="";a.token_info&&Array.isArray(a.token_info)&&(i=a.token_info.map((t=>t.token)).filter((t=>"<|im_end|>"!==t)).map((t=>t.replace(/Ġ/g," "))).join("")),$("#token_input").val(n(i)),$("#progress").text(`Section ${d+1} of ${o.length} | Question ${u} of ${t.questions.length}`),$("#part1").show(),$("#part2").hide(),$("#token_input_container").hide(),$("#button_next_part1").hide(),clearTimeout(s),s=window.setTimeout(q,2e4),c=20,$("#timer").text(c),$("#timer").show(),l&&clearInterval(l),l=window.setInterval((()=>{c-=1,$("#timer").text(c),c<=15&&($("#token_input_container").show(),$("#button_next_part1").show()),c<=0&&(clearInterval(l),q(),$("#timer").hide())}),1e3)}const y=new URLSearchParams(window.location.search),v=y.get("start"),w=y.get("uid");if(globalThis.url_data=function(t){const e={};for(const[n,i]of t)e[n]=i;return e}(y.entries()),null==globalThis.url_data.study_id&&(globalThis.url_data.study_id="demo_study"),null==globalThis.url_data.prolific_id&&(globalThis.url_data.prolific_id="demo_user"),null==globalThis.url_data.session_id&&(globalThis.url_data.session_id="demo_session"),null!=w){if(globalThis.uid=w,"prolific_random"==globalThis.uid){let t=`${Math.floor(10*Math.random())}`.padStart(3,"0");globalThis.uid=`${y.get("prolific_queue_name")}/${t}`}}else{let t=null;for(;null==t;)t=prompt("Enter your user id. Please get in touch if you were not assigned an id but wish to participate in this experiment.");globalThis.uid=t}globalThis.url_data.session_id.startsWith("demo")&&(i=!0),console.log("Running with UID",globalThis.uid),async function(){return await $.getJSON(`baked_queues/${globalThis.uid}.json?t=${Date.now()}`)}().catch((t=>{console.log("Invalid user id."),console.log(globalThis.uid),window.location.reload()})).then((t=>{o=t,null!=v&&(u=parseInt(v)-1,console.log("Starting from",u)),m(0),$("#main_box_instructions").show(),$("#instructions_and_decorations").hide()})),console.log("Starting session with UID:",globalThis.uid);let k=!1;function q(){clearInterval(l),$("#timer").hide(),$("#part1").hide(),$("#part2").show()}document.onvisibilitychange=()=>{k||(p+=1,k=!0,k=!1)},$(document).ready((()=>{$("#button_next_part1").on("click",(()=>{clearTimeout(s),$("#timer").hide(),$("#part1").hide(),$("#part2").show()})),$(".confidence-button").on("click",(function(){let t=parseInt($(this).attr("data-rating"));$(".confidence-button").removeClass("selected"),$(this).addClass("selected"),r=t,$("#button_next_part2").removeAttr("disabled")})),$("#button_next_part2").on("click",(()=>{e({question_i:u,condition_i:d,confidence_rating:r}),$("#button_next_part2").attr("disabled","true"),$(".confidence-button").removeClass("selected"),r=-1,$("#part2").hide(),$("#part1").show(),u++,x()})),$("input[name='latexExperience'], input[name='latexFrequency'], input[name='chatbotFrequency']").on("change",(()=>{h()&&($("#button_instructions_next").removeAttr("disabled"),$("#button_instructions_next").show())})),$("#token_input").on("input",(function(){let t=$(this).val();console.log("User input:",t)}));const t={mental_demand:!1,hurried_demand:!1,performance:!1,effort:!1,frustration:!1},n={mental_demand:null,hurried_demand:null,performance:null,effort:null,frustration:null};function i(){return Object.values(t).every((t=>!0===t))}const o=$("#nasa_tlx_next");o.prop("disabled",!0),$(".tlx-box").on("click",(function(){const e=$(this).parent().attr("id");if(!e||!(e in t))return;const a=parseInt($(this).attr("data-value"));n[e]=a,t[e]=!0,$(this).siblings().removeClass("selected"),$(this).addClass("selected"),i()&&o.prop("disabled",!1)})),o.on("click",(()=>{if(!i())return void alert("Please adjust all sliders before continuing.");const a={mental_demand:null!==n.mental_demand?n.mental_demand:0,hurried_demand:null!==n.hurried_demand?n.hurried_demand:0,performance:null!==n.performance?n.performance:0,effort:null!==n.effort?n.effort:0,frustration:null!==n.frustration?n.frustration:0};e({condition:$("#condition_label").text(),tlx:a}),function(){for(let e in t)t[e]=!1;for(let t in n)n[t]=null;$(".tlx-box").removeClass("selected"),o.prop("disabled",!0)}(),$("#nasa_tlx_survey").hide(),d++,u=0,x()}))})),$("#qual_next").on("click",(()=>{const t=$("#qual_q1").val()||"",n=$("#qual_q2").val()||"",o=$("#qual_q3").val()||"";let a=!0;t.length<25?($("#warn_q1").show(),a=!1):$("#warn_q1").hide(),n.length<25?($("#warn_q2").show(),a=!1):$("#warn_q2").hide(),o.length<0?($("#warn_q3").show(),a=!1):$("#warn_q3").hide(),a&&(e({qualitative:{q1:t,q2:n,q3:o}}),$("#qualitative_section").hide(),i?($("#reward_box_mock").text("Your total reward is $3.00."),$("#reward_box_mock").show(),$("#main_box_end_mock").show()):($("#reward_box").text("Your total reward is $3.00."),$("#reward_box").show(),$("#main_box_end").show()))}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUdsRyxPQUFTLElBQ1pwRCxFQUFFLFlBQVlnQyxPQUNkeUgsR0FBUSxHQUVSekosRUFBRSxZQUFZaUMsT0FHZHNILEVBQUduRyxPQUFTLElBQ1pwRCxFQUFFLFlBQVlnQyxPQUNkeUgsR0FBUSxHQUVSekosRUFBRSxZQUFZaUMsT0FHZHVILEVBQUdwRyxPQUFTLEdBQ1pwRCxFQUFFLFlBQVlnQyxPQUNkeUgsR0FBUSxHQUVSekosRUFBRSxZQUFZaUMsT0FJYndILElBYUxqSyxFQVJrQixDQUNka0ssWUFBYSxDQUNUSixHQUFJQSxFQUNKQyxHQUFJQSxFQUNKQyxHQUFJQSxLQU9aeEosRUFBRSx3QkFBd0JpQyxPQUN0QmhCLEdBQ0FqQixFQUFFLG9CQUFvQndGLEtBQUssK0JBQzNCeEYsRUFBRSxvQkFBb0JnQyxPQUN0QmhDLEVBQUUsc0JBQXNCZ0MsU0FFeEJoQyxFQUFFLGVBQWV3RixLQUFLLCtCQUN0QnhGLEVBQUUsZUFBZWdDLE9BQ2pCaEMsRUFBRSxpQkFBaUJnQyxRIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vc3JjL2Nvbm5lY3Rvci50cyIsIndlYnBhY2s6Ly8vLi9zcmMvdXRpbHMudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL21haW4udHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgREVWTU9ERSB9IGZyb20gJy4vZ2xvYmFscydcclxuaW1wb3J0IHsgTU9DS01PREUgfSBmcm9tICcuL21haW4nXHJcblxyXG5sZXQgU0VSVkVSX0xPR19ST09UID0gREVWTU9ERSA/IFwiaHR0cDovLzEyNy4wLjAuMTo1MDAwL1wiIDogXCJodHRwczovL21hdHRoZXdzYWxhd2F5LnB5dGhvbmFueXdoZXJlLmNvbS9cIlxyXG5cclxuYXN5bmMgZnVuY3Rpb24gc2xlZXAobXM6IG51bWJlcik6IFByb21pc2U8dm9pZD4ge1xyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIG1zKSk7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBsb2FkX2RhdGEoKTogUHJvbWlzZTxhbnk+IHtcclxuICAgIC8vIGluY2x1ZGUgdGltZXN0YW1wIHNvIHRoYXQgdGhpbmdzIGRvbid0IGdldCBjYWNoZWRcclxuICAgIGxldCByZXN1bHQgPSBhd2FpdCAkLmdldEpTT04oXHJcbiAgICAgICAgYGJha2VkX3F1ZXVlcy8ke2dsb2JhbFRoaXMudWlkfS5qc29uP3Q9JHtEYXRlLm5vdygpfWAsXHJcbiAgICApXHJcbiAgICByZXR1cm4gcmVzdWx0XHJcbn1cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGxvZ19kYXRhKGRhdGEpOiBQcm9taXNlPGFueT4ge1xyXG4gICAgLy9pZiAoTU9DS01PREUpIHtcclxuICAgIC8vICAgIGNvbnNvbGUubG9nKFwibG9nZ2VkIChtb2NrKVwiLCBkYXRhKVxyXG4gICAgLy8gICAgcmV0dXJuXHJcbiAgICAvL31cclxuICAgIFxyXG4gICAgZGF0YVtcInVybF9kYXRhXCJdID0gZ2xvYmFsVGhpcy51cmxfZGF0YVxyXG4gICAgY29uc29sZS5sb2coXCJEYXRhXCIpXHJcbiAgICBpZiAoIShcInN0dWR5X2lkXCIgaW4gZGF0YVsndXJsX2RhdGEnXSkpIHtcclxuICAgICAgICBkYXRhWyd1cmxfZGF0YSddW1wic3R1ZHlfaWRcIl0gPSBcImRlbW9fc3R1ZHlcIlxyXG4gICAgfVxyXG4gICAgaWYgKCEoXCJwcm9saWZpY19pZFwiIGluIGRhdGFbJ3VybF9kYXRhJ10pKSB7XHJcbiAgICAgICAgZGF0YVsndXJsX2RhdGEnXVtcInByb2xpZmljX2lkXCJdID0gXCJkZW1vX3VzZXJcIlxyXG4gICAgfVxyXG4gICAgaWYgKCEoXCJzZXNzaW9uX2lkXCIgaW4gZGF0YVsndXJsX2RhdGEnXSkpIHtcclxuICAgICAgICBkYXRhWyd1cmxfZGF0YSddW1wic2Vzc2lvbl9pZFwiXSA9IFwiZGVtb19zZXNzaW9uXCJcclxuICAgIH1cclxuICAgIGRhdGFbXCJ1cmxfZGF0YVwiXVtcInF1ZXVlX2lkXCJdID0gZ2xvYmFsVGhpcy51aWRcclxuICAgIGNvbnNvbGUubG9nKFwibG9nZ2VkXCIsIGRhdGEpXHJcbiAgICBjb25zb2xlLmxvZyhcIkxvZ2dpbmcgdG9cIiwgU0VSVkVSX0xPR19ST09UICsgXCJsb2dcIilcclxuXHJcbiAgICB0cnkge1xyXG4gICAgICAgIGxldCByZXN1bHQgPSBhd2FpdCAkLmFqYXgoXHJcbiAgICAgICAgICAgIFNFUlZFUl9MT0dfUk9PVCArIFwibG9nXCIsXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGRhdGE6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICAgICAgICAgICAgICBwcm9qZWN0OiBcIm9jci1jYWxpYnJhdGlvbi1zdHVkeS9cIitkYXRhWyd1cmxfZGF0YSddWydzdHVkeV9pZCddLFxyXG4gICAgICAgICAgICAgICAgICAgIHVpZDogZ2xvYmFsVGhpcy51aWQrXCJfXCIrZGF0YVsndXJsX2RhdGEnXVsncHJvbGlmaWNfaWQnXSxcclxuICAgICAgICAgICAgICAgICAgICBwYXlsb2FkOiBKU09OLnN0cmluZ2lmeShkYXRhKSxcclxuICAgICAgICAgICAgICAgIH0pLFxyXG4gICAgICAgICAgICAgICAgdHlwZTogJ1BPU1QnLFxyXG4gICAgICAgICAgICAgICAgY29udGVudFR5cGU6ICdhcHBsaWNhdGlvbi9qc29uJyxcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIClcclxuICAgICAgICBhd2FpdCBzbGVlcCgyMDAwKTtcclxuICAgICAgICByZXR1cm4gcmVzdWx0XHJcbiAgICB9IGNhdGNoIChlKSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coZSlcclxuICAgIH1cclxufSIsImZ1bmN0aW9uIHBhcmFtc1RvT2JqZWN0KGVudHJpZXMpIHtcclxuICBjb25zdCByZXN1bHQgPSB7fVxyXG4gIC8vIGVhY2ggJ2VudHJ5JyBpcyBhIFtrZXksIHZhbHVlXSB0dXBwbGVcclxuICBmb3IgKGNvbnN0IFtrZXksIHZhbHVlXSBvZiBlbnRyaWVzKSB7XHJcbiAgICByZXN1bHRba2V5XSA9IHZhbHVlO1xyXG4gIH1cclxuICByZXR1cm4gcmVzdWx0O1xyXG59XHJcbi8vIEluIHNyYy91dGlscy50cyBvciBhdCB0aGUgdG9wIG9mIHNyYy9tYWluLnRzXHJcbmZ1bmN0aW9uIGZpeFNwYWNpbmcoaW5wdXQ6IHN0cmluZyk6IHN0cmluZyB7XHJcbiAgLy8gUmVtb3ZlIGFsbCBzcGFjZXMuXHJcbiAgbGV0IG91dHB1dCA9IGlucHV0LnJlcGxhY2UoL1xccysvZywgXCJcIik7XHJcbiAgLy8gQWRkIGEgc3BhY2UgYmVmb3JlIGV2ZXJ5IGJhY2tzbGFzaC5cclxuICBvdXRwdXQgPSBvdXRwdXQucmVwbGFjZSgvXFxcXC9nLCBcIiBcXFxcXCIpO1xyXG4gIC8vIEFkZCBhIHNwYWNlIGJlZm9yZSBhbmQgYWZ0ZXIgZXZlcnkgcGx1cywgbWludXMsIGFuZCBlcXVhbCBzaWduLlxyXG4gIG91dHB1dCA9IG91dHB1dC5yZXBsYWNlKC8oW1xcK1xcLVxcPV0pL2csIFwiICQxIFwiKTtcclxuICAvLyBDb2xsYXBzZSBtdWx0aXBsZSBzcGFjZXMgaW50byBvbmUuXHJcbiAgb3V0cHV0ID0gb3V0cHV0LnJlcGxhY2UoL1xccysvZywgXCIgXCIpO1xyXG4gIHJldHVybiBvdXRwdXQ7XHJcbn1cclxuXHJcblxyXG5cclxuZXhwb3J0IHsgcGFyYW1zVG9PYmplY3QsIGZpeFNwYWNpbmcgfSIsImltcG9ydCB7IERFVk1PREUgfSBmcm9tIFwiLi9nbG9iYWxzXCJcclxuZXhwb3J0IHZhciBVSUQ6IHN0cmluZ1xyXG5leHBvcnQgdmFyIE1PQ0tNT0RFOiBib29sZWFuID0gZmFsc2VcclxuaW1wb3J0IHsgbG9hZF9kYXRhLCBsb2dfZGF0YSB9IGZyb20gJy4vY29ubmVjdG9yJ1xyXG5pbXBvcnQgeyBwYXJhbXNUb09iamVjdCwgZml4U3BhY2luZyB9IGZyb20gXCIuL3V0aWxzXCJcclxuXHJcbnZhciBkYXRhOiBhbnlbXSA9IFtdXHJcbmxldCBxdWVzdGlvbjogYW55ID0gbnVsbFxyXG5sZXQgdXNlcnNlbGVjdGlvbl9hbnN3ZXJvbmx5OiBudW1iZXIgPSAtMVxyXG5sZXQgdXNlcnNlbGVjdGlvbl93aXRoZXhwbGFuYXRpb246IG51bWJlciA9IC0xXHJcbmxldCB1c2Vyc2VsZWN0aW9uX3dpdGhleHBsYW5hdGlvbnF1YWxpdHk6IG51bWJlciA9IC0xXHJcbmxldCBjb25maWRlbmNlUmF0aW5nOiBudW1iZXIgPSAtMTtcclxubGV0IHBhcnQxVGltZXI6IG51bWJlciA9IDA7XHJcbmxldCBwYXJ0MUludGVydmFsOiBudW1iZXIgPSAwO1xyXG5sZXQgcmVtYWluaW5nVGltZTogbnVtYmVyID0gMjA7XHJcbmxldCBjdXJyZW50Q29uZGl0aW9uSW5kZXggPSAwO1xyXG5sZXQgY3VycmVudFF1ZXN0aW9uSW5kZXggPSAwO1xyXG5cclxuXHJcblxyXG5cclxubGV0IGJhbGFuY2UgPSAwXHJcbmxldCBiYWxhbmNlX2luY3JlbWVudCA9IDAuMSAgICAgLy8gQmFsYW5jZSB1cGRhdGVzIGJ5ICQwLjEwIGZvciBldmVyeSBjb3JyZWN0IHNlbGVjdGlvblxyXG5cclxubGV0IGluc3RydWN0aW9uX2k6IG51bWJlciA9IDBcclxubGV0IGNvdW50X2V4aXRlZF9wYWdlOiBudW1iZXIgPSAwXHJcblxyXG5mdW5jdGlvbiBhc3NlcnQoY29uZGl0aW9uLCBtZXNzYWdlKSB7XHJcbiAgICBpZiAoIWNvbmRpdGlvbikge1xyXG4gICAgICAgIHRocm93IG1lc3NhZ2UgfHwgXCJBc3NlcnRpb24gZmFpbGVkXCI7XHJcbiAgICB9XHJcbn1cclxuXHJcblxyXG5mdW5jdGlvbiBjaGVja1ByZVN1cnZleSgpOiBib29sZWFuIHtcclxuICAgIGNvbnN0IGxhdGV4RXhwID0gJChcImlucHV0W25hbWU9J2xhdGV4RXhwZXJpZW5jZSddOmNoZWNrZWRcIikudmFsKCk7XHJcbiAgICBjb25zdCBsYXRleEZyZXEgPSAkKFwiaW5wdXRbbmFtZT0nbGF0ZXhGcmVxdWVuY3knXTpjaGVja2VkXCIpLnZhbCgpO1xyXG4gICAgY29uc3QgY2hhdGJvdEZyZXEgPSAkKFwiaW5wdXRbbmFtZT0nY2hhdGJvdEZyZXF1ZW5jeSddOmNoZWNrZWRcIikudmFsKCk7XHJcbiAgXHJcbiAgICBpZiAobGF0ZXhFeHAgJiYgbGF0ZXhGcmVxICYmIGNoYXRib3RGcmVxKSB7XHJcbiAgICAgICQoXCIjYnV0dG9uX2luc3RydWN0aW9uc19uZXh0XCIpLnNob3coKTtcclxuICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAkKFwiI2J1dHRvbl9pbnN0cnVjdGlvbnNfbmV4dFwiKS5oaWRlKCk7XHJcbiAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxufVxyXG5cclxuXHJcbmZ1bmN0aW9uIG5leHRfaW5zdHJ1Y3Rpb25zKGluY3JlbWVudDogbnVtYmVyKSB7XHJcbiAgICBpbnN0cnVjdGlvbl9pICs9IGluY3JlbWVudFxyXG5cclxuICAgIGlmIChpbnN0cnVjdGlvbl9pID09IDApIHtcclxuICAgICAgICAkKFwiI2J1dHRvbl9pbnN0cnVjdGlvbnNfcHJldlwiKS5hdHRyKFwiZGlzYWJsZWRcIiwgXCJ0cnVlXCIpXHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgICQoXCIjYnV0dG9uX2luc3RydWN0aW9uc19wcmV2XCIpLnJlbW92ZUF0dHIoXCJkaXNhYmxlZFwiKVxyXG4gICAgfVxyXG4gICAgaWYoaW5zdHJ1Y3Rpb25faSA9PSAzICYmICFjaGVja1ByZVN1cnZleSgpKSB7XHJcbiAgICAgICAgJChcIiNidXR0b25faW5zdHJ1Y3Rpb25zX25leHRcIikuYXR0cihcImRpc2FibGVkXCIsIFwidHJ1ZVwiKVxyXG4gICAgICAgICQoXCIjYnV0dG9uX2luc3RydWN0aW9uc19uZXh0XCIpLmhpZGUoKVxyXG4gICAgfVxyXG4gICAgZWxzZXtcclxuICAgICAgICAkKFwiI2J1dHRvbl9pbnN0cnVjdGlvbnNfbmV4dFwiKS5yZW1vdmVBdHRyKFwiZGlzYWJsZWRcIilcclxuICAgICAgICAkKFwiI2J1dHRvbl9pbnN0cnVjdGlvbnNfbmV4dFwiKS5zaG93KClcclxuICAgIH1cclxuICAgIGlmIChpbnN0cnVjdGlvbl9pID49IDQpIHtcclxuICAgICAgICAkKFwiI2luc3RydWN0aW9uc19hbmRfZGVjb3JhdGlvbnNcIikuc2hvdygpXHJcbiAgICAgICAgJChcIiNidXR0b25faW5zdHJ1Y3Rpb25zX25leHRcIikudmFsKFwiU3RhcnQgc3R1ZHlcIilcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgJChcIiNpbnN0cnVjdGlvbnNfYW5kX2RlY29yYXRpb25zXCIpLmhpZGUoKVxyXG4gICAgICAgICQoXCIjYnV0dG9uX2luc3RydWN0aW9uc19uZXh0XCIpLnZhbChcIk5leHRcIilcclxuICAgIH1cclxuICAgIGlmIChpbnN0cnVjdGlvbl9pID09IDUpIHtcclxuICAgICAgICAkKFwiI2luc3RydWN0aW9uc19hbmRfZGVjb3JhdGlvbnNcIikuc2hvdygpXHJcbiAgICAgICAgJChcIiNtYWluX2JveF9pbnN0cnVjdGlvbnNcIikuaGlkZSgpXHJcbiAgICAgICAgJChcIiNtYWluX2JveF9leHBlcmltZW50XCIpLnNob3coKVxyXG4gICAgICAgIC8vIFJlc2V0IG91ciBjb25kaXRpb24gaW5kaWNlcyBiZWZvcmUgc3RhcnRpbmcgdGhlIGV4cGVyaW1lbnRcclxuXHJcbiAgICAgICAgbmV4dF9xdWVzdGlvbigpXHJcbiAgICB9XHJcblxyXG4gICAgJChcIiNtYWluX2JveF9pbnN0cnVjdGlvbnNcIikuY2hpbGRyZW4oXCI6bm90KGlucHV0KVwiKS5lYWNoKChfLCBlbCkgPT4ge1xyXG4gICAgICAgICQoZWwpLmhpZGUoKVxyXG4gICAgfSlcclxuICAgICQoYCNpbnN0cnVjdGlvbnNfJHtpbnN0cnVjdGlvbl9pfWApLnNob3coKVxyXG59XHJcbiQoXCIjYnV0dG9uX2luc3RydWN0aW9uc19uZXh0XCIpLm9uKFwiY2xpY2tcIiwgKCkgPT4gbmV4dF9pbnN0cnVjdGlvbnMoKzEpKVxyXG4kKFwiI2J1dHRvbl9pbnN0cnVjdGlvbnNfcHJldlwiKS5vbihcImNsaWNrXCIsICgpID0+IG5leHRfaW5zdHJ1Y3Rpb25zKC0xKSlcclxuXHJcbmZ1bmN0aW9uIGlzX3VzZXJfY29ycmVjdChzZWxlY3Rpb24pIHtcclxuICAgIGlmIChzZWxlY3Rpb24gIT0gMikge1xyXG4gICAgICAgIGxldCBjb3JyZWN0X3NlbGVjdGlvbiA9IDEgLSBxdWVzdGlvbltcInByZWRpY3Rpb25faXNfY29ycmVjdFwiXSAvLyAwIGlmIEFJIGlzIGNvcnJlY3QsIDEgaWYgaW5jb3JyZWN0XHJcbiAgICAgICAgcmV0dXJuIHNlbGVjdGlvbiA9PSBjb3JyZWN0X3NlbGVjdGlvbiA/IDEgOiAwXHJcbiAgICB9XHJcbiAgICByZXR1cm4gLTFcclxufVxyXG5cclxuZnVuY3Rpb24gdXBkYXRlX2JhbGFuY2UoKSB7XHJcbiAgICBpZiAodXNlcnNlbGVjdGlvbl93aXRoZXhwbGFuYXRpb25xdWFsaXR5ICE9IDIpIHtcclxuICAgICAgICBsZXQgY29ycmVjdF9zZWxlY3Rpb24gPSAxIC0gcXVlc3Rpb25bXCJwcmVkaWN0aW9uX2lzX2NvcnJlY3RcIl0gLy8gMCBpZiBBSSBpcyBjb3JyZWN0LCAxIGlmIGluY29ycmVjdFxyXG4gICAgICAgIGlmICh1c2Vyc2VsZWN0aW9uX3dpdGhleHBsYW5hdGlvbnF1YWxpdHkgPT0gY29ycmVjdF9zZWxlY3Rpb24pIHtcclxuICAgICAgICAgICAgYmFsYW5jZSArPSBiYWxhbmNlX2luY3JlbWVudFxyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG5cclxuLyogTmV3IGZ1bmN0aW9uOiBTaG93IHN0YXJ0LW9mLWNvbmRpdGlvbiBwYWdlICovXHJcbmZ1bmN0aW9uIHNob3dTdGFydENvbmRpdGlvblBhZ2UoY29uZGl0aW9uOiBzdHJpbmcpIHtcclxuICAgICQoXCIjbWFpbl9ib3hfZXhwZXJpbWVudFwiKS5oaWRlKCk7XHJcbiAgICAvLyBDbGVhciB0aGUgY29udGFpbmVyIG9uY2UuXHJcbiAgICAkKFwiI3N0YXJ0X2NvbmRpdGlvbl9wYWdlXCIpLmVtcHR5KCkuc2hvdygpO1xyXG5cclxuICAgIC8vIERldGVybWluZSBoZWFkZXIgdGV4dCBiYXNlZCBvbiBjb25kaXRpb24uXHJcbiAgICBjb25zdCBoZWFkZXJUZXh0ID0gKGNvbmRpdGlvbiA9PT0gXCJoaWdobGlnaHRlZFwiKSBcclxuICAgICAgICAgICAgICAgICAgICAgICAgID8gXCJVbmNlcnRhaW50eSBIaWdobGlnaHRlZCBTZWN0aW9uXCIgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICA6IFwiTm9uLUhpZ2hsaWdodGVkIFNlY3Rpb25cIjtcclxuXHJcbiAgICAvLyBDcmVhdGUgYSBmbGV4IGNvbnRhaW5lciB3aXRoIGhlYWRlciBhbmQgU3RhcnQgRXhwZXJpbWVudCBidXR0b24uXHJcbiAgICBjb25zdCBoZWFkZXJIdG1sID0gYFxyXG4gICAgICA8ZGl2IHN0eWxlPVwiZGlzcGxheTogZmxleDsganVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuOyBhbGlnbi1pdGVtczogY2VudGVyO1wiPlxyXG4gICAgICAgICAgPGgyIHN0eWxlPVwibWFyZ2luOiAwO1wiPiR7aGVhZGVyVGV4dH08L2gyPlxyXG4gICAgICAgICAgPGlucHV0IGlkPVwic3RhcnRfY29uZGl0aW9uX25leHRcIiB0eXBlPVwiYnV0dG9uXCIgdmFsdWU9XCJTdGFydCBTZWN0aW9uXCIgc3R5bGU9XCJtYXJnaW46IDA7XCIvPlxyXG4gICAgICA8L2Rpdj5cclxuICAgIGA7XHJcbiAgICAkKFwiI3N0YXJ0X2NvbmRpdGlvbl9wYWdlXCIpLmFwcGVuZChoZWFkZXJIdG1sKTtcclxuXHJcbiAgICAvLyBBcHBlbmQgYSBjb250YWluZXIgZm9yIHRoZSBwcmFjdGljZSByb3VuZCBjb250ZW50IGlmIG5vdCBhbHJlYWR5IHByZXNlbnQuXHJcbiAgICBpZiAoJChcIiNwcmFjdGljZV9jb250YWluZXJcIikubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICQoXCIjc3RhcnRfY29uZGl0aW9uX3BhZ2VcIikuYXBwZW5kKCc8ZGl2IGlkPVwicHJhY3RpY2VfY29udGFpbmVyXCIgc3R5bGU9XCJtYXJnaW4tdG9wOjEwcHg7XCI+PC9kaXY+Jyk7XHJcbiAgICB9XHJcblxyXG4gICAgbG9hZFByYWN0aWNlUXVlc3Rpb25zKCkudGhlbigoZGF0YSkgPT4ge1xyXG4gICAgICAgIHByYWN0aWNlUXVlc3Rpb25zID0gZGF0YTtcclxuICAgICAgICBjb25zb2xlLmxvZyhcIlByYWN0aWNlIHF1ZXN0aW9ucyBsb2FkZWQ6XCIsIHByYWN0aWNlUXVlc3Rpb25zKTtcclxuICAgICAgICBwcmFjdGljZUluZGV4ID0gMDsgLy8gU3RhcnQgYXQgdGhlIGZpcnN0IHByYWN0aWNlIHF1ZXN0aW9uLlxyXG4gICAgICAgIC8vIExhdW5jaCB0aGUgcHJhY3RpY2Ugcm91bmQuXHJcbiAgICAgICAgc2hvd1ByYWN0aWNlUm91bmQoKCkgPT4ge1xyXG4gICAgICAgICAgLy8gV2hlbiBwcmFjdGljZSBpcyBjb21wbGV0ZSwgcmVzdW1lIHRoZSBub3JtYWwgZXhwZXJpbWVudCBmbG93LlxyXG4gICAgICAgICAgLy8gKEF0IHRoaXMgcG9pbnQsIHlvdSBjYW4gbm93IHNhZmVseSB1cGRhdGUgZXhwZXJpbWVudCBzdGF0ZS4pXHJcbiAgICAgICAgICBjdXJyZW50UXVlc3Rpb25JbmRleCA9IDE7XHJcbiAgICAgICAgICBuZXh0X3F1ZXN0aW9uKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH0pLmNhdGNoKChlcnIpID0+IHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgbG9hZGluZyBwcmFjdGljZSBxdWVzdGlvbnM6XCIsIGVycik7XHJcbiAgICAgIH0pO1xyXG4gICAgXHJcblxyXG4gICAgJChcIiNzdGFydF9jb25kaXRpb25fbmV4dFwiKS5vbihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgICAkKFwiI3N0YXJ0X2NvbmRpdGlvbl9wYWdlXCIpLmhpZGUoKTtcclxuICAgICAgICAvLyBBZnRlciBzdGFydCBwYWdlLCBiZWdpbiB3aXRoIGZpcnN0IHF1ZXN0aW9uIChzZXQgaW5kZXggdG8gMSlcclxuICAgICAgICBjdXJyZW50UXVlc3Rpb25JbmRleCA9IDE7XHJcbiAgICAgICAgbmV4dF9xdWVzdGlvbigpO1xyXG4gICAgfSk7XHJcbn1cclxubGV0IHByYWN0aWNlUXVlc3Rpb25zOiBhbnlbXSA9IFtdO1xyXG5sZXQgcHJhY3RpY2VJbmRleDogbnVtYmVyID0gMDtcclxuXHJcbi8vIEZ1bmN0aW9uIHRvIGxvYWQgcHJhY3RpY2UgcXVlc3Rpb25zIChhc3N1bWVzIGEgSlNPTiBmaWxlIHdpdGggYW4gYXJyYXkgb2YgZXhhbXBsZSBxdWVzdGlvbnMpXHJcbmZ1bmN0aW9uIGxvYWRQcmFjdGljZVF1ZXN0aW9ucygpOiBQcm9taXNlPGFueVtdPiB7XHJcbiAgcmV0dXJuIG5ldyBQcm9taXNlPGFueVtdPigocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcbiAgICAkLmdldEpTT04oXCJwcmFjdGljZV9xdWVzdGlvbnMvUXdlbl9wcmFjdGljZV9Rcy5qc29uXCIpXHJcbiAgICAgIC5kb25lKGRhdGEgPT4gcmVzb2x2ZShkYXRhKSlcclxuICAgICAgLmZhaWwoKGpxeGhyLCB0ZXh0U3RhdHVzLCBlcnJvcikgPT4gcmVqZWN0KGVycm9yKSk7XHJcbiAgfSk7XHJcbn1cclxuZnVuY3Rpb24gc2hvd1ByYWN0aWNlUm91bmQob25Db21wbGV0ZTogKCkgPT4gdm9pZCkge1xyXG4gICAgLy8gSW5zdGVhZCBvZiBlbXB0eWluZyB0aGUgZW50aXJlIHBhZ2UsIHVwZGF0ZSBvbmx5IHRoZSBwcmFjdGljZSBjb250YWluZXIuXHJcbiAgICAkKFwiI3ByYWN0aWNlX2NvbnRhaW5lclwiKS5lbXB0eSgpLnNob3coKTtcclxuICBcclxuICAgIC8vIEJ1aWxkIHRoZSBwcmFjdGljZSByb3VuZCBjb250ZW50IGluc2lkZSBhIGZpeGVkIGNvbnRhaW5lci5cclxuICAgIGNvbnN0IHByYWN0aWNlQ29udGVudCA9ICQoYFxyXG4gICAgICA8ZGl2IGlkPVwicHJhY3RpY2VfaW5uZXJfY29udGFpbmVyXCIgc3R5bGU9XCJwYWRkaW5nOiAyMHB4OyBwYWRkaW5nLXRvcDowcHg7IG92ZXJmbG93LXk6IGF1dG87XCI+XHJcbiAgICAgICAgPGRpdiBpZD1cInByYWN0aWNlX2luc3RydWN0aW9uc1wiPjwvZGl2PlxyXG4gICAgICAgIDxkaXYgaWQ9XCJwcmFjdGljZV9oZWFkZXJcIj48L2Rpdj5cclxuICAgICAgICA8ZGl2IGlkPVwicHJhY3RpY2VfY29udGVudFwiIHN0eWxlPVwibWFyZ2luLXRvcDogMTBweDtcIj48L2Rpdj5cclxuICAgICAgICA8ZGl2IGlkPVwicHJhY3RpY2VfbmF2XCIgc3R5bGU9XCJtYXJnaW4tdG9wOiAyMHB4OyBtYXJnaW4tYm90dG9tOiAyNXB4O1wiPjwvZGl2PlxyXG4gICAgICA8L2Rpdj5cclxuICAgIGApO1xyXG4gICAgJChcIiNwcmFjdGljZV9jb250YWluZXJcIikuYXBwZW5kKHByYWN0aWNlQ29udGVudCk7XHJcbiAgXHJcbiAgICAvLyBTZXQgaGVhZGVyIGZvciB0aGUgcHJhY3RpY2Ugcm91bmQuXHJcbiAgICAkKFwiI3ByYWN0aWNlX2hlYWRlclwiKS5odG1sKGA8aDI+UHJhY3RpY2UgUm91bmQgKCR7cHJhY3RpY2VJbmRleCArIDF9IG9mICR7cHJhY3RpY2VRdWVzdGlvbnMubGVuZ3RofSk8L2gyPmApO1xyXG4gIFxyXG4gICAgY29uc3QgY29uZGl0aW9uID0gZGF0YVtjdXJyZW50Q29uZGl0aW9uSW5kZXhdLmNvbmRpdGlvbjtcclxuICAgIGNvbnN0IGJ1bGxldFBvaW50czogc3RyaW5nW10gPSBbXTtcclxuXHJcbiAgICBpZiAoY29uZGl0aW9uID09PSBcImhpZ2hsaWdodGVkXCIpIHtcclxuICAgIGJ1bGxldFBvaW50cy5wdXNoKFwiVGhlIHRleHQgaXMgcmVkIGlmIHRoZSBtb2RlbCBpcyB1bmNlcnRhaW4gYWJvdXQgaXQuIFRoZSBicmlnaHRlciB0aGUgcmVkLCB0aGUgbW9yZSB1bmNlcnRhaW4gdGhlIG1vZGVsIGlzIGFib3V0IHRoYXQgc3BlY2lmaWMgdGV4dC5cIik7XHJcbiAgICBidWxsZXRQb2ludHMucHVzaChcIlJldmlldyB0aGUgdHJhbnNjcmlwdGlvbiBjYXJlZnVsbHkgYW5kIGZpeCBhbnkgZXJyb3JzIGJ5IGVkaXRpbmcgdGhlIGlucHV0IGJveC5cIik7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgYnVsbGV0UG9pbnRzLnB1c2goXCJSZXZpZXcgdGhlIHRyYW5zY3JpcHRpb24gY2FyZWZ1bGx5IGFuZCBmaXggYW55IGVycm9ycyBieSBlZGl0aW5nIHRoZSBpbnB1dCBib3guXCIpO1xyXG4gICAgfVxyXG4gICAgYnVsbGV0UG9pbnRzLnB1c2goXCJXaGVuIHRoZSBzZXNzaW9uIHN0YXJ0cywgeW91IHdpbGwgaGF2ZSAyMCBzZWNvbmRzIHRvIG1vZGlmeSBlYWNoIHRyYW5zY3JpcHRpb24uXCIpO1xyXG5cclxuICAgIC8vIEJ1aWxkIEhUTUwgZm9yIHRoZSBidWxsZXQgbGlzdCBkeW5hbWljYWxseVxyXG4gICAgY29uc3QgYnVsbGV0SHRtbCA9IGJ1bGxldFBvaW50cy5tYXAocG9pbnQgPT4gYDxsaT4ke3BvaW50fTwvbGk+YCkuam9pbihcIlwiKTtcclxuXHJcbiAgICAvLyBJbnNlcnQgdGhlIGluc3RydWN0aW9ucyBpbiB0aGUgcHJhY3RpY2Ugcm91bmQgVUlcclxuICAgICQoXCIjcHJhY3RpY2VfaW5zdHJ1Y3Rpb25zXCIpLmh0bWwoYFxyXG4gICAgPGgzIHN0eWxlPVwiZm9udC1zaXplOiAxLjFlbTsgbWFyZ2luLWJvdHRvbTogNXB4O1wiPkluc3RydWN0aW9uczo8L2gzPlxyXG4gICAgPHVsIHN0eWxlPVwibWFyZ2luLWxlZnQ6IDIwcHg7XCI+XHJcbiAgICAgICAgJHtidWxsZXRIdG1sfVxyXG4gICAgPC91bD5cclxuICAgIGApO1xyXG5cclxuICAgIC8vIEJ1aWxkIGNvbnRlbnQ6IGltYWdlLCBwcmVkaWN0ZWQgdGV4dCwgYW5kIGlucHV0LlxyXG4gICAgY29uc3QgY29udGVudEh0bWwgPSBgXHJcbiAgICAgIDxkaXYgaWQ9XCJwcmFjdGljZV9xdWVzdGlvbl9kaXNwbGF5XCIgc3R5bGU9XCJtYXJnaW4tdG9wOiAxMHB4O1wiPlxyXG4gICAgICAgIDxpbWcgaWQ9XCJwcmFjdGljZV9xdWVzdGlvbl9pbWFnZVwiIHNyYz1cIlwiIGFsdD1cIlByYWN0aWNlIFF1ZXN0aW9uIEltYWdlXCIgc3R5bGU9XCJtYXgtd2lkdGg6IDEwMCU7IGhlaWdodDogMTEwcHg7IG9iamVjdC1maXQ6IGNvbnRhaW47bWFyZ2luLXRvcDogMjBweDtcIj5cclxuICAgICAgICA8ZGl2IGlkPVwicHJhY3RpY2VfcHJlZGljdGVkX3RleHRfY29udGFpbmVyXCIgc3R5bGU9XCJtYXJnaW4tdG9wOiAyMHB4O1wiPlxyXG4gICAgICAgICAgPGRpdiBzdHlsZT1cIm1hcmdpbi10b3A6IDEwcHg7XCI+UHJlZGljdGVkIFRleHQ6PC9kaXY+XHJcbiAgICAgICAgICA8ZGl2IGlkPVwicHJhY3RpY2VfcHJlZGljdGVkX3RleHRcIiBzdHlsZT1cIm1hcmdpbi10b3A6IDIwcHg7XCI+PC9kaXY+XHJcbiAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgPGRpdiBpZD1cInByYWN0aWNlX3Rva2VuX2lucHV0X2NvbnRhaW5lclwiIHN0eWxlPVwibWFyZ2luLXRvcDogMjBweDtcIj5cclxuICAgICAgICAgIDxpbnB1dCBpZD1cInByYWN0aWNlX3Rva2VuX2lucHV0XCIgdHlwZT1cInRleHRcIiBzdHlsZT1cIndpZHRoOiAxMDAlOyBmb250LXNpemU6IDE2cHg7IHBhZGRpbmc6IDhweDtcIj5cclxuICAgICAgICA8L2Rpdj5cclxuICAgICAgPC9kaXY+XHJcbiAgICBgO1xyXG4gICAgJChcIiNwcmFjdGljZV9jb250ZW50XCIpLmh0bWwoY29udGVudEh0bWwpO1xyXG4gIFxyXG4gICAgLy8gR2V0IHRoZSBjdXJyZW50IHByYWN0aWNlIHF1ZXN0aW9uLlxyXG4gICAgY29uc3QgcXVlc3Rpb24gPSBwcmFjdGljZVF1ZXN0aW9uc1twcmFjdGljZUluZGV4XTtcclxuICBcclxuICAgIC8vIFNldCB0aGUgcXVlc3Rpb24gaW1hZ2UuXHJcbiAgICBpZiAocXVlc3Rpb25bXCJpbWFnZVwiXSkge1xyXG4gICAgICAkKFwiI3ByYWN0aWNlX3F1ZXN0aW9uX2ltYWdlXCIpLmF0dHIoXCJzcmNcIiwgXCJkYXRhOmltYWdlL3BuZztiYXNlNjQsXCIgKyBxdWVzdGlvbltcImltYWdlXCJdKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICQoXCIjcHJhY3RpY2VfcXVlc3Rpb25faW1hZ2VcIikuYXR0cihcInNyY1wiLCBcIlwiKTtcclxuICAgIH1cclxuICBcclxuICAgIC8vIFJlbmRlciBwcmVkaWN0ZWQgdGV4dCB1c2luZyB0b2tlbl9pbmZvLlxyXG4gICAgbGV0IHByZWRpY3RlZEh0bWwgPSBcIlwiO1xyXG4gICAgaWYgKHF1ZXN0aW9uW1widG9rZW5faW5mb1wiXSAmJiBBcnJheS5pc0FycmF5KHF1ZXN0aW9uW1widG9rZW5faW5mb1wiXSkpIHtcclxuICAgICAgICBwcmVkaWN0ZWRIdG1sID0gcXVlc3Rpb25bXCJ0b2tlbl9pbmZvXCJdXHJcbiAgICAgICAgLmZpbHRlcihpdGVtID0+IGl0ZW0udG9rZW4gIT09IFwiPHxpbV9lbmR8PlwiKVxyXG4gICAgICAgIC5tYXAoaXRlbSA9PiB7XHJcbiAgICAgICAgICAvLyBSZXBsYWNlIHRoZSBzcGVjaWFsIFwixKBcIiB3aXRoIGEgc3BhY2VcclxuICAgICAgICAgIGxldCB0b2tlblRleHQgPSBpdGVtLnRva2VuLnJlcGxhY2UoL8SgL2csIFwiIFwiKTtcclxuICAgICAgICAgIGlmIChkYXRhW2N1cnJlbnRDb25kaXRpb25JbmRleF0uY29uZGl0aW9uID09PSBcImhpZ2hsaWdodGVkXCIpIHtcclxuICAgICAgICAgICAgY29uc3QgcHJvYiA9IChpdGVtLnRvcF81X3Rva2VucyAmJlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW0udG9wXzVfdG9rZW5zWzBdICYmXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZW9mIGl0ZW0udG9wXzVfdG9rZW5zWzBdLnByb2JhYmlsaXR5ID09PSBcIm51bWJlclwiKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgID8gaXRlbS50b3BfNV90b2tlbnNbMF0ucHJvYmFiaWxpdHlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICA6IDE7XHJcbiAgICAgICAgICAgIGNvbnN0IGludGVuc2l0eSA9IDEgLSBwcm9iO1xyXG4gICAgICAgICAgICAvLyBBcHBseSBmaXhTcGFjaW5nIHRvIHRva2VuVGV4dCBCRUZPUkUgd3JhcHBpbmcgaW4gYSBzcGFuLlxyXG4gICAgICAgICAgICB0b2tlblRleHQgPSBmaXhTcGFjaW5nKHRva2VuVGV4dCk7XHJcbiAgICAgICAgICAgIHJldHVybiBgPHNwYW4gc3R5bGU9XCJiYWNrZ3JvdW5kLWNvbG9yOiByZ2JhKDI1NSwgMCwgMCwgJHtpbnRlbnNpdHl9KTtcIj4ke3Rva2VuVGV4dH08L3NwYW4+YDtcclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIC8vIEZvciBub24taGlnaGxpZ2h0ZWQsIHlvdSBjYW4gZWl0aGVyIGZpeCB0aGUgZW50aXJlIHN0cmluZyBsYXRlciBvciBmaXggZWFjaCB0b2tlbiBoZXJlLlxyXG4gICAgICAgICAgICByZXR1cm4gZml4U3BhY2luZyh0b2tlblRleHQpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLmpvaW4oJycpOyAgICAgIFxyXG4gICAgfVxyXG4gICAgJChcIiNwcmFjdGljZV9wcmVkaWN0ZWRfdGV4dFwiKS5odG1sKHByZWRpY3RlZEh0bWwpO1xyXG4gIFxyXG4gICAgLy8gUHJlcG9wdWxhdGUgdGhlIHRleHQgaW5wdXQuXHJcbiAgICBsZXQgdG9rZW5zQ29uY2F0ZW5hdGVkID0gXCJcIjtcclxuICAgIGlmIChxdWVzdGlvbltcInRva2VuX2luZm9cIl0gJiYgQXJyYXkuaXNBcnJheShxdWVzdGlvbltcInRva2VuX2luZm9cIl0pKSB7XHJcbiAgICAgIHRva2Vuc0NvbmNhdGVuYXRlZCA9IHF1ZXN0aW9uW1widG9rZW5faW5mb1wiXVxyXG4gICAgICAgIC5tYXAoaXRlbSA9PiBpdGVtLnRva2VuKVxyXG4gICAgICAgIC5maWx0ZXIodG9rZW4gPT4gdG9rZW4gIT09IFwiPHxpbV9lbmR8PlwiKVxyXG4gICAgICAgIC5tYXAodG9rZW4gPT4gdG9rZW4ucmVwbGFjZSgvxKAvZywgXCIgXCIpKVxyXG4gICAgICAgIC5qb2luKCcnKTtcclxuICAgIH1cclxuICAgICQoXCIjcHJhY3RpY2VfdG9rZW5faW5wdXRcIikudmFsKGZpeFNwYWNpbmcodG9rZW5zQ29uY2F0ZW5hdGVkKSk7XHJcbiAgXHJcbiAgICAvLyBBZnRlciBzZXR0aW5nIHRoZSBwcmVkaWN0ZWQgdGV4dCBpbiAjcHJhY3RpY2VfcHJlZGljdGVkX3RleHQsIGFkZDpcclxuICAgIGlmIChjb25kaXRpb24gPT09IFwiaGlnaGxpZ2h0ZWRcIil7XHJcbiAgICAgICAgbGV0IGFkZGl0aW9uYWxUZXh0ID0gXCJcIjtcclxuICAgICAgICBpZiAocHJhY3RpY2VJbmRleCA9PT0gMCkge1xyXG4gICAgICAgIGFkZGl0aW9uYWxUZXh0ID0gXCJUaGUgbW9kZWwgaXMgdW5jZXJ0YWluIGFib3V0IHRoZSB0ZXh0IFxcXFxib3hlZFwiO1xyXG4gICAgICAgIH0gZWxzZSBpZiAocHJhY3RpY2VJbmRleCA9PT0gMSkge1xyXG4gICAgICAgIGFkZGl0aW9uYWxUZXh0ID0gXCJ0aGUgbW9kZWwgc2hvd3Mgbm8gdW5jZXJ0YWludHlcIjtcclxuICAgICAgICB9IGVsc2UgaWYgKHByYWN0aWNlSW5kZXggPT09IDIpIHtcclxuICAgICAgICBhZGRpdGlvbmFsVGV4dCA9IFwiVGhlIG1vZGVsIGlzIHVuY2VydGFpbiBhYm91dCB0aHJlZSBjaGFyYWN0ZXJzXCI7XHJcbiAgICAgICAgfVxyXG4gICAgICAgICQoXCIjcHJhY3RpY2VfcHJlZGljdGVkX3RleHRcIikuYXBwZW5kKFxyXG4gICAgICAgIGA8c3BhbiBzdHlsZT1cImZvbnQtc3R5bGU6IGl0YWxpYzsgbWFyZ2luLWxlZnQ6IDIwcHg7IHZlcnRpY2FsLWFsaWduOiBtaWRkbGU7XCI+JHthZGRpdGlvbmFsVGV4dH08L3NwYW4+YFxyXG4gICAgICAgICk7XHJcbiAgICBcclxuICAgIH1cclxuXHJcblxyXG4gICAgLy8gQnVpbGQgbmF2aWdhdGlvbiBidXR0b25zLlxyXG4gICAgY29uc3QgbmF2SHRtbCA9IGBcclxuICAgICAgPGRpdj5cclxuICAgICAgICA8aW5wdXQgaWQ9XCJwcmFjdGljZV9wcmV2XCIgdHlwZT1cImJ1dHRvblwiIHZhbHVlPVwiUHJldmlvdXMgRXhhbXBsZVwiPlxyXG4gICAgICAgIDxpbnB1dCBpZD1cInByYWN0aWNlX25leHRcIiB0eXBlPVwiYnV0dG9uXCIgdmFsdWU9XCJOZXh0IEV4YW1wbGVcIiBzdHlsZT1cIm1hcmdpbi1sZWZ0OiAxMHB4O1wiPlxyXG4gICAgICA8L2Rpdj5cclxuICAgIGA7XHJcbiAgICAkKFwiI3ByYWN0aWNlX25hdlwiKS5odG1sKG5hdkh0bWwpO1xyXG4gIFxyXG4gICAgLy8gQXR0YWNoIGJ1dHRvbiBoYW5kbGVycy5cclxuICAgICQoXCIjcHJhY3RpY2VfcHJldlwiKS5vZmYoXCJjbGlja1wiKS5vbihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgcHJhY3RpY2VJbmRleCA9IChwcmFjdGljZUluZGV4IC0gMSArIHByYWN0aWNlUXVlc3Rpb25zLmxlbmd0aCkgJSBwcmFjdGljZVF1ZXN0aW9ucy5sZW5ndGg7XHJcbiAgICAgIHNob3dQcmFjdGljZVJvdW5kKG9uQ29tcGxldGUpO1xyXG4gICAgfSk7XHJcbiAgICAkKFwiI3ByYWN0aWNlX25leHRcIikub2ZmKFwiY2xpY2tcIikub24oXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgIHByYWN0aWNlSW5kZXggPSAocHJhY3RpY2VJbmRleCArIDEpICUgcHJhY3RpY2VRdWVzdGlvbnMubGVuZ3RoO1xyXG4gICAgICBzaG93UHJhY3RpY2VSb3VuZChvbkNvbXBsZXRlKTtcclxuICAgIH0pO1xyXG4gIH1cclxuICBcclxuXHJcblxyXG4vKiBOZXcgZnVuY3Rpb246IFNob3cgZW5kLW9mLWNvbmRpdGlvbiBwYWdlICovXHJcbmZ1bmN0aW9uIHNob3dFbmRDb25kaXRpb25QYWdlKGNvbmRpdGlvbjogc3RyaW5nKSB7XHJcbiAgICAkKFwiI21haW5fYm94X2V4cGVyaW1lbnRcIikuaGlkZSgpO1xyXG4gICAgY29uc3QgY3VycmVudENvbmRpdGlvbiA9IGRhdGFbY3VycmVudENvbmRpdGlvbkluZGV4XS5jb25kaXRpb247XHJcbiAgICAkKFwiI2NvbmRpdGlvbl9sYWJlbFwiKS50ZXh0KGN1cnJlbnRDb25kaXRpb24pO1xyXG4gICAgLy8gUmVzZXQgZWFjaCBzbGlkZXIgdG8gYSBkZWZhdWx0LCBlLmcuLCAwXHJcbiAgICAkKFwiI21lbnRhbF9kZW1hbmRcIikudmFsKFwiMFwiKTtcclxuICAgICQoXCIjaHVycmllZF9kZW1hbmRcIikudmFsKFwiMFwiKTtcclxuICAgICQoXCIjcGVyZm9ybWFuY2VcIikudmFsKFwiMFwiKTtcclxuICAgICQoXCIjZWZmb3J0XCIpLnZhbChcIjBcIik7XHJcbiAgICAkKFwiI2ZydXN0cmF0aW9uXCIpLnZhbChcIjBcIik7XHJcblxyXG4gICAgJChcIiNuYXNhX3RseF9zdXJ2ZXlcIikuc2hvdygpO1xyXG4gICBcclxufVxyXG5cclxuXHJcblxyXG5mdW5jdGlvbiBuZXh0X3F1ZXN0aW9uKCkge1xyXG4gICAgLy8gcmVzdG9yZSBwcmV2aW91cyBzdGF0ZSBvZiBVSVxyXG4gICAgJChcIiNtYWluX2JveF9leHBlcmltZW50XCIpLnNob3coKTtcclxuICAgICQoXCIjYnV0dG9uX25leHRcIikuaGlkZSgpXHJcbiAgICAkKCcjYnV0dG9uX3F1aXQnKS5oaWRlKClcclxuICAgIC8vJChcIiNyYW5nZV92YWxcIikudmFsKHVzZXJfdHJ1c3QpXHJcbiAgICBjb25zb2xlLmxvZyhcInF1ZXN0aW9uIGluZGV4LCBjb25kaXRpb24gaW5kZXhcIiwgY3VycmVudFF1ZXN0aW9uSW5kZXgsIGN1cnJlbnRDb25kaXRpb25JbmRleCkgICAgICAgIFxyXG5cclxuICAgIGlmIChjdXJyZW50Q29uZGl0aW9uSW5kZXggPj0gZGF0YS5sZW5ndGgpIHtcclxuICAgICAgICAkKFwiI21haW5fYm94X2V4cGVyaW1lbnRcIikuaGlkZSgpO1xyXG4gICAgICAgICQoXCIjcXVhbGl0YXRpdmVfc2VjdGlvblwiKS5zaG93KCk7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgbGV0IGNvbmRpdGlvbkJsb2NrID0gZGF0YVtjdXJyZW50Q29uZGl0aW9uSW5kZXhdO1xyXG4gICAgY29uc29sZS5sb2coXCJDb25kaXRpb24gYmxvY2tcIiwgY29uZGl0aW9uQmxvY2spXHJcbiAgICBjb25zb2xlLmxvZyhkYXRhKVxyXG5cclxuICAgIC8vIElmIHdlIGFyZSBhdCB0aGUgc3RhcnQgcGFnZSBmb3IgdGhpcyBjb25kaXRpb24sIHNob3cgaXQuXHJcbiAgICBpZiAoY3VycmVudFF1ZXN0aW9uSW5kZXggPT09IDApIHtcclxuICAgICAgICBzaG93U3RhcnRDb25kaXRpb25QYWdlKGNvbmRpdGlvbkJsb2NrLmNvbmRpdGlvbik7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIElmIHdlJ3ZlIGdvbmUgcGFzdCBhbGwgcXVlc3Rpb25zIGluIHRoaXMgY29uZGl0aW9uLCBzaG93IHRoZSBlbmQtb2YtY29uZGl0aW9uIHBhZ2UuXHJcbiAgICBpZiAoY3VycmVudFF1ZXN0aW9uSW5kZXggPiBjb25kaXRpb25CbG9jay5xdWVzdGlvbnMubGVuZ3RoKSB7XHJcbiAgICAgICAgc2hvd0VuZENvbmRpdGlvblBhZ2UoY29uZGl0aW9uQmxvY2suY29uZGl0aW9uKTtcclxuICAgICAgICByZXR1cm47XHJcbiAgICB9XHJcblxyXG5cclxuICAgIHF1ZXN0aW9uID0gY29uZGl0aW9uQmxvY2sucXVlc3Rpb25zW2N1cnJlbnRRdWVzdGlvbkluZGV4IC0gMV07XHJcbiAgICBjb25zb2xlLmxvZyhcIlF1ZXN0aW9uXCIsIGN1cnJlbnRRdWVzdGlvbkluZGV4LCBxdWVzdGlvbilcclxuICAgIFxyXG4gICAgXHJcbiAgICAvLyAtLS0gVXBkYXRlIFBhcnQgMSBlbGVtZW50cyAtLS1cclxuICAgIC8vIEZvciB0aGUgaW1hZ2U6IGFzc3VtZSBhIHZhbGlkIEJhc2U2NCBzdHJpbmcgZm9yIG5vdy5cclxuICAgIGlmIChxdWVzdGlvbltcImltYWdlXCJdKSB7XHJcbiAgICAgICQoXCIjcXVlc3Rpb25faW1hZ2VcIikuYXR0cihcInNyY1wiLCBcImRhdGE6aW1hZ2UvcG5nO2Jhc2U2NCxcIiArIHF1ZXN0aW9uW1wiaW1hZ2VcIl0pO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgJChcIiNxdWVzdGlvbl9pbWFnZVwiKS5hdHRyKFwic3JjXCIsIFwiXCIpO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyBEaXNwbGF5IHRoZSBwcmVkaWN0ZWQgdGV4dC5cclxuICAgIC8vIEJ1aWxkIHRoZSBwcmVkaWN0ZWQgdGV4dCBIVE1MIGJ5IGNvbmNhdGVuYXRpbmcgdG9rZW5faW5mb1xyXG4gICAgbGV0IHByZWRpY3RlZEh0bWwgPSBcIlwiO1xyXG4gICAgaWYgKHF1ZXN0aW9uW1widG9rZW5faW5mb1wiXSAmJiBBcnJheS5pc0FycmF5KHF1ZXN0aW9uW1widG9rZW5faW5mb1wiXSkpIHtcclxuICAgICAgICBwcmVkaWN0ZWRIdG1sID0gcXVlc3Rpb25bXCJ0b2tlbl9pbmZvXCJdXHJcbiAgICAgICAgLmZpbHRlcihpdGVtID0+IGl0ZW0udG9rZW4gIT09IFwiPHxpbV9lbmR8PlwiKVxyXG4gICAgICAgIC5tYXAoaXRlbSA9PiB7XHJcbiAgICAgICAgbGV0IHRva2VuVGV4dCA9IGl0ZW0udG9rZW4ucmVwbGFjZSgvxKAvZywgXCIgXCIpO1xyXG4gICAgICAgIGxldCBwcm9iID0gKGl0ZW0udG9wXzVfdG9rZW5zICYmXHJcbiAgICAgICAgICAgICAgICAgICAgaXRlbS50b3BfNV90b2tlbnNbMF0gJiZcclxuICAgICAgICAgICAgICAgICAgICB0eXBlb2YgaXRlbS50b3BfNV90b2tlbnNbMF0ucHJvYmFiaWxpdHkgPT09IFwibnVtYmVyXCIpXHJcbiAgICAgICAgICAgICAgICAgICAgPyBpdGVtLnRvcF81X3Rva2Vuc1swXS5wcm9iYWJpbGl0eVxyXG4gICAgICAgICAgICAgICAgICAgIDogMTtcclxuICAgICAgICBsZXQgaW50ZW5zaXR5ID0gMSAtIHByb2I7XHJcbiAgICAgICAgaWYgKGRhdGFbY3VycmVudENvbmRpdGlvbkluZGV4XS5jb25kaXRpb24gPT0gXCJoaWdobGlnaHRlZFwiKSB7XHJcbiAgICAgICAgICAgIC8vIEFwcGx5IGZpeFNwYWNpbmcgb24gdGhlIHRva2VuIHRleHQgYmVmb3JlIHdyYXBwaW5nIGluIHNwYW4uXHJcbiAgICAgICAgICAgIHJldHVybiBgPHNwYW4gc3R5bGU9XCJiYWNrZ3JvdW5kLWNvbG9yOiByZ2JhKDI1NSwgMCwgMCwgJHtpbnRlbnNpdHl9KTtcIj4ke2ZpeFNwYWNpbmcodG9rZW5UZXh0KX08L3NwYW4+YDtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAvLyBGb3Igbm9uLWhpZ2hsaWdodGVkLCB5b3UgY2FuIGZpeCB0aGUgd2hvbGUgc3RyaW5nIGFmdGVyd2FyZHMgb3IgcGVyIHRva2VuLlxyXG4gICAgICAgICAgICByZXR1cm4gZml4U3BhY2luZyh0b2tlblRleHQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB9KVxyXG4gICAgICAgIC5qb2luKCcnKTtcclxuICAgIH1cclxuJChcIiNwcmVkaWN0ZWRfdGV4dFwiKS5odG1sKHByZWRpY3RlZEh0bWwpO1xyXG5cclxuICAgICAgXHJcbiAgICBcclxuICAgIC8vIENvbmNhdGVuYXRlIHRva2VucyAod2l0aCByZXBsYWNlbWVudCBvZiDEoCBhbmQgc2tpcHBpbmcgPHxpbV9lbmR8PikuXHJcbiAgICBsZXQgdG9rZW5zQ29uY2F0ZW5hdGVkID0gXCJcIjtcclxuICAgIGlmIChxdWVzdGlvbltcInRva2VuX2luZm9cIl0gJiYgQXJyYXkuaXNBcnJheShxdWVzdGlvbltcInRva2VuX2luZm9cIl0pKSB7XHJcbiAgICAgICAgdG9rZW5zQ29uY2F0ZW5hdGVkID0gcXVlc3Rpb25bXCJ0b2tlbl9pbmZvXCJdXHJcbiAgICAgICAgICAubWFwKGl0ZW0gPT4gaXRlbS50b2tlbilcclxuICAgICAgICAgIC5maWx0ZXIodG9rZW4gPT4gdG9rZW4gIT09IFwiPHxpbV9lbmR8PlwiKVxyXG4gICAgICAgICAgLm1hcCh0b2tlbiA9PiB0b2tlbi5yZXBsYWNlKC/EoC9nLCBcIiBcIikpXHJcbiAgICAgICAgICAuam9pbignJyk7XHJcbiAgICB9XHJcbiAgICAkKFwiI3Rva2VuX2lucHV0XCIpLnZhbChmaXhTcGFjaW5nKHRva2Vuc0NvbmNhdGVuYXRlZCkpO1xyXG4gICAgXHJcbiAgICAvLyAoVXBkYXRlIHByb2dyZXNzIGFuZCBvdGhlciBlbGVtZW50cyBhcyBuZWNlc3NhcnkpXHJcbiAgICAkKFwiI3Byb2dyZXNzXCIpLnRleHQoYFNlY3Rpb24gJHtjdXJyZW50Q29uZGl0aW9uSW5kZXggKyAxfSBvZiAke2RhdGEubGVuZ3RofSB8IFF1ZXN0aW9uICR7Y3VycmVudFF1ZXN0aW9uSW5kZXh9IG9mICR7Y29uZGl0aW9uQmxvY2sucXVlc3Rpb25zLmxlbmd0aH1gKTtcclxuICAgICAgICAvLyBBbHdheXMgc2hvdyBQYXJ0IDEgYW5kIGhpZGUgUGFydCAyIHdoZW4gYSBuZXcgcXVlc3Rpb24gbG9hZHMuXHJcbiAgICAgICAgJChcIiNwYXJ0MVwiKS5zaG93KCk7XHJcbiAgICAgICAgJChcIiNwYXJ0MlwiKS5oaWRlKCk7XHJcbiAgICBcclxuLy8gQXQgdGhlIGVuZCBvZiBuZXh0X3F1ZXN0aW9uKCksIGFmdGVyIHVwZGF0aW5nIGFsbCBQYXJ0IDEgZWxlbWVudHM6XHJcbiQoXCIjdG9rZW5faW5wdXRfY29udGFpbmVyXCIpLmhpZGUoKTtcclxuJChcIiNidXR0b25fbmV4dF9wYXJ0MVwiKS5oaWRlKCk7XHJcblxyXG4vLyBTdGFydCBhIDIwLXNlY29uZCB0aW1lciBmb3IgUGFydCAxXHJcbmNsZWFyVGltZW91dChwYXJ0MVRpbWVyKTtcclxucGFydDFUaW1lciA9IHdpbmRvdy5zZXRUaW1lb3V0KGF1dG9TdWJtaXRQYXJ0MSwgMjAwMDApO1xyXG5cclxuLy8gUmVzZXQgYW5kIHN0YXJ0IHRoZSB0aW1lciBmb3IgUGFydCAxXHJcbnJlbWFpbmluZ1RpbWUgPSAyMDtcclxuJChcIiN0aW1lclwiKS50ZXh0KHJlbWFpbmluZ1RpbWUpO1xyXG4kKFwiI3RpbWVyXCIpLnNob3coKTtcclxuXHJcbi8vIENsZWFyIGFueSBwcmV2aW91cyBpbnRlcnZhbFxyXG5pZiAocGFydDFJbnRlcnZhbCkge1xyXG4gICAgY2xlYXJJbnRlcnZhbChwYXJ0MUludGVydmFsKTtcclxufVxyXG5cclxuLy8gU3RhcnQgYSBuZXcgaW50ZXJ2YWwgdGhhdCBjb3VudHMgZG93biBldmVyeSBzZWNvbmRcclxucGFydDFJbnRlcnZhbCA9IHdpbmRvdy5zZXRJbnRlcnZhbCgoKSA9PiB7XHJcbiAgICByZW1haW5pbmdUaW1lIC09IDE7XHJcbiAgICAkKFwiI3RpbWVyXCIpLnRleHQocmVtYWluaW5nVGltZSk7XHJcblxyXG4gICAgLy8gV2hlbiB0aGVyZSBhcmUgMTUgc2Vjb25kcyBvciBsZXNzIHJlbWFpbmluZywgc2hvdyB0aGUgaW5wdXQgYm94IGFuZCBOZXh0IGJ1dHRvblxyXG4gICAgaWYgKHJlbWFpbmluZ1RpbWUgPD0gMTUpIHtcclxuICAgICAgICAkKFwiI3Rva2VuX2lucHV0X2NvbnRhaW5lclwiKS5zaG93KCk7XHJcbiAgICAgICAgJChcIiNidXR0b25fbmV4dF9wYXJ0MVwiKS5zaG93KCk7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKHJlbWFpbmluZ1RpbWUgPD0gMCkge1xyXG4gICAgICAgIGNsZWFySW50ZXJ2YWwocGFydDFJbnRlcnZhbCk7XHJcbiAgICAgICAgYXV0b1N1Ym1pdFBhcnQxKCk7XHJcbiAgICAgICAgJChcIiN0aW1lclwiKS5oaWRlKCk7XHJcbiAgICB9XHJcbn0sIDEwMDApO1xyXG5cclxuXHJcbn1cclxuXHJcbi8vIGdldCB1c2VyIGlkIGFuZCBsb2FkIHF1ZXVlXHJcbi8vIHRyeSB0byBzZWUgaWYgc3RhcnQgb3ZlcnJpZGUgd2FzIHBhc3NlZFxyXG5jb25zdCB1cmxQYXJhbXMgPSBuZXcgVVJMU2VhcmNoUGFyYW1zKHdpbmRvdy5sb2NhdGlvbi5zZWFyY2gpO1xyXG5jb25zdCBzdGFydE92ZXJyaWRlID0gdXJsUGFyYW1zLmdldCgnc3RhcnQnKTtcclxuY29uc3QgVUlERnJvbVVSTCA9IHVybFBhcmFtcy5nZXQoXCJ1aWRcIilcclxuZ2xvYmFsVGhpcy51cmxfZGF0YSA9IHBhcmFtc1RvT2JqZWN0KHVybFBhcmFtcy5lbnRyaWVzKCkpXHJcblxyXG5pZiAoZ2xvYmFsVGhpcy51cmxfZGF0YVsnc3R1ZHlfaWQnXSA9PSBudWxsKSB7XHJcbiAgICBnbG9iYWxUaGlzLnVybF9kYXRhWydzdHVkeV9pZCddID0gXCJkZW1vX3N0dWR5XCJcclxufVxyXG5pZiAoZ2xvYmFsVGhpcy51cmxfZGF0YVsncHJvbGlmaWNfaWQnXSA9PSBudWxsKSB7XHJcbiAgICBnbG9iYWxUaGlzLnVybF9kYXRhWydwcm9saWZpY19pZCddID0gXCJkZW1vX3VzZXJcIlxyXG59XHJcbmlmIChnbG9iYWxUaGlzLnVybF9kYXRhWydzZXNzaW9uX2lkJ10gPT0gbnVsbCkge1xyXG4gICAgZ2xvYmFsVGhpcy51cmxfZGF0YVsnc2Vzc2lvbl9pZCddID0gXCJkZW1vX3Nlc3Npb25cIlxyXG59XHJcblxyXG5pZiAoVUlERnJvbVVSTCAhPSBudWxsKSB7XHJcbiAgICBnbG9iYWxUaGlzLnVpZCA9IFVJREZyb21VUkwgYXMgc3RyaW5nXHJcbiAgICBpZiAoZ2xvYmFsVGhpcy51aWQgPT0gXCJwcm9saWZpY19yYW5kb21cIikge1xyXG4gICAgICAgIGxldCBxdWV1ZV9pZCA9IGAke01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwKX1gLnBhZFN0YXJ0KDMsIFwiMFwiKVxyXG4gICAgICAgIGdsb2JhbFRoaXMudWlkID0gYCR7dXJsUGFyYW1zLmdldChcInByb2xpZmljX3F1ZXVlX25hbWVcIil9LyR7cXVldWVfaWR9YFxyXG4gICAgfVxyXG59IGVsc2UgaWYgKERFVk1PREUpIHtcclxuICAgIGdsb2JhbFRoaXMudWlkID0gXCJkZW1vXCJcclxufSBlbHNlIHtcclxuICAgIGxldCBVSURfbWF5YmU6IGFueSA9IG51bGxcclxuICAgIHdoaWxlIChVSURfbWF5YmUgPT0gbnVsbCkge1xyXG4gICAgICAgIFVJRF9tYXliZSA9IHByb21wdChcIkVudGVyIHlvdXIgdXNlciBpZC4gUGxlYXNlIGdldCBpbiB0b3VjaCBpZiB5b3Ugd2VyZSBub3QgYXNzaWduZWQgYW4gaWQgYnV0IHdpc2ggdG8gcGFydGljaXBhdGUgaW4gdGhpcyBleHBlcmltZW50LlwiKVxyXG4gICAgfVxyXG4gICAgZ2xvYmFsVGhpcy51aWQgPSBVSURfbWF5YmUhXHJcbn1cclxuXHJcbi8vIHZlcnNpb24gZm9yIHBhcGVyXHJcbmlmIChERVZNT0RFKSB7XHJcbiAgICBNT0NLTU9ERSA9IHRydWVcclxufSBlbHNlIGlmIChnbG9iYWxUaGlzLnVybF9kYXRhWydzZXNzaW9uX2lkJ10uc3RhcnRzV2l0aChcImRlbW9cIikpIHtcclxuICAgIE1PQ0tNT0RFID0gdHJ1ZVxyXG59XHJcblxyXG5jb25zb2xlLmxvZyhcIlJ1bm5pbmcgd2l0aCBVSURcIiwgZ2xvYmFsVGhpcy51aWQpXHJcbmxvYWRfZGF0YSgpLmNhdGNoKChfZXJyb3IpID0+IHtcclxuICAgIC8vYWxlcnQoXCJJbnZhbGlkIHVzZXIgaWQuXCIpXHJcbiAgICBjb25zb2xlLmxvZyhcIkludmFsaWQgdXNlciBpZC5cIilcclxuICAgIGNvbnNvbGUubG9nKGdsb2JhbFRoaXMudWlkISlcclxuICAgIHdpbmRvdy5sb2NhdGlvbi5yZWxvYWQoKVxyXG59XHJcbikudGhlbigobmV3X2RhdGEpID0+IHtcclxuICAgIGRhdGEgPSBuZXdfZGF0YVxyXG4gICAgaWYgKHN0YXJ0T3ZlcnJpZGUgIT0gbnVsbCkge1xyXG4gICAgICAgIGN1cnJlbnRRdWVzdGlvbkluZGV4ID0gcGFyc2VJbnQoc3RhcnRPdmVycmlkZSkgLSAxXHJcbiAgICAgICAgY29uc29sZS5sb2coXCJTdGFydGluZyBmcm9tXCIsIGN1cnJlbnRRdWVzdGlvbkluZGV4KVxyXG4gICAgfVxyXG4gICAgLy8gbmV4dF9xdWVzdGlvbigpXHJcbiAgICBuZXh0X2luc3RydWN0aW9ucygwKVxyXG4gICAgJChcIiNtYWluX2JveF9pbnN0cnVjdGlvbnNcIikuc2hvdygpXHJcbiAgICAkKFwiI2luc3RydWN0aW9uc19hbmRfZGVjb3JhdGlvbnNcIikuaGlkZSgpXHJcbn0pXHJcblxyXG5jb25zb2xlLmxvZyhcIlN0YXJ0aW5nIHNlc3Npb24gd2l0aCBVSUQ6XCIsIGdsb2JhbFRoaXMudWlkISlcclxuXHJcbmxldCBhbGVydF9hY3RpdmUgPSBmYWxzZVxyXG5kb2N1bWVudC5vbnZpc2liaWxpdHljaGFuZ2UgPSAoKSA9PiB7XHJcbiAgICBpZiAoIWFsZXJ0X2FjdGl2ZSkge1xyXG4gICAgICAgIGNvdW50X2V4aXRlZF9wYWdlICs9IDFcclxuICAgICAgICBhbGVydF9hY3RpdmUgPSB0cnVlXHJcbiAgICAgICAgLy9pZiAoIShnbG9iYWxUaGlzLnVpZCEuc3RhcnRzV2l0aChcImRlbW9cIikpKSB7XHJcbiAgICAgICAgLy8gICAgYWxlcnQoXCJQbGVhc2UgZG9uJ3QgbGVhdmUgdGhlIHBhZ2UuIElmIHlvdSBkbyBzbyBhZ2Fpbiwgd2UgbWF5IHJlc3RyaWN0IHBheWluZyB5b3UuXCIpXHJcbiAgICAgICAgLy99XHJcbiAgICAgICAgYWxlcnRfYWN0aXZlID0gZmFsc2VcclxuICAgIH1cclxufVxyXG5cclxuLy8gV2hlbiB0aGUgRE9NIGlzIHJlYWR5OlxyXG4kKGRvY3VtZW50KS5yZWFkeSgoKSA9PiB7XHJcbiAgICAvLyBUcmFuc2l0aW9uIGZyb20gUGFydCAxIChxdWVzdGlvbikgdG8gUGFydCAyIChjb25maWRlbmNlIHJhdGluZylcclxuICAgICQoXCIjYnV0dG9uX25leHRfcGFydDFcIikub24oXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgIC8vIE9wdGlvbmFsbHksIGxvZyBvciBzYXZlIGFueSBQYXJ0IDEgZGF0YSBoZXJlLlxyXG4gICAgICBjbGVhclRpbWVvdXQocGFydDFUaW1lcik7XHJcbiAgICAgICQoXCIjdGltZXJcIikuaGlkZSgpO1xyXG5cclxuXHJcbiAgICAgICQoXCIjcGFydDFcIikuaGlkZSgpO1xyXG4gICAgICAkKFwiI3BhcnQyXCIpLnNob3coKTtcclxuICAgIH0pO1xyXG4gIFxyXG4gICAgLy8gSGFuZGxlIGNvbmZpZGVuY2UgcmF0aW5nIHNlbGVjdGlvbnM6XHJcbiAgICAkKFwiLmNvbmZpZGVuY2UtYnV0dG9uXCIpLm9uKFwiY2xpY2tcIiwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgbGV0IHJhdGluZyA9IHBhcnNlSW50KCQodGhpcykuYXR0cihcImRhdGEtcmF0aW5nXCIpIGFzIHN0cmluZyk7XHJcbiAgICAgICAgLy8gUmVtb3ZlICdzZWxlY3RlZCcgZnJvbSBhbGwgYnV0dG9ucywgdGhlbiBhZGQgaXQgdG8gdGhlIGNsaWNrZWQgb25lLlxyXG4gICAgICAgICQoXCIuY29uZmlkZW5jZS1idXR0b25cIikucmVtb3ZlQ2xhc3MoXCJzZWxlY3RlZFwiKTtcclxuICAgICAgICAkKHRoaXMpLmFkZENsYXNzKFwic2VsZWN0ZWRcIik7XHJcbiAgICAgICAgLy8gU3RvcmUgdGhlIHJhdGluZyBhbmQgZW5hYmxlIHRoZSBQYXJ0IDIgTmV4dCBidXR0b24uXHJcbiAgICAgICAgY29uZmlkZW5jZVJhdGluZyA9IHJhdGluZztcclxuICAgICAgICAkKFwiI2J1dHRvbl9uZXh0X3BhcnQyXCIpLnJlbW92ZUF0dHIoXCJkaXNhYmxlZFwiKTtcclxuICAgIH0pO1xyXG4gIFxyXG4gICAgLy8gVHJhbnNpdGlvbiBmcm9tIFBhcnQgMiAoY29uZmlkZW5jZSByYXRpbmcpIHRvIHRoZSBuZXh0IHF1ZXN0aW9uLlxyXG4gICAgJChcIiNidXR0b25fbmV4dF9wYXJ0MlwiKS5vbihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgLy8gTG9nIHRoZSBjb25maWRlbmNlIHJhdGluZyBhbG9uZyB3aXRoIG90aGVyIGRhdGEgaWYgbmVlZGVkLlxyXG4gICAgICBsZXQgbG9nZ2VkX2RhdGEgPSB7XHJcbiAgICAgICAgXCJxdWVzdGlvbl9pXCI6IGN1cnJlbnRRdWVzdGlvbkluZGV4LFxyXG4gICAgICAgIFwiY29uZGl0aW9uX2lcIjogY3VycmVudENvbmRpdGlvbkluZGV4LFxyXG4gICAgICAgIFwiY29uZmlkZW5jZV9yYXRpbmdcIjogY29uZmlkZW5jZVJhdGluZyxcclxuICAgICAgICAvLyAuLi4gaW5jbHVkZSBvdGhlciBsb2dnaW5nIGZpZWxkcyBhcyBkZXNpcmVkXHJcbiAgICAgIH07XHJcbiAgICAgIGxvZ19kYXRhKGxvZ2dlZF9kYXRhKTtcclxuICAgICAgXHJcbiAgICAgIC8vIFJlc2V0IFBhcnQgMiBVSSBlbGVtZW50cyBmb3IgdGhlIG5leHQgcXVlc3Rpb24uXHJcbiAgICAgICQoXCIjYnV0dG9uX25leHRfcGFydDJcIikuYXR0cihcImRpc2FibGVkXCIsIFwidHJ1ZVwiKTtcclxuICAgICAgJChcIi5jb25maWRlbmNlLWJ1dHRvblwiKS5yZW1vdmVDbGFzcyhcInNlbGVjdGVkXCIpO1xyXG4gICAgICBjb25maWRlbmNlUmF0aW5nID0gLTE7XHJcbiAgICAgIFxyXG4gICAgICAvLyBTd2l0Y2ggYmFjayB0byBQYXJ0IDEgYW5kIGxvYWQgdGhlIG5leHQgcXVlc3Rpb24uXHJcbiAgICAgICQoXCIjcGFydDJcIikuaGlkZSgpO1xyXG4gICAgICAkKFwiI3BhcnQxXCIpLnNob3coKTtcclxuICAgICAgY3VycmVudFF1ZXN0aW9uSW5kZXgrKztcclxuICAgICAgbmV4dF9xdWVzdGlvbigpO1xyXG4gICAgfSk7XHJcbiAgICAkKFwiaW5wdXRbbmFtZT0nbGF0ZXhFeHBlcmllbmNlJ10sIGlucHV0W25hbWU9J2xhdGV4RnJlcXVlbmN5J10sIGlucHV0W25hbWU9J2NoYXRib3RGcmVxdWVuY3knXVwiKS5vbihcImNoYW5nZVwiLCAoKSA9PiB7XHJcbiAgICAgICAgaWYoY2hlY2tQcmVTdXJ2ZXkoKSkge1xyXG4gICAgICAgICAgICAkKFwiI2J1dHRvbl9pbnN0cnVjdGlvbnNfbmV4dFwiKS5yZW1vdmVBdHRyKFwiZGlzYWJsZWRcIilcclxuICAgICAgICAgICAgJChcIiNidXR0b25faW5zdHJ1Y3Rpb25zX25leHRcIikuc2hvdygpICAgICAgICAgICAgXHJcbiAgICAgICAgfVxyXG5cclxuICAgIH0pO1xyXG4gICAgLy8ga2V5bG9nIHRoZSBpbnB1dFxyXG4gICAgJChcIiN0b2tlbl9pbnB1dFwiKS5vbihcImlucHV0XCIsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGxldCBjdXJyZW50VGV4dCA9ICQodGhpcykudmFsKCk7XHJcbiAgICAgICAgY29uc29sZS5sb2coXCJVc2VyIGlucHV0OlwiLCBjdXJyZW50VGV4dCk7XHJcbiAgICB9XHJcbiAgICApO1xyXG4vLyBHbG9iYWwgb2JqZWN0IHRvIHRyYWNrIHdoZXRoZXIgYSBzbGlkZXIgd2FzIGNoYW5nZWQuXHJcbmludGVyZmFjZSBTbGlkZXJTdGF0ZSB7XHJcbiAgICBtZW50YWxfZGVtYW5kOiBib29sZWFuO1xyXG4gICAgaHVycmllZF9kZW1hbmQ6IGJvb2xlYW47XHJcbiAgICBwZXJmb3JtYW5jZTogYm9vbGVhbjtcclxuICAgIGVmZm9ydDogYm9vbGVhbjtcclxuICAgIGZydXN0cmF0aW9uOiBib29sZWFuO1xyXG59XHJcblxyXG5jb25zdCBzbGlkZXJDaGFuZ2VkOiBTbGlkZXJTdGF0ZSA9IHtcclxuICAgIG1lbnRhbF9kZW1hbmQ6IGZhbHNlLFxyXG4gICAgaHVycmllZF9kZW1hbmQ6IGZhbHNlLFxyXG4gICAgcGVyZm9ybWFuY2U6IGZhbHNlLFxyXG4gICAgZWZmb3J0OiBmYWxzZSxcclxuICAgIGZydXN0cmF0aW9uOiBmYWxzZVxyXG59O1xyXG5cclxuLy8gR2xvYmFsIG9iamVjdCB0byBzdG9yZSB0aGUgc2VsZWN0ZWQgdmFsdWVzLiAobnVsbCBpbmRpY2F0ZXMgbm8gc2VsZWN0aW9uIHlldClcclxuY29uc3QgdGx4VmFsdWVzOiB7IFtrZXk6IHN0cmluZ106IG51bWJlciB8IG51bGwgfSA9IHtcclxuICAgIG1lbnRhbF9kZW1hbmQ6IG51bGwsXHJcbiAgICBodXJyaWVkX2RlbWFuZDogbnVsbCxcclxuICAgIHBlcmZvcm1hbmNlOiBudWxsLFxyXG4gICAgZWZmb3J0OiBudWxsLFxyXG4gICAgZnJ1c3RyYXRpb246IG51bGxcclxufTtcclxuXHJcbmZ1bmN0aW9uIGNoZWNrQWxsU2xpZGVyc0NoYW5nZWQoKTogYm9vbGVhbiB7XHJcbiAgICByZXR1cm4gT2JqZWN0LnZhbHVlcyhzbGlkZXJDaGFuZ2VkKS5ldmVyeSh2YWx1ZSA9PiB2YWx1ZSA9PT0gdHJ1ZSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHJlc2V0U2xpZGVycygpIHtcclxuICAgIC8vIFJlc2V0IHRyYWNraW5nIG9iamVjdCBhbmQgc2VsZWN0ZWQgdmFsdWVzXHJcbiAgICBmb3IgKGxldCBrZXkgaW4gc2xpZGVyQ2hhbmdlZCkge1xyXG4gICAgICAgIHNsaWRlckNoYW5nZWRba2V5IGFzIGtleW9mIFNsaWRlclN0YXRlXSA9IGZhbHNlO1xyXG4gICAgfVxyXG4gICAgZm9yIChsZXQga2V5IGluIHRseFZhbHVlcykge1xyXG4gICAgICAgIHRseFZhbHVlc1trZXldID0gbnVsbDtcclxuICAgIH1cclxuICAgIC8vIFJlbW92ZSBzZWxlY3Rpb24gaGlnaGxpZ2h0IGZyb20gYWxsIGJveGVzXHJcbiAgICAkKFwiLnRseC1ib3hcIikucmVtb3ZlQ2xhc3MoXCJzZWxlY3RlZFwiKTtcclxuICAgIG5leHRCdXR0b24ucHJvcChcImRpc2FibGVkXCIsIHRydWUpO1xyXG59XHJcblxyXG4vLyBEaXNhYmxlIHRoZSBcIk5leHRcIiBidXR0b24gaW5pdGlhbGx5XHJcbmNvbnN0IG5leHRCdXR0b24gPSAkKFwiI25hc2FfdGx4X25leHRcIikgYXMgSlF1ZXJ5PEhUTUxJbnB1dEVsZW1lbnQ+O1xyXG5uZXh0QnV0dG9uLnByb3AoXCJkaXNhYmxlZFwiLCB0cnVlKTtcclxuXHJcbi8vIEV2ZW50IGxpc3RlbmVyIGZvciBhbGwgc2xpZGVyc1xyXG4kKFwiLnRseC1ib3hcIikub24oXCJjbGlja1wiLCBmdW5jdGlvbigpIHtcclxuICAgIGNvbnN0IHNsaWRlcklkID0gJCh0aGlzKS5wYXJlbnQoKS5hdHRyKFwiaWRcIik7IC8vIGUuZy4sIFwibWVudGFsX2RlbWFuZFwiXHJcbiAgICBpZiAoIXNsaWRlcklkIHx8ICEoc2xpZGVySWQgaW4gc2xpZGVyQ2hhbmdlZCkpIHJldHVybjtcclxuICAgIGNvbnN0IHZhbHVlID0gcGFyc2VJbnQoJCh0aGlzKS5hdHRyKFwiZGF0YS12YWx1ZVwiKSBhcyBzdHJpbmcpO1xyXG4gICAgdGx4VmFsdWVzW3NsaWRlcklkXSA9IHZhbHVlO1xyXG4gICAgc2xpZGVyQ2hhbmdlZFtzbGlkZXJJZCBhcyBrZXlvZiBTbGlkZXJTdGF0ZV0gPSB0cnVlO1xyXG4gICAgXHJcbiAgICAvLyBVcGRhdGUgVUk6IG1hcmsgdGhpcyBib3ggYXMgc2VsZWN0ZWQgYW5kIHJlbW92ZSBzZWxlY3Rpb24gZnJvbSBzaWJsaW5ncy5cclxuICAgICQodGhpcykuc2libGluZ3MoKS5yZW1vdmVDbGFzcyhcInNlbGVjdGVkXCIpO1xyXG4gICAgJCh0aGlzKS5hZGRDbGFzcyhcInNlbGVjdGVkXCIpO1xyXG5cclxuICAgIC8vIEVuYWJsZSB0aGUgTmV4dCBidXR0b24gaWYgYWxsIHNsaWRlcnMgaGF2ZSBiZWVuIGNoYW5nZWQuXHJcbiAgICBpZiAoY2hlY2tBbGxTbGlkZXJzQ2hhbmdlZCgpKSB7XHJcbiAgICAgICAgbmV4dEJ1dHRvbi5wcm9wKFwiZGlzYWJsZWRcIiwgZmFsc2UpO1xyXG4gICAgfVxyXG59KTtcclxuXHJcbi8vIEV2ZW50IGxpc3RlbmVyIGZvciBcIk5leHRcIiBidXR0b24gaW4gTkFTQSBUTFggc3VydmV5XHJcbm5leHRCdXR0b24ub24oXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICBpZiAoIWNoZWNrQWxsU2xpZGVyc0NoYW5nZWQoKSkge1xyXG4gICAgICAgIGFsZXJ0KFwiUGxlYXNlIGFkanVzdCBhbGwgc2xpZGVycyBiZWZvcmUgY29udGludWluZy5cIik7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IHRseERhdGEgPSB7XHJcbiAgICAgICAgbWVudGFsX2RlbWFuZDogdGx4VmFsdWVzW1wibWVudGFsX2RlbWFuZFwiXSAhPT0gbnVsbCA/IHRseFZhbHVlc1tcIm1lbnRhbF9kZW1hbmRcIl0gOiAwLFxyXG4gICAgICAgIGh1cnJpZWRfZGVtYW5kOiB0bHhWYWx1ZXNbXCJodXJyaWVkX2RlbWFuZFwiXSAhPT0gbnVsbCA/IHRseFZhbHVlc1tcImh1cnJpZWRfZGVtYW5kXCJdIDogMCxcclxuICAgICAgICBwZXJmb3JtYW5jZTogdGx4VmFsdWVzW1wicGVyZm9ybWFuY2VcIl0gIT09IG51bGwgPyB0bHhWYWx1ZXNbXCJwZXJmb3JtYW5jZVwiXSA6IDAsXHJcbiAgICAgICAgZWZmb3J0OiB0bHhWYWx1ZXNbXCJlZmZvcnRcIl0gIT09IG51bGwgPyB0bHhWYWx1ZXNbXCJlZmZvcnRcIl0gOiAwLFxyXG4gICAgICAgIGZydXN0cmF0aW9uOiB0bHhWYWx1ZXNbXCJmcnVzdHJhdGlvblwiXSAhPT0gbnVsbCA/IHRseFZhbHVlc1tcImZydXN0cmF0aW9uXCJdIDogMFxyXG4gICAgfTtcclxuICAgIFxyXG5cclxuICAgIGxvZ19kYXRhKHtcclxuICAgICAgICBjb25kaXRpb246ICQoXCIjY29uZGl0aW9uX2xhYmVsXCIpLnRleHQoKSxcclxuICAgICAgICB0bHg6IHRseERhdGFcclxuICAgIH0pO1xyXG5cclxuICAgIC8vIEhpZGUgdGhlIE5BU0EgVExYIHBhZ2UgYW5kIG1vdmUgb25cclxuICAgIHJlc2V0U2xpZGVycygpO1xyXG4gICAgJChcIiNuYXNhX3RseF9zdXJ2ZXlcIikuaGlkZSgpO1xyXG4gICAgY3VycmVudENvbmRpdGlvbkluZGV4Kys7XHJcbiAgICBjdXJyZW50UXVlc3Rpb25JbmRleCA9IDA7XHJcbiAgICBuZXh0X3F1ZXN0aW9uKCk7XHJcbn0pO1xyXG5cclxuICAgIFxyXG5cclxufSk7XHJcbiAgZnVuY3Rpb24gYXV0b1N1Ym1pdFBhcnQxKCkge1xyXG4gICAgLy8gU3RvcCB0aGUgdGltZXIgaWYgbm90IGFscmVhZHkgY2xlYXJlZFxyXG4gICAgY2xlYXJJbnRlcnZhbChwYXJ0MUludGVydmFsKTtcclxuICAgICQoXCIjdGltZXJcIikuaGlkZSgpO1xyXG4gICAgXHJcbiAgICAvLyBBdXRvbWF0aWNhbGx5IHRyYW5zaXRpb24gdG8gUGFydCAyXHJcbiAgICAkKFwiI3BhcnQxXCIpLmhpZGUoKTtcclxuICAgICQoXCIjcGFydDJcIikuc2hvdygpO1xyXG59XHJcbiQoXCIjcXVhbF9uZXh0XCIpLm9uKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgY29uc3QgcTEgPSAoJChcIiNxdWFsX3ExXCIpLnZhbCgpIGFzIHN0cmluZykgfHwgXCJcIjtcclxuICAgIGNvbnN0IHEyID0gKCQoXCIjcXVhbF9xMlwiKS52YWwoKSBhcyBzdHJpbmcpIHx8IFwiXCI7XHJcbiAgICBjb25zdCBxMyA9ICgkKFwiI3F1YWxfcTNcIikudmFsKCkgYXMgc3RyaW5nKSB8fCBcIlwiO1xyXG4gICAgXHJcbiAgICBsZXQgdmFsaWQgPSB0cnVlO1xyXG4gICAgXHJcbiAgICBpZiAocTEubGVuZ3RoIDwgMjUpIHtcclxuICAgICAgICAkKFwiI3dhcm5fcTFcIikuc2hvdygpO1xyXG4gICAgICAgIHZhbGlkID0gZmFsc2U7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgICQoXCIjd2Fybl9xMVwiKS5oaWRlKCk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGlmIChxMi5sZW5ndGggPCAyNSkge1xyXG4gICAgICAgICQoXCIjd2Fybl9xMlwiKS5zaG93KCk7XHJcbiAgICAgICAgdmFsaWQgPSBmYWxzZTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgJChcIiN3YXJuX3EyXCIpLmhpZGUoKTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgaWYgKHEzLmxlbmd0aCA8IDApIHtcclxuICAgICAgICAkKFwiI3dhcm5fcTNcIikuc2hvdygpO1xyXG4gICAgICAgIHZhbGlkID0gZmFsc2U7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgICQoXCIjd2Fybl9xM1wiKS5oaWRlKCk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIElmIHZhbGlkYXRpb24gZmFpbHMsIGRvIG5vdCBwcm9jZWVkXHJcbiAgICBpZiAoIXZhbGlkKSB7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyBJZiBhbGwgdGV4dCBib3hlcyBoYXZlIGF0IGxlYXN0IDUwIGNoYXJhY3RlcnMsIGxvZyBkYXRhIGFuZCBwcm9jZWVkXHJcbiAgICBjb25zdCBmaW5hbERhdGEgPSB7XHJcbiAgICAgICAgcXVhbGl0YXRpdmU6IHtcclxuICAgICAgICAgICAgcTE6IHExLFxyXG4gICAgICAgICAgICBxMjogcTIsXHJcbiAgICAgICAgICAgIHEzOiBxM1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgLy8gLi4uIGluY2x1ZGUgYW55IGFkZGl0aW9uYWwgZGF0YSBpZiBuZWVkZWRcclxuICAgIH07XHJcbiAgICBsb2dfZGF0YShmaW5hbERhdGEpO1xyXG4gICAgXHJcbiAgICAvLyBUcmFuc2l0aW9uIHRvIGVuZC1vZi1zdXJ2ZXkg4oCcVGhhbmsgeW914oCdIHNjcmVlbiBvciBzaW1pbGFyLlxyXG4gICAgJChcIiNxdWFsaXRhdGl2ZV9zZWN0aW9uXCIpLmhpZGUoKTtcclxuICAgIGlmIChNT0NLTU9ERSkge1xyXG4gICAgICAgICQoJyNyZXdhcmRfYm94X21vY2snKS50ZXh0KGBZb3VyIHRvdGFsIHJld2FyZCBpcyAkMy4wMC5gKTtcclxuICAgICAgICAkKCcjcmV3YXJkX2JveF9tb2NrJykuc2hvdygpO1xyXG4gICAgICAgICQoXCIjbWFpbl9ib3hfZW5kX21vY2tcIikuc2hvdygpOyAgICBcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgJCgnI3Jld2FyZF9ib3gnKS50ZXh0KGBZb3VyIHRvdGFsIHJld2FyZCBpcyAkMy4wMC5gKTtcclxuICAgICAgICAkKCcjcmV3YXJkX2JveCcpLnNob3coKTtcclxuICAgICAgICAkKFwiI21haW5fYm94X2VuZFwiKS5zaG93KCk7ICAgIFxyXG4gICAgfVxyXG59KTtcclxuIl0sIm5hbWVzIjpbIlNFUlZFUl9MT0dfUk9PVCIsImFzeW5jIiwibG9nX2RhdGEiLCJkYXRhIiwiZ2xvYmFsVGhpcyIsInVybF9kYXRhIiwiY29uc29sZSIsImxvZyIsInVpZCIsInJlc3VsdCIsIiQiLCJhamF4IiwiSlNPTiIsInN0cmluZ2lmeSIsInByb2plY3QiLCJwYXlsb2FkIiwidHlwZSIsImNvbnRlbnRUeXBlIiwiUHJvbWlzZSIsInJlc29sdmUiLCJzZXRUaW1lb3V0Iiwic2xlZXAiLCJlIiwiZml4U3BhY2luZyIsImlucHV0Iiwib3V0cHV0IiwicmVwbGFjZSIsIk1PQ0tNT0RFIiwicXVlc3Rpb24iLCJjb25maWRlbmNlUmF0aW5nIiwicGFydDFUaW1lciIsInBhcnQxSW50ZXJ2YWwiLCJyZW1haW5pbmdUaW1lIiwiY3VycmVudENvbmRpdGlvbkluZGV4IiwiY3VycmVudFF1ZXN0aW9uSW5kZXgiLCJpbnN0cnVjdGlvbl9pIiwiY291bnRfZXhpdGVkX3BhZ2UiLCJjaGVja1ByZVN1cnZleSIsImxhdGV4RXhwIiwidmFsIiwibGF0ZXhGcmVxIiwiY2hhdGJvdEZyZXEiLCJzaG93IiwiaGlkZSIsIm5leHRfaW5zdHJ1Y3Rpb25zIiwiaW5jcmVtZW50IiwiYXR0ciIsInJlbW92ZUF0dHIiLCJuZXh0X3F1ZXN0aW9uIiwiY2hpbGRyZW4iLCJlYWNoIiwiXyIsImVsIiwib24iLCJwcmFjdGljZVF1ZXN0aW9ucyIsInByYWN0aWNlSW5kZXgiLCJzaG93UHJhY3RpY2VSb3VuZCIsIm9uQ29tcGxldGUiLCJlbXB0eSIsInByYWN0aWNlQ29udGVudCIsImFwcGVuZCIsImh0bWwiLCJsZW5ndGgiLCJjb25kaXRpb24iLCJidWxsZXRQb2ludHMiLCJwdXNoIiwiYnVsbGV0SHRtbCIsIm1hcCIsInBvaW50Iiwiam9pbiIsInByZWRpY3RlZEh0bWwiLCJBcnJheSIsImlzQXJyYXkiLCJmaWx0ZXIiLCJpdGVtIiwidG9rZW4iLCJ0b2tlblRleHQiLCJpbnRlbnNpdHkiLCJ0b3BfNV90b2tlbnMiLCJwcm9iYWJpbGl0eSIsInRva2Vuc0NvbmNhdGVuYXRlZCIsImFkZGl0aW9uYWxUZXh0Iiwib2ZmIiwiY29uZGl0aW9uQmxvY2siLCJoZWFkZXJIdG1sIiwicmVqZWN0IiwiZ2V0SlNPTiIsImRvbmUiLCJmYWlsIiwianF4aHIiLCJ0ZXh0U3RhdHVzIiwiZXJyb3IiLCJ0aGVuIiwiY2F0Y2giLCJlcnIiLCJzaG93U3RhcnRDb25kaXRpb25QYWdlIiwicXVlc3Rpb25zIiwiY3VycmVudENvbmRpdGlvbiIsInRleHQiLCJzaG93RW5kQ29uZGl0aW9uUGFnZSIsImNsZWFyVGltZW91dCIsIndpbmRvdyIsImF1dG9TdWJtaXRQYXJ0MSIsImNsZWFySW50ZXJ2YWwiLCJzZXRJbnRlcnZhbCIsInVybFBhcmFtcyIsIlVSTFNlYXJjaFBhcmFtcyIsImxvY2F0aW9uIiwic2VhcmNoIiwic3RhcnRPdmVycmlkZSIsImdldCIsIlVJREZyb21VUkwiLCJlbnRyaWVzIiwia2V5IiwidmFsdWUiLCJwYXJhbXNUb09iamVjdCIsInF1ZXVlX2lkIiwiTWF0aCIsImZsb29yIiwicmFuZG9tIiwicGFkU3RhcnQiLCJVSURfbWF5YmUiLCJwcm9tcHQiLCJzdGFydHNXaXRoIiwiRGF0ZSIsIm5vdyIsImxvYWRfZGF0YSIsIl9lcnJvciIsInJlbG9hZCIsIm5ld19kYXRhIiwicGFyc2VJbnQiLCJhbGVydF9hY3RpdmUiLCJkb2N1bWVudCIsIm9udmlzaWJpbGl0eWNoYW5nZSIsInJlYWR5IiwicmF0aW5nIiwidGhpcyIsInJlbW92ZUNsYXNzIiwiYWRkQ2xhc3MiLCJjdXJyZW50VGV4dCIsInNsaWRlckNoYW5nZWQiLCJtZW50YWxfZGVtYW5kIiwiaHVycmllZF9kZW1hbmQiLCJwZXJmb3JtYW5jZSIsImVmZm9ydCIsImZydXN0cmF0aW9uIiwidGx4VmFsdWVzIiwiY2hlY2tBbGxTbGlkZXJzQ2hhbmdlZCIsIk9iamVjdCIsInZhbHVlcyIsImV2ZXJ5IiwibmV4dEJ1dHRvbiIsInByb3AiLCJzbGlkZXJJZCIsInBhcmVudCIsInNpYmxpbmdzIiwiYWxlcnQiLCJ0bHhEYXRhIiwidGx4IiwicmVzZXRTbGlkZXJzIiwicTEiLCJxMiIsInEzIiwidmFsaWQiLCJxdWFsaXRhdGl2ZSJdLCJzb3VyY2VSb290IjoiIn0=