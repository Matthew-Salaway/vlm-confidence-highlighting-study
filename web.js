(()=>{"use strict";let t="https://tejassrinivasan.pythonanywhere.com/";async function e(e){e.url_data=globalThis.url_data,console.log("Data"),"study_id"in e.url_data||(e.url_data.study_id="demo_study"),"prolific_id"in e.url_data||(e.url_data.prolific_id="demo_user"),"session_id"in e.url_data||(e.url_data.session_id="demo_session"),e.url_data.queue_id=globalThis.uid,console.log("logged",e),console.log("Logging to",t+"log");try{let n=await $.ajax(t+"log",{data:JSON.stringify({project:"vlm-rationales-study/"+e.url_data.study_id,uid:globalThis.uid+"_"+e.url_data.prolific_id,payload:JSON.stringify(e)}),type:"POST",contentType:"application/json"});return await async function(){return new Promise((t=>setTimeout(t,2e3)))}(),n}catch(t){console.log(t)}}var n=!1,i=[];let o=-1,a=null,s=-1,r=-1,u=-1,l=-1,d=0,_=0,c=20,h=0,b=0,w=0;function p(t){s=t,$("#button_answeronly_usertrusts").attr("disabled","true"),$("#button_answeronly_userdistrusts").attr("disabled","true"),$("#button_answeronly_userunsure").attr("disabled","true"),0==t?$("#button_answeronly_usertrusts").attr("activedecision","true"):1==t?$("#button_answeronly_userdistrusts").attr("activedecision","true"):2==t&&$("#button_answeronly_userunsure").attr("activedecision","true"),$("#ai_explanation_div").show()}function m(t){r=t,$("#button_withexplanation_usertrusts").attr("disabled","true"),$("#button_withexplanation_userdistrusts").attr("disabled","true"),$("#button_withexplanation_userunsure").attr("disabled","true"),0==t?$("#button_withexplanation_usertrusts").attr("activedecision","true"):1==t?$("#button_withexplanation_userdistrusts").attr("activedecision","true"):2==t&&$("#button_withexplanation_userunsure").attr("activedecision","true"),$("#ai_explanation_quality_div").show()}function g(t){u=t,$("#button_withexplanationquality_usertrusts").attr("disabled","true"),$("#button_withexplanationquality_userdistrusts").attr("disabled","true"),$("#button_withexplanationquality_userunsure").attr("disabled","true"),0==t?$("#button_withexplanationquality_usertrusts").attr("activedecision","true"):1==t?$("#button_withexplanationquality_userdistrusts").attr("activedecision","true"):2==t&&$("#button_withexplanationquality_userunsure").attr("activedecision","true"),$("#button_next").show(),$("#button_next").removeAttr("disabled")}function v(t){b+=t,0==b?$("#button_instructions_prev").attr("disabled","true"):$("#button_instructions_prev").removeAttr("disabled"),b>=5?($("#instructions_and_decorations").show(),$("#button_instructions_next").val("Start study")):($("#instructions_and_decorations").hide(),$("#button_instructions_next").val("Next")),6==b&&($("#instructions_and_decorations").show(),$("#main_box_instructions").hide(),$("#main_box_experiment").show(),x()),$("#main_box_instructions").children(":not(input)").each(((t,e)=>{$(e).hide()})),$(`#instructions_${b}`).show()}function y(t){return 2!=t?t==1-a.prediction_is_correct?1:0:-1}function x(){if($("#button_readytoanswer").removeAttr("activedecision"),$("#button_readytoanswer").removeAttr("disabled"),$("#button_readytoanswer").show(),$("#button_answeronly_usertrusts").removeAttr("activedecision"),$("#button_answeronly_usertrusts").removeAttr("disabled"),$("#button_answeronly_userdistrusts").removeAttr("activedecision"),$("#button_answeronly_userdistrusts").removeAttr("disabled"),$("#button_answeronly_userunsure").removeAttr("activedecision"),$("#button_answeronly_userunsure").removeAttr("disabled"),$("#button_withexplanation_usertrusts").removeAttr("activedecision"),$("#button_withexplanation_usertrusts").removeAttr("disabled"),$("#button_withexplanation_userdistrusts").removeAttr("activedecision"),$("#button_withexplanation_userdistrusts").removeAttr("disabled"),$("#button_withexplanation_userunsure").removeAttr("activedecision"),$("#button_withexplanation_userunsure").removeAttr("disabled"),$("#button_withexplanationquality_usertrusts").removeAttr("activedecision"),$("#button_withexplanationquality_usertrusts").removeAttr("disabled"),$("#button_withexplanationquality_userdistrusts").removeAttr("activedecision"),$("#button_withexplanationquality_userdistrusts").removeAttr("disabled"),$("#button_withexplanationquality_userunsure").removeAttr("activedecision"),$("#button_withexplanationquality_userunsure").removeAttr("disabled"),$("#ai_explanation_div").hide(),$("#ai_explanation_quality_div").hide(),$("#button_next").hide(),$("#button_quit").hide(),o+=1,o>=i.length)return $("#main_box_experiment").hide(),void $("#qualitative_section").show();a=i[o],$("#part1").show(),$("#part2").hide(),a.image?$("#question_image").attr("src","data:image/png;base64,"+a.image):$("#question_image").attr("src","");let t="";a.token_info&&Array.isArray(a.token_info)&&(t=a.token_info.filter((t=>"<|im_end|>"!==t.token)).map((t=>{let e=t.token.replace(/Ġ/g," "),n=1-(t.top_5_tokens&&t.top_5_tokens[0]&&"number"==typeof t.top_5_tokens[0].probability?t.top_5_tokens[0].probability:1);return 1==a.is_highlighted?`<span style="background-color: rgba(255, 0, 0, ${n});">${e}</span>`:e})).join("")),$("#predicted_text").html(t),1==a.is_highlighted?$("#predicted_text_container strong").addClass("highlighted-title"):$("#predicted_text_container strong").removeClass("highlighted-title");let e="";a.token_info&&Array.isArray(a.token_info)&&(e=a.token_info.map((t=>t.token)).filter((t=>"<|im_end|>"!==t)).map((t=>t.replace(/Ġ/g," "))).join("")),$("#token_input").val(e),$("#progress").text(`Progress: ${o+1} / ${i.length}`),clearTimeout(d),d=window.setTimeout(T,2e4),c=20,$("#timer").text(c),$("#timer").show(),_&&clearInterval(_),_=window.setInterval((()=>{c-=1,$("#timer").text(c),c<=0&&(clearInterval(_),T(),$("#timer").hide())}),1e3)}document.getElementById("button_answeronly_usertrusts")?.addEventListener("click",(()=>p(0))),document.getElementById("button_answeronly_userdistrusts")?.addEventListener("click",(()=>p(1))),document.getElementById("button_answeronly_userunsure")?.addEventListener("click",(()=>p(2))),document.getElementById("button_withexplanation_usertrusts")?.addEventListener("click",(()=>m(0))),document.getElementById("button_withexplanation_userdistrusts")?.addEventListener("click",(()=>m(1))),document.getElementById("button_withexplanation_userunsure")?.addEventListener("click",(()=>m(2))),document.getElementById("button_withexplanationquality_usertrusts")?.addEventListener("click",(()=>g(0))),document.getElementById("button_withexplanationquality_userdistrusts")?.addEventListener("click",(()=>g(1))),document.getElementById("button_withexplanationquality_userunsure")?.addEventListener("click",(()=>g(2))),$("#button_instructions_next").on("click",(()=>v(1))),$("#button_instructions_prev").on("click",(()=>v(-1))),$("#button_next").on("click",(()=>{let t=h;if(function(){if(2!=u){let t=1-a.prediction_is_correct;u==t&&(h+=.1)}}(),-1!=o){let n={question_i:o,user_selections:{answeronly:s,withexplanation:r,withexplanationquality:u},user_is_correct:{answeronly:y(s),withexplanation:y(r),withexplanationquality:y(u)},balance:{old:t,new:h}};n.question=a,n.count_exited_page=w,e(n),w=0}x()}));const q=new URLSearchParams(window.location.search),f=q.get("start"),k=q.get("uid");if(globalThis.url_data=function(t){const e={};for(const[n,i]of t)e[n]=i;return e}(q.entries()),null==globalThis.url_data.study_id&&(globalThis.url_data.study_id="demo_study"),null==globalThis.url_data.prolific_id&&(globalThis.url_data.prolific_id="demo_user"),null==globalThis.url_data.session_id&&(globalThis.url_data.session_id="demo_session"),null!=k){if(globalThis.uid=k,"prolific_random"==globalThis.uid){let t=`${Math.floor(10*Math.random())}`.padStart(3,"0");globalThis.uid=`${q.get("prolific_queue_name")}/${t}`}}else{let t=null;for(;null==t;)t=prompt("Enter your user id. Please get in touch if you were not assigned an id but wish to participate in this experiment.");globalThis.uid=t}globalThis.url_data.session_id.startsWith("demo")&&(n=!0),console.log("Running with UID",globalThis.uid),async function(){return await $.getJSON(`baked_queues/${globalThis.uid}.json?t=${Date.now()}`)}().catch((t=>{console.log("Invalid user id."),console.log(globalThis.uid),window.location.reload()})).then((t=>{i=t,null!=f&&(o=parseInt(f)-1,console.log("Starting from",o)),v(0),$("#main_box_instructions").show(),$("#instructions_and_decorations").hide()})),console.log("Starting session with UID:",globalThis.uid);let A=!1;function T(){clearInterval(_),$("#timer").hide(),$("#part1").hide(),$("#part2").show()}document.onvisibilitychange=()=>{A||(w+=1,A=!0,A=!1)},$(document).ready((()=>{$("#button_next_part1").on("click",(()=>{clearTimeout(d),$("#timer").hide(),$("#part1").hide(),$("#part2").show()})),$(".confidence-button").on("click",(function(){let t=parseInt($(this).attr("data-rating"));$(".confidence-button").removeClass("selected"),$(this).addClass("selected"),l=t,$("#button_next_part2").removeAttr("disabled")})),$("#button_next_part2").on("click",(()=>{e({question_i:o,confidence_rating:l}),$("#button_next_part2").attr("disabled","true"),$(".confidence-button").removeClass("selected"),l=-1,$("#part2").hide(),$("#part1").show(),x()}))})),$("#qual_next").on("click",(()=>{const t=$("#qual_q1").val()||"",i=$("#qual_q2").val()||"",a=$("#qual_q3").val()||"";let s=!0;t.length<25?($("#warn_q1").show(),s=!1):$("#warn_q1").hide(),i.length<25?($("#warn_q2").show(),s=!1):$("#warn_q2").hide(),a.length<25?($("#warn_q3").show(),s=!1):$("#warn_q3").hide(),s&&(e({qualitative:{q1:t,q2:i,q3:a}}),$("#qualitative_section").hide(),n?($("#reward_box_mock").text(`Your total reward is $${h.toFixed(2)} (${o} questions answered) + $2.`),$("#reward_box_mock").show(),$("#main_box_end_mock").show()):($("#reward_box").text(`Your total reward is $${h.toFixed(2)} (${o} questions answered) + $2.`),$("#reward_box").show(),$("#main_box_end").show()))}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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UmpILEVBQUUsWUFBWW9DLE9BSWI2RSxJQWFMekgsRUFSa0IsQ0FDZDBILFlBQWEsQ0FDVEosR0FBSUEsRUFDSkMsR0FBSUEsRUFDSkMsR0FBSUEsS0FPWmhILEVBQUUsd0JBQXdCb0MsT0FDdEJ2QixHQUNBYixFQUFFLG9CQUFvQjhELEtBQUsseUJBQXlCdkMsRUFBUTRGLFFBQVEsT0FBT3JHLCtCQUMzRWQsRUFBRSxvQkFBb0I2QixPQUN0QjdCLEVBQUUsc0JBQXNCNkIsU0FFeEI3QixFQUFFLGVBQWU4RCxLQUFLLHlCQUF5QnZDLEVBQVE0RixRQUFRLE9BQU9yRywrQkFDdEVkLEVBQUUsZUFBZTZCLE9BQ2pCN0IsRUFBRSxpQkFBaUI2QixRIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vc3JjL2Nvbm5lY3Rvci50cyIsIndlYnBhY2s6Ly8vLi9zcmMvbWFpbi50cyIsIndlYnBhY2s6Ly8vLi9zcmMvdXRpbHMudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgREVWTU9ERSB9IGZyb20gJy4vZ2xvYmFscydcclxuaW1wb3J0IHsgTU9DS01PREUgfSBmcm9tICcuL21haW4nXHJcblxyXG5sZXQgU0VSVkVSX0xPR19ST09UID0gREVWTU9ERSA/IFwiaHR0cDovLzEyNy4wLjAuMTo1MDAwL1wiIDogXCJodHRwczovL3RlamFzc3Jpbml2YXNhbi5weXRob25hbnl3aGVyZS5jb20vXCJcclxuXHJcbmFzeW5jIGZ1bmN0aW9uIHNsZWVwKG1zOiBudW1iZXIpOiBQcm9taXNlPHZvaWQ+IHtcclxuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4gc2V0VGltZW91dChyZXNvbHZlLCBtcykpO1xyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gbG9hZF9kYXRhKCk6IFByb21pc2U8YW55PiB7XHJcbiAgICAvLyBpbmNsdWRlIHRpbWVzdGFtcCBzbyB0aGF0IHRoaW5ncyBkb24ndCBnZXQgY2FjaGVkXHJcbiAgICBsZXQgcmVzdWx0ID0gYXdhaXQgJC5nZXRKU09OKFxyXG4gICAgICAgIGBiYWtlZF9xdWV1ZXMvJHtnbG9iYWxUaGlzLnVpZH0uanNvbj90PSR7RGF0ZS5ub3coKX1gLFxyXG4gICAgKVxyXG4gICAgcmV0dXJuIHJlc3VsdFxyXG59XHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBsb2dfZGF0YShkYXRhKTogUHJvbWlzZTxhbnk+IHtcclxuICAgIC8vaWYgKE1PQ0tNT0RFKSB7XHJcbiAgICAvLyAgICBjb25zb2xlLmxvZyhcImxvZ2dlZCAobW9jaylcIiwgZGF0YSlcclxuICAgIC8vICAgIHJldHVyblxyXG4gICAgLy99XHJcbiAgICBcclxuICAgIGRhdGFbXCJ1cmxfZGF0YVwiXSA9IGdsb2JhbFRoaXMudXJsX2RhdGFcclxuICAgIGNvbnNvbGUubG9nKFwiRGF0YVwiKVxyXG4gICAgaWYgKCEoXCJzdHVkeV9pZFwiIGluIGRhdGFbJ3VybF9kYXRhJ10pKSB7XHJcbiAgICAgICAgZGF0YVsndXJsX2RhdGEnXVtcInN0dWR5X2lkXCJdID0gXCJkZW1vX3N0dWR5XCJcclxuICAgIH1cclxuICAgIGlmICghKFwicHJvbGlmaWNfaWRcIiBpbiBkYXRhWyd1cmxfZGF0YSddKSkge1xyXG4gICAgICAgIGRhdGFbJ3VybF9kYXRhJ11bXCJwcm9saWZpY19pZFwiXSA9IFwiZGVtb191c2VyXCJcclxuICAgIH1cclxuICAgIGlmICghKFwic2Vzc2lvbl9pZFwiIGluIGRhdGFbJ3VybF9kYXRhJ10pKSB7XHJcbiAgICAgICAgZGF0YVsndXJsX2RhdGEnXVtcInNlc3Npb25faWRcIl0gPSBcImRlbW9fc2Vzc2lvblwiXHJcbiAgICB9XHJcbiAgICBkYXRhW1widXJsX2RhdGFcIl1bXCJxdWV1ZV9pZFwiXSA9IGdsb2JhbFRoaXMudWlkXHJcbiAgICBjb25zb2xlLmxvZyhcImxvZ2dlZFwiLCBkYXRhKVxyXG4gICAgY29uc29sZS5sb2coXCJMb2dnaW5nIHRvXCIsIFNFUlZFUl9MT0dfUk9PVCArIFwibG9nXCIpXHJcblxyXG4gICAgdHJ5IHtcclxuICAgICAgICBsZXQgcmVzdWx0ID0gYXdhaXQgJC5hamF4KFxyXG4gICAgICAgICAgICBTRVJWRVJfTE9HX1JPT1QgKyBcImxvZ1wiLFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBkYXRhOiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgICAgICAgICAgICAgcHJvamVjdDogXCJ2bG0tcmF0aW9uYWxlcy1zdHVkeS9cIitkYXRhWyd1cmxfZGF0YSddWydzdHVkeV9pZCddLFxyXG4gICAgICAgICAgICAgICAgICAgIHVpZDogZ2xvYmFsVGhpcy51aWQrXCJfXCIrZGF0YVsndXJsX2RhdGEnXVsncHJvbGlmaWNfaWQnXSxcclxuICAgICAgICAgICAgICAgICAgICBwYXlsb2FkOiBKU09OLnN0cmluZ2lmeShkYXRhKSxcclxuICAgICAgICAgICAgICAgIH0pLFxyXG4gICAgICAgICAgICAgICAgdHlwZTogJ1BPU1QnLFxyXG4gICAgICAgICAgICAgICAgY29udGVudFR5cGU6ICdhcHBsaWNhdGlvbi9qc29uJyxcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIClcclxuICAgICAgICBhd2FpdCBzbGVlcCgyMDAwKTtcclxuICAgICAgICByZXR1cm4gcmVzdWx0XHJcbiAgICB9IGNhdGNoIChlKSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coZSlcclxuICAgIH1cclxufSIsImltcG9ydCB7IERFVk1PREUgfSBmcm9tIFwiLi9nbG9iYWxzXCJcclxuZXhwb3J0IHZhciBVSUQ6IHN0cmluZ1xyXG5leHBvcnQgdmFyIE1PQ0tNT0RFOiBib29sZWFuID0gZmFsc2VcclxuaW1wb3J0IHsgbG9hZF9kYXRhLCBsb2dfZGF0YSB9IGZyb20gJy4vY29ubmVjdG9yJ1xyXG5pbXBvcnQgeyBwYXJhbXNUb09iamVjdCB9IGZyb20gXCIuL3V0aWxzXCJcclxuXHJcbnZhciBkYXRhOiBhbnlbXSA9IFtdXHJcbmxldCBxdWVzdGlvbl9pID0gLTFcclxubGV0IHF1ZXN0aW9uOiBhbnkgPSBudWxsXHJcbmxldCB1c2Vyc2VsZWN0aW9uX2Fuc3dlcm9ubHk6IG51bWJlciA9IC0xXHJcbmxldCB1c2Vyc2VsZWN0aW9uX3dpdGhleHBsYW5hdGlvbjogbnVtYmVyID0gLTFcclxubGV0IHVzZXJzZWxlY3Rpb25fd2l0aGV4cGxhbmF0aW9ucXVhbGl0eTogbnVtYmVyID0gLTFcclxubGV0IGNvbmZpZGVuY2VSYXRpbmc6IG51bWJlciA9IC0xO1xyXG5sZXQgcGFydDFUaW1lcjogbnVtYmVyID0gMDtcclxubGV0IHBhcnQxSW50ZXJ2YWw6IG51bWJlciA9IDA7XHJcbmxldCByZW1haW5pbmdUaW1lOiBudW1iZXIgPSAyMDtcclxuXHJcblxyXG5cclxubGV0IGJhbGFuY2UgPSAwXHJcbmxldCBiYWxhbmNlX2luY3JlbWVudCA9IDAuMSAgICAgLy8gQmFsYW5jZSB1cGRhdGVzIGJ5ICQwLjEwIGZvciBldmVyeSBjb3JyZWN0IHNlbGVjdGlvblxyXG5cclxubGV0IGluc3RydWN0aW9uX2k6IG51bWJlciA9IDBcclxubGV0IGNvdW50X2V4aXRlZF9wYWdlOiBudW1iZXIgPSAwXHJcblxyXG5mdW5jdGlvbiBhc3NlcnQoY29uZGl0aW9uLCBtZXNzYWdlKSB7XHJcbiAgICBpZiAoIWNvbmRpdGlvbikge1xyXG4gICAgICAgIHRocm93IG1lc3NhZ2UgfHwgXCJBc3NlcnRpb24gZmFpbGVkXCI7XHJcbiAgICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHJlZ2lzdGVyQW5zd2VyT25seVVzZXJTZWxlY3Rpb24odXNlcl9jaG9pY2U6IG51bWJlcikge1xyXG4gICAgdXNlcnNlbGVjdGlvbl9hbnN3ZXJvbmx5ID0gdXNlcl9jaG9pY2VcclxuXHJcbiAgICAkKFwiI2J1dHRvbl9hbnN3ZXJvbmx5X3VzZXJ0cnVzdHNcIikuYXR0cihcImRpc2FibGVkXCIsIFwidHJ1ZVwiKVxyXG4gICAgJChcIiNidXR0b25fYW5zd2Vyb25seV91c2VyZGlzdHJ1c3RzXCIpLmF0dHIoXCJkaXNhYmxlZFwiLCBcInRydWVcIilcclxuICAgICQoXCIjYnV0dG9uX2Fuc3dlcm9ubHlfdXNlcnVuc3VyZVwiKS5hdHRyKFwiZGlzYWJsZWRcIiwgXCJ0cnVlXCIpXHJcbiAgICBpZiAodXNlcl9jaG9pY2UgPT0gMCkge1xyXG4gICAgICAgICQoXCIjYnV0dG9uX2Fuc3dlcm9ubHlfdXNlcnRydXN0c1wiKS5hdHRyKFwiYWN0aXZlZGVjaXNpb25cIiwgXCJ0cnVlXCIpXHJcbiAgICB9IGVsc2UgaWYgKHVzZXJfY2hvaWNlID09IDEpIHtcclxuICAgICAgICAkKFwiI2J1dHRvbl9hbnN3ZXJvbmx5X3VzZXJkaXN0cnVzdHNcIikuYXR0cihcImFjdGl2ZWRlY2lzaW9uXCIsIFwidHJ1ZVwiKVxyXG4gICAgfSBlbHNlIGlmICh1c2VyX2Nob2ljZSA9PSAyKSB7XHJcbiAgICAgICAgJChcIiNidXR0b25fYW5zd2Vyb25seV91c2VydW5zdXJlXCIpLmF0dHIoXCJhY3RpdmVkZWNpc2lvblwiLCBcInRydWVcIilcclxuICAgIH1cclxuICAgICQoXCIjYWlfZXhwbGFuYXRpb25fZGl2XCIpLnNob3coKVxyXG59XHJcbi8vIEV2ZW50IGxpc3RlbmVyIGZvciB0aGUgYnV0dG9uIGNsaWNrXHJcbmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdidXR0b25fYW5zd2Vyb25seV91c2VydHJ1c3RzJyk/LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gcmVnaXN0ZXJBbnN3ZXJPbmx5VXNlclNlbGVjdGlvbigwKSk7XHJcbmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdidXR0b25fYW5zd2Vyb25seV91c2VyZGlzdHJ1c3RzJyk/LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gcmVnaXN0ZXJBbnN3ZXJPbmx5VXNlclNlbGVjdGlvbigxKSk7XHJcbmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdidXR0b25fYW5zd2Vyb25seV91c2VydW5zdXJlJyk/LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gcmVnaXN0ZXJBbnN3ZXJPbmx5VXNlclNlbGVjdGlvbigyKSk7XHJcblxyXG5cclxuZnVuY3Rpb24gcmVnaXN0ZXJXaXRoRXhwbGFuYXRpb25Vc2VyU2VsZWN0aW9uKHVzZXJfY2hvaWNlOiBudW1iZXIpIHtcclxuICAgIHVzZXJzZWxlY3Rpb25fd2l0aGV4cGxhbmF0aW9uID0gdXNlcl9jaG9pY2VcclxuXHJcbiAgICAkKFwiI2J1dHRvbl93aXRoZXhwbGFuYXRpb25fdXNlcnRydXN0c1wiKS5hdHRyKFwiZGlzYWJsZWRcIiwgXCJ0cnVlXCIpXHJcbiAgICAkKFwiI2J1dHRvbl93aXRoZXhwbGFuYXRpb25fdXNlcmRpc3RydXN0c1wiKS5hdHRyKFwiZGlzYWJsZWRcIiwgXCJ0cnVlXCIpXHJcbiAgICAkKFwiI2J1dHRvbl93aXRoZXhwbGFuYXRpb25fdXNlcnVuc3VyZVwiKS5hdHRyKFwiZGlzYWJsZWRcIiwgXCJ0cnVlXCIpXHJcbiAgICBpZiAodXNlcl9jaG9pY2UgPT0gMCkge1xyXG4gICAgICAgICQoXCIjYnV0dG9uX3dpdGhleHBsYW5hdGlvbl91c2VydHJ1c3RzXCIpLmF0dHIoXCJhY3RpdmVkZWNpc2lvblwiLCBcInRydWVcIilcclxuICAgIH0gZWxzZSBpZiAodXNlcl9jaG9pY2UgPT0gMSkge1xyXG4gICAgICAgICQoXCIjYnV0dG9uX3dpdGhleHBsYW5hdGlvbl91c2VyZGlzdHJ1c3RzXCIpLmF0dHIoXCJhY3RpdmVkZWNpc2lvblwiLCBcInRydWVcIilcclxuICAgIH0gZWxzZSBpZiAodXNlcl9jaG9pY2UgPT0gMikge1xyXG4gICAgICAgICQoXCIjYnV0dG9uX3dpdGhleHBsYW5hdGlvbl91c2VydW5zdXJlXCIpLmF0dHIoXCJhY3RpdmVkZWNpc2lvblwiLCBcInRydWVcIilcclxuICAgIH1cclxuICAgICQoXCIjYWlfZXhwbGFuYXRpb25fcXVhbGl0eV9kaXZcIikuc2hvdygpXHJcbn1cclxuXHJcbmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdidXR0b25fd2l0aGV4cGxhbmF0aW9uX3VzZXJ0cnVzdHMnKT8uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiByZWdpc3RlcldpdGhFeHBsYW5hdGlvblVzZXJTZWxlY3Rpb24oMCkpO1xyXG5kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYnV0dG9uX3dpdGhleHBsYW5hdGlvbl91c2VyZGlzdHJ1c3RzJyk/LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gcmVnaXN0ZXJXaXRoRXhwbGFuYXRpb25Vc2VyU2VsZWN0aW9uKDEpKTtcclxuZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2J1dHRvbl93aXRoZXhwbGFuYXRpb25fdXNlcnVuc3VyZScpPy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHJlZ2lzdGVyV2l0aEV4cGxhbmF0aW9uVXNlclNlbGVjdGlvbigyKSk7XHJcbiAgXHJcbmZ1bmN0aW9uIHJlZ2lzdGVyV2l0aEV4cGxhbmF0aW9uUXVhbGl0eVVzZXJTZWxlY3Rpb24odXNlcl9jaG9pY2U6IG51bWJlcikge1xyXG4gICAgdXNlcnNlbGVjdGlvbl93aXRoZXhwbGFuYXRpb25xdWFsaXR5ID0gdXNlcl9jaG9pY2VcclxuXHJcbiAgICAkKFwiI2J1dHRvbl93aXRoZXhwbGFuYXRpb25xdWFsaXR5X3VzZXJ0cnVzdHNcIikuYXR0cihcImRpc2FibGVkXCIsIFwidHJ1ZVwiKVxyXG4gICAgJChcIiNidXR0b25fd2l0aGV4cGxhbmF0aW9ucXVhbGl0eV91c2VyZGlzdHJ1c3RzXCIpLmF0dHIoXCJkaXNhYmxlZFwiLCBcInRydWVcIilcclxuICAgICQoXCIjYnV0dG9uX3dpdGhleHBsYW5hdGlvbnF1YWxpdHlfdXNlcnVuc3VyZVwiKS5hdHRyKFwiZGlzYWJsZWRcIiwgXCJ0cnVlXCIpXHJcbiAgICBpZiAodXNlcl9jaG9pY2UgPT0gMCkge1xyXG4gICAgICAgICQoXCIjYnV0dG9uX3dpdGhleHBsYW5hdGlvbnF1YWxpdHlfdXNlcnRydXN0c1wiKS5hdHRyKFwiYWN0aXZlZGVjaXNpb25cIiwgXCJ0cnVlXCIpXHJcbiAgICB9IGVsc2UgaWYgKHVzZXJfY2hvaWNlID09IDEpIHtcclxuICAgICAgICAkKFwiI2J1dHRvbl93aXRoZXhwbGFuYXRpb25xdWFsaXR5X3VzZXJkaXN0cnVzdHNcIikuYXR0cihcImFjdGl2ZWRlY2lzaW9uXCIsIFwidHJ1ZVwiKVxyXG4gICAgfSBlbHNlIGlmICh1c2VyX2Nob2ljZSA9PSAyKSB7XHJcbiAgICAgICAgJChcIiNidXR0b25fd2l0aGV4cGxhbmF0aW9ucXVhbGl0eV91c2VydW5zdXJlXCIpLmF0dHIoXCJhY3RpdmVkZWNpc2lvblwiLCBcInRydWVcIilcclxuICAgIH1cclxuICAgICQoXCIjYnV0dG9uX25leHRcIikuc2hvdygpXHJcbiAgICAkKFwiI2J1dHRvbl9uZXh0XCIpLnJlbW92ZUF0dHIoXCJkaXNhYmxlZFwiKVxyXG59XHJcblxyXG5kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYnV0dG9uX3dpdGhleHBsYW5hdGlvbnF1YWxpdHlfdXNlcnRydXN0cycpPy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHJlZ2lzdGVyV2l0aEV4cGxhbmF0aW9uUXVhbGl0eVVzZXJTZWxlY3Rpb24oMCkpO1xyXG5kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYnV0dG9uX3dpdGhleHBsYW5hdGlvbnF1YWxpdHlfdXNlcmRpc3RydXN0cycpPy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHJlZ2lzdGVyV2l0aEV4cGxhbmF0aW9uUXVhbGl0eVVzZXJTZWxlY3Rpb24oMSkpO1xyXG5kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYnV0dG9uX3dpdGhleHBsYW5hdGlvbnF1YWxpdHlfdXNlcnVuc3VyZScpPy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHJlZ2lzdGVyV2l0aEV4cGxhbmF0aW9uUXVhbGl0eVVzZXJTZWxlY3Rpb24oMikpO1xyXG5cclxuXHJcblxyXG5cclxuZnVuY3Rpb24gbmV4dF9pbnN0cnVjdGlvbnMoaW5jcmVtZW50OiBudW1iZXIpIHtcclxuICAgIGluc3RydWN0aW9uX2kgKz0gaW5jcmVtZW50XHJcblxyXG4gICAgaWYgKGluc3RydWN0aW9uX2kgPT0gMCkge1xyXG4gICAgICAgICQoXCIjYnV0dG9uX2luc3RydWN0aW9uc19wcmV2XCIpLmF0dHIoXCJkaXNhYmxlZFwiLCBcInRydWVcIilcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgJChcIiNidXR0b25faW5zdHJ1Y3Rpb25zX3ByZXZcIikucmVtb3ZlQXR0cihcImRpc2FibGVkXCIpXHJcbiAgICB9XHJcbiAgICBpZiAoaW5zdHJ1Y3Rpb25faSA+PSA1KSB7XHJcbiAgICAgICAgJChcIiNpbnN0cnVjdGlvbnNfYW5kX2RlY29yYXRpb25zXCIpLnNob3coKVxyXG4gICAgICAgICQoXCIjYnV0dG9uX2luc3RydWN0aW9uc19uZXh0XCIpLnZhbChcIlN0YXJ0IHN0dWR5XCIpXHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgICQoXCIjaW5zdHJ1Y3Rpb25zX2FuZF9kZWNvcmF0aW9uc1wiKS5oaWRlKClcclxuICAgICAgICAkKFwiI2J1dHRvbl9pbnN0cnVjdGlvbnNfbmV4dFwiKS52YWwoXCJOZXh0XCIpXHJcbiAgICB9XHJcbiAgICBpZiAoaW5zdHJ1Y3Rpb25faSA9PSA2KSB7XHJcbiAgICAgICAgJChcIiNpbnN0cnVjdGlvbnNfYW5kX2RlY29yYXRpb25zXCIpLnNob3coKVxyXG4gICAgICAgICQoXCIjbWFpbl9ib3hfaW5zdHJ1Y3Rpb25zXCIpLmhpZGUoKVxyXG4gICAgICAgICQoXCIjbWFpbl9ib3hfZXhwZXJpbWVudFwiKS5zaG93KClcclxuICAgICAgICBuZXh0X3F1ZXN0aW9uKClcclxuICAgIH1cclxuXHJcbiAgICAkKFwiI21haW5fYm94X2luc3RydWN0aW9uc1wiKS5jaGlsZHJlbihcIjpub3QoaW5wdXQpXCIpLmVhY2goKF8sIGVsKSA9PiB7XHJcbiAgICAgICAgJChlbCkuaGlkZSgpXHJcbiAgICB9KVxyXG4gICAgJChgI2luc3RydWN0aW9uc18ke2luc3RydWN0aW9uX2l9YCkuc2hvdygpXHJcbn1cclxuJChcIiNidXR0b25faW5zdHJ1Y3Rpb25zX25leHRcIikub24oXCJjbGlja1wiLCAoKSA9PiBuZXh0X2luc3RydWN0aW9ucygrMSkpXHJcbiQoXCIjYnV0dG9uX2luc3RydWN0aW9uc19wcmV2XCIpLm9uKFwiY2xpY2tcIiwgKCkgPT4gbmV4dF9pbnN0cnVjdGlvbnMoLTEpKVxyXG5cclxuJChcIiNidXR0b25fbmV4dFwiKS5vbihcImNsaWNrXCIsICgpID0+IHtcclxuXHJcbiAgICAvLyBVcGRhdGUgdGhlIHVzZXIgYmFsYW5jZVxyXG4gICAgbGV0IG9sZF9iYWxhbmNlID0gYmFsYW5jZVxyXG4gICAgdXBkYXRlX2JhbGFuY2UoKVxyXG5cclxuICAgIGlmIChxdWVzdGlvbl9pICE9IC0xKSB7XHJcbiAgICAgICAgbGV0IGxvZ2dlZF9kYXRhID0ge1xyXG4gICAgICAgICAgICBcInF1ZXN0aW9uX2lcIjogcXVlc3Rpb25faSxcclxuICAgICAgICAgICAgXCJ1c2VyX3NlbGVjdGlvbnNcIjoge1xyXG4gICAgICAgICAgICAgICAgXCJhbnN3ZXJvbmx5XCI6IHVzZXJzZWxlY3Rpb25fYW5zd2Vyb25seSxcclxuICAgICAgICAgICAgICAgIFwid2l0aGV4cGxhbmF0aW9uXCI6IHVzZXJzZWxlY3Rpb25fd2l0aGV4cGxhbmF0aW9uLFxyXG4gICAgICAgICAgICAgICAgXCJ3aXRoZXhwbGFuYXRpb25xdWFsaXR5XCI6IHVzZXJzZWxlY3Rpb25fd2l0aGV4cGxhbmF0aW9ucXVhbGl0eVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBcInVzZXJfaXNfY29ycmVjdFwiOiB7XHJcbiAgICAgICAgICAgICAgICBcImFuc3dlcm9ubHlcIjogaXNfdXNlcl9jb3JyZWN0KHVzZXJzZWxlY3Rpb25fYW5zd2Vyb25seSksXHJcbiAgICAgICAgICAgICAgICBcIndpdGhleHBsYW5hdGlvblwiOiBpc191c2VyX2NvcnJlY3QodXNlcnNlbGVjdGlvbl93aXRoZXhwbGFuYXRpb24pLFxyXG4gICAgICAgICAgICAgICAgXCJ3aXRoZXhwbGFuYXRpb25xdWFsaXR5XCI6IGlzX3VzZXJfY29ycmVjdCh1c2Vyc2VsZWN0aW9uX3dpdGhleHBsYW5hdGlvbnF1YWxpdHkpXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIFwiYmFsYW5jZVwiOiB7XHJcbiAgICAgICAgICAgICAgICBcIm9sZFwiOiBvbGRfYmFsYW5jZSxcclxuICAgICAgICAgICAgICAgIFwibmV3XCI6IGJhbGFuY2VcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgbG9nZ2VkX2RhdGFbJ3F1ZXN0aW9uJ10gPSBxdWVzdGlvblxyXG4gICAgICAgIGxvZ2dlZF9kYXRhWydjb3VudF9leGl0ZWRfcGFnZSddID0gY291bnRfZXhpdGVkX3BhZ2VcclxuICAgICAgICBsb2dfZGF0YShsb2dnZWRfZGF0YSlcclxuICAgICAgICBjb3VudF9leGl0ZWRfcGFnZSA9IDBcclxuICAgIH1cclxuICAgIFxyXG5cclxuICAgIG5leHRfcXVlc3Rpb24oKVxyXG59KTtcclxuXHJcblxyXG5cclxuZnVuY3Rpb24gaXNfdXNlcl9jb3JyZWN0KHNlbGVjdGlvbikge1xyXG4gICAgaWYgKHNlbGVjdGlvbiAhPSAyKSB7XHJcbiAgICAgICAgbGV0IGNvcnJlY3Rfc2VsZWN0aW9uID0gMSAtIHF1ZXN0aW9uW1wicHJlZGljdGlvbl9pc19jb3JyZWN0XCJdIC8vIDAgaWYgQUkgaXMgY29ycmVjdCwgMSBpZiBpbmNvcnJlY3RcclxuICAgICAgICByZXR1cm4gc2VsZWN0aW9uID09IGNvcnJlY3Rfc2VsZWN0aW9uID8gMSA6IDBcclxuICAgIH1cclxuICAgIHJldHVybiAtMVxyXG59XHJcblxyXG5mdW5jdGlvbiB1cGRhdGVfYmFsYW5jZSgpIHtcclxuICAgIGlmICh1c2Vyc2VsZWN0aW9uX3dpdGhleHBsYW5hdGlvbnF1YWxpdHkgIT0gMikge1xyXG4gICAgICAgIGxldCBjb3JyZWN0X3NlbGVjdGlvbiA9IDEgLSBxdWVzdGlvbltcInByZWRpY3Rpb25faXNfY29ycmVjdFwiXSAvLyAwIGlmIEFJIGlzIGNvcnJlY3QsIDEgaWYgaW5jb3JyZWN0XHJcbiAgICAgICAgaWYgKHVzZXJzZWxlY3Rpb25fd2l0aGV4cGxhbmF0aW9ucXVhbGl0eSA9PSBjb3JyZWN0X3NlbGVjdGlvbikge1xyXG4gICAgICAgICAgICBiYWxhbmNlICs9IGJhbGFuY2VfaW5jcmVtZW50XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiBuZXh0X3F1ZXN0aW9uKCkge1xyXG4gICAgLy8gcmVzdG9yZSBwcmV2aW91cyBzdGF0ZSBvZiBVSVxyXG5cclxuICAgICQoXCIjYnV0dG9uX3JlYWR5dG9hbnN3ZXJcIikucmVtb3ZlQXR0cihcImFjdGl2ZWRlY2lzaW9uXCIpXHJcbiAgICAkKFwiI2J1dHRvbl9yZWFkeXRvYW5zd2VyXCIpLnJlbW92ZUF0dHIoXCJkaXNhYmxlZFwiKVxyXG4gICAgJChcIiNidXR0b25fcmVhZHl0b2Fuc3dlclwiKS5zaG93KClcclxuXHJcbiAgICAkKFwiI2J1dHRvbl9hbnN3ZXJvbmx5X3VzZXJ0cnVzdHNcIikucmVtb3ZlQXR0cihcImFjdGl2ZWRlY2lzaW9uXCIpXHJcbiAgICAkKFwiI2J1dHRvbl9hbnN3ZXJvbmx5X3VzZXJ0cnVzdHNcIikucmVtb3ZlQXR0cihcImRpc2FibGVkXCIpXHJcbiAgICAkKFwiI2J1dHRvbl9hbnN3ZXJvbmx5X3VzZXJkaXN0cnVzdHNcIikucmVtb3ZlQXR0cihcImFjdGl2ZWRlY2lzaW9uXCIpXHJcbiAgICAkKFwiI2J1dHRvbl9hbnN3ZXJvbmx5X3VzZXJkaXN0cnVzdHNcIikucmVtb3ZlQXR0cihcImRpc2FibGVkXCIpXHJcbiAgICAkKFwiI2J1dHRvbl9hbnN3ZXJvbmx5X3VzZXJ1bnN1cmVcIikucmVtb3ZlQXR0cihcImFjdGl2ZWRlY2lzaW9uXCIpXHJcbiAgICAkKFwiI2J1dHRvbl9hbnN3ZXJvbmx5X3VzZXJ1bnN1cmVcIikucmVtb3ZlQXR0cihcImRpc2FibGVkXCIpXHJcblxyXG4gICAgJChcIiNidXR0b25fd2l0aGV4cGxhbmF0aW9uX3VzZXJ0cnVzdHNcIikucmVtb3ZlQXR0cihcImFjdGl2ZWRlY2lzaW9uXCIpXHJcbiAgICAkKFwiI2J1dHRvbl93aXRoZXhwbGFuYXRpb25fdXNlcnRydXN0c1wiKS5yZW1vdmVBdHRyKFwiZGlzYWJsZWRcIilcclxuICAgICQoXCIjYnV0dG9uX3dpdGhleHBsYW5hdGlvbl91c2VyZGlzdHJ1c3RzXCIpLnJlbW92ZUF0dHIoXCJhY3RpdmVkZWNpc2lvblwiKVxyXG4gICAgJChcIiNidXR0b25fd2l0aGV4cGxhbmF0aW9uX3VzZXJkaXN0cnVzdHNcIikucmVtb3ZlQXR0cihcImRpc2FibGVkXCIpXHJcbiAgICAkKFwiI2J1dHRvbl93aXRoZXhwbGFuYXRpb25fdXNlcnVuc3VyZVwiKS5yZW1vdmVBdHRyKFwiYWN0aXZlZGVjaXNpb25cIilcclxuICAgICQoXCIjYnV0dG9uX3dpdGhleHBsYW5hdGlvbl91c2VydW5zdXJlXCIpLnJlbW92ZUF0dHIoXCJkaXNhYmxlZFwiKVxyXG5cclxuICAgICQoXCIjYnV0dG9uX3dpdGhleHBsYW5hdGlvbnF1YWxpdHlfdXNlcnRydXN0c1wiKS5yZW1vdmVBdHRyKFwiYWN0aXZlZGVjaXNpb25cIilcclxuICAgICQoXCIjYnV0dG9uX3dpdGhleHBsYW5hdGlvbnF1YWxpdHlfdXNlcnRydXN0c1wiKS5yZW1vdmVBdHRyKFwiZGlzYWJsZWRcIilcclxuICAgICQoXCIjYnV0dG9uX3dpdGhleHBsYW5hdGlvbnF1YWxpdHlfdXNlcmRpc3RydXN0c1wiKS5yZW1vdmVBdHRyKFwiYWN0aXZlZGVjaXNpb25cIilcclxuICAgICQoXCIjYnV0dG9uX3dpdGhleHBsYW5hdGlvbnF1YWxpdHlfdXNlcmRpc3RydXN0c1wiKS5yZW1vdmVBdHRyKFwiZGlzYWJsZWRcIilcclxuICAgICQoXCIjYnV0dG9uX3dpdGhleHBsYW5hdGlvbnF1YWxpdHlfdXNlcnVuc3VyZVwiKS5yZW1vdmVBdHRyKFwiYWN0aXZlZGVjaXNpb25cIilcclxuICAgICQoXCIjYnV0dG9uX3dpdGhleHBsYW5hdGlvbnF1YWxpdHlfdXNlcnVuc3VyZVwiKS5yZW1vdmVBdHRyKFwiZGlzYWJsZWRcIilcclxuXHJcbiAgICAkKFwiI2FpX2V4cGxhbmF0aW9uX2RpdlwiKS5oaWRlKClcclxuICAgICQoXCIjYWlfZXhwbGFuYXRpb25fcXVhbGl0eV9kaXZcIikuaGlkZSgpXHJcbiAgICBcclxuXHJcbiAgICAkKFwiI2J1dHRvbl9uZXh0XCIpLmhpZGUoKVxyXG4gICAgJCgnI2J1dHRvbl9xdWl0JykuaGlkZSgpXHJcbiAgICAvLyQoXCIjcmFuZ2VfdmFsXCIpLnZhbCh1c2VyX3RydXN0KVxyXG5cclxuICAgIHF1ZXN0aW9uX2kgKz0gMTtcclxuICAgIGlmIChxdWVzdGlvbl9pID49IGRhdGEubGVuZ3RoKSB7XHJcbiAgICAgICAgLy8gSGlkZSB0aGUgZXhwZXJpbWVudCBjb250YWluZXIuXHJcbiAgICAgICAgJChcIiNtYWluX2JveF9leHBlcmltZW50XCIpLmhpZGUoKTtcclxuICAgICAgICAkKFwiI3F1YWxpdGF0aXZlX3NlY3Rpb25cIikuc2hvdygpO1xyXG4gICAgICAgIHJldHVybjtcclxuICAgIH1cclxuXHJcbiAgICBcclxuICAgIC8vIFJldHJpZXZlIHRoZSBjdXJyZW50IHF1ZXN0aW9uIG9iamVjdC5cclxuICAgIHF1ZXN0aW9uID0gZGF0YVtxdWVzdGlvbl9pXTtcclxuICAgIFxyXG4gICAgLy8gQWx3YXlzIHNob3cgUGFydCAxIGFuZCBoaWRlIFBhcnQgMiB3aGVuIGEgbmV3IHF1ZXN0aW9uIGxvYWRzLlxyXG4gICAgJChcIiNwYXJ0MVwiKS5zaG93KCk7XHJcbiAgICAkKFwiI3BhcnQyXCIpLmhpZGUoKTtcclxuICAgIFxyXG4gICAgLy8gLS0tIFVwZGF0ZSBQYXJ0IDEgZWxlbWVudHMgLS0tXHJcbiAgICAvLyBGb3IgdGhlIGltYWdlOiBhc3N1bWUgYSB2YWxpZCBCYXNlNjQgc3RyaW5nIGZvciBub3cuXHJcbiAgICBpZiAocXVlc3Rpb25bXCJpbWFnZVwiXSkge1xyXG4gICAgICAkKFwiI3F1ZXN0aW9uX2ltYWdlXCIpLmF0dHIoXCJzcmNcIiwgXCJkYXRhOmltYWdlL3BuZztiYXNlNjQsXCIgKyBxdWVzdGlvbltcImltYWdlXCJdKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICQoXCIjcXVlc3Rpb25faW1hZ2VcIikuYXR0cihcInNyY1wiLCBcIlwiKTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8gRGlzcGxheSB0aGUgcHJlZGljdGVkIHRleHQuXHJcbiAgICAvLyBCdWlsZCB0aGUgcHJlZGljdGVkIHRleHQgSFRNTCBieSBjb25jYXRlbmF0aW5nIHRva2VuX2luZm9cclxuICAgIGxldCBwcmVkaWN0ZWRIdG1sID0gXCJcIjtcclxuICAgIGlmIChxdWVzdGlvbltcInRva2VuX2luZm9cIl0gJiYgQXJyYXkuaXNBcnJheShxdWVzdGlvbltcInRva2VuX2luZm9cIl0pKSB7XHJcbiAgICAgICAgcHJlZGljdGVkSHRtbCA9IHF1ZXN0aW9uW1widG9rZW5faW5mb1wiXVxyXG4gICAgICAgICAgICAvLyBTa2lwIHRoZSBlbmQgdG9rZW5cclxuICAgICAgICAgICAgLmZpbHRlcihpdGVtID0+IGl0ZW0udG9rZW4gIT09IFwiPHxpbV9lbmR8PlwiKVxyXG4gICAgICAgICAgICAubWFwKGl0ZW0gPT4ge1xyXG4gICAgICAgICAgICAgICAgLy8gUmVwbGFjZSB0aGUgc3BlY2lhbCBcIsSgXCIgY2hhcmFjdGVyIHdpdGggYSBzcGFjZVxyXG4gICAgICAgICAgICAgICAgbGV0IHRva2VuVGV4dCA9IGl0ZW0udG9rZW4ucmVwbGFjZSgvxKAvZywgXCIgXCIpO1xyXG4gICAgICAgICAgICAgICAgLy8gR2V0IHRoZSBwcm9iYWJpbGl0eSBmcm9tIHRoZSBmaXJzdCBjYW5kaWRhdGUgaW4gdG9wXzVfdG9rZW5zLlxyXG4gICAgICAgICAgICAgICAgLy8gSWYgbm90IGF2YWlsYWJsZSwgZGVmYXVsdCB0byAxIChubyBoaWdobGlnaHQpLlxyXG4gICAgICAgICAgICAgICAgbGV0IHByb2IgPSAoaXRlbS50b3BfNV90b2tlbnMgJiZcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW0udG9wXzVfdG9rZW5zWzBdICYmXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlb2YgaXRlbS50b3BfNV90b2tlbnNbMF0ucHJvYmFiaWxpdHkgPT09IFwibnVtYmVyXCIpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IGl0ZW0udG9wXzVfdG9rZW5zWzBdLnByb2JhYmlsaXR5XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IDE7XHJcbiAgICAgICAgICAgICAgICAvLyBDb21wdXRlIHRoZSBoaWdobGlnaHQgaW50ZW5zaXR5ICgwIGlmIHByb2JhYmlsaXR5IGlzIDEsIDEgaWYgcHJvYmFiaWxpdHkgaXMgMClcclxuICAgICAgICAgICAgICAgIGxldCBpbnRlbnNpdHkgPSAxIC0gcHJvYjtcclxuICAgICAgICAgICAgICAgIC8vIENyZWF0ZSBhIHNwYW4gd2l0aCByZWQgYmFja2dyb3VuZDsgYWRqdXN0IHRoZSBvcGFjaXR5IGJ5IGludGVuc2l0eS5cclxuICAgICAgICAgICAgICAgIGlmIChxdWVzdGlvbltcImlzX2hpZ2hsaWdodGVkXCJdID09IDEpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYDxzcGFuIHN0eWxlPVwiYmFja2dyb3VuZC1jb2xvcjogcmdiYSgyNTUsIDAsIDAsICR7aW50ZW5zaXR5fSk7XCI+JHt0b2tlblRleHR9PC9zcGFuPmA7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0b2tlblRleHQ7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5qb2luKCcnKTtcclxuICAgIH1cclxuICAgICQoXCIjcHJlZGljdGVkX3RleHRcIikuaHRtbChwcmVkaWN0ZWRIdG1sKTtcclxuXHJcbiAgICBpZiAocXVlc3Rpb25bXCJpc19oaWdobGlnaHRlZFwiXSA9PSAxKSB7XHJcbiAgICAgICAgJChcIiNwcmVkaWN0ZWRfdGV4dF9jb250YWluZXIgc3Ryb25nXCIpLmFkZENsYXNzKFwiaGlnaGxpZ2h0ZWQtdGl0bGVcIik7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgJChcIiNwcmVkaWN0ZWRfdGV4dF9jb250YWluZXIgc3Ryb25nXCIpLnJlbW92ZUNsYXNzKFwiaGlnaGxpZ2h0ZWQtdGl0bGVcIik7XHJcbiAgICAgIH1cclxuICAgICAgXHJcbiAgICBcclxuICAgIC8vIENvbmNhdGVuYXRlIHRva2VucyAod2l0aCByZXBsYWNlbWVudCBvZiDEoCBhbmQgc2tpcHBpbmcgPHxpbV9lbmR8PikuXHJcbiAgICBsZXQgdG9rZW5zQ29uY2F0ZW5hdGVkID0gXCJcIjtcclxuICAgIGlmIChxdWVzdGlvbltcInRva2VuX2luZm9cIl0gJiYgQXJyYXkuaXNBcnJheShxdWVzdGlvbltcInRva2VuX2luZm9cIl0pKSB7XHJcbiAgICAgICAgdG9rZW5zQ29uY2F0ZW5hdGVkID0gcXVlc3Rpb25bXCJ0b2tlbl9pbmZvXCJdXHJcbiAgICAgICAgICAubWFwKGl0ZW0gPT4gaXRlbS50b2tlbilcclxuICAgICAgICAgIC5maWx0ZXIodG9rZW4gPT4gdG9rZW4gIT09IFwiPHxpbV9lbmR8PlwiKVxyXG4gICAgICAgICAgLm1hcCh0b2tlbiA9PiB0b2tlbi5yZXBsYWNlKC/EoC9nLCBcIiBcIikpXHJcbiAgICAgICAgICAuam9pbignJyk7XHJcbiAgICB9XHJcbiAgICAkKFwiI3Rva2VuX2lucHV0XCIpLnZhbCh0b2tlbnNDb25jYXRlbmF0ZWQpO1xyXG4gICAgXHJcbiAgICAvLyAoVXBkYXRlIHByb2dyZXNzIGFuZCBvdGhlciBlbGVtZW50cyBhcyBuZWNlc3NhcnkpXHJcbiAgICAkKFwiI3Byb2dyZXNzXCIpLnRleHQoYFByb2dyZXNzOiAke3F1ZXN0aW9uX2kgKyAxfSAvICR7ZGF0YS5sZW5ndGh9YCk7XHJcblxyXG4gICAgLy8gU3RhcnQgYSAyMC1zZWNvbmQgdGltZXIgZm9yIFBhcnQgMVxyXG4gICAgLy8gQ2xlYXIgYW55IGV4aXN0aW5nIHRpbWVyIChqdXN0IGluIGNhc2UpXHJcbiAgICBjbGVhclRpbWVvdXQocGFydDFUaW1lcik7XHJcbiAgICBwYXJ0MVRpbWVyID0gd2luZG93LnNldFRpbWVvdXQoYXV0b1N1Ym1pdFBhcnQxLCAyMDAwMCk7XHJcbiAgICAvLyBSZXNldCBhbmQgc3RhcnQgdGhlIHRpbWVyIGZvciBQYXJ0IDFcclxuICAgIHJlbWFpbmluZ1RpbWUgPSAyMDtcclxuICAgICQoXCIjdGltZXJcIikudGV4dChyZW1haW5pbmdUaW1lKTtcclxuICAgICQoXCIjdGltZXJcIikuc2hvdygpO1xyXG5cclxuICAgIC8vIENsZWFyIGFueSBwcmV2aW91cyBpbnRlcnZhbFxyXG4gICAgaWYgKHBhcnQxSW50ZXJ2YWwpIHtcclxuICAgICAgICBjbGVhckludGVydmFsKHBhcnQxSW50ZXJ2YWwpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFN0YXJ0IGEgbmV3IGludGVydmFsIHRoYXQgY291bnRzIGRvd24gZXZlcnkgc2Vjb25kXHJcbiAgICBwYXJ0MUludGVydmFsID0gd2luZG93LnNldEludGVydmFsKCgpID0+IHtcclxuICAgICAgICByZW1haW5pbmdUaW1lIC09IDE7XHJcbiAgICAgICAgJChcIiN0aW1lclwiKS50ZXh0KHJlbWFpbmluZ1RpbWUpO1xyXG4gICAgICAgIGlmIChyZW1haW5pbmdUaW1lIDw9IDApIHtcclxuICAgICAgICAgICAgY2xlYXJJbnRlcnZhbChwYXJ0MUludGVydmFsKTtcclxuICAgICAgICAgICAgLy8gQXV0by1zdWJtaXQgUGFydCAxIGlmIHRpbWUgZXhwaXJlc1xyXG4gICAgICAgICAgICBhdXRvU3VibWl0UGFydDEoKTtcclxuICAgICAgICAgICAgJChcIiN0aW1lclwiKS5oaWRlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfSwgMTAwMCk7XHJcblxyXG5cclxufVxyXG5cclxuLy8gZ2V0IHVzZXIgaWQgYW5kIGxvYWQgcXVldWVcclxuLy8gdHJ5IHRvIHNlZSBpZiBzdGFydCBvdmVycmlkZSB3YXMgcGFzc2VkXHJcbmNvbnN0IHVybFBhcmFtcyA9IG5ldyBVUkxTZWFyY2hQYXJhbXMod2luZG93LmxvY2F0aW9uLnNlYXJjaCk7XHJcbmNvbnN0IHN0YXJ0T3ZlcnJpZGUgPSB1cmxQYXJhbXMuZ2V0KCdzdGFydCcpO1xyXG5jb25zdCBVSURGcm9tVVJMID0gdXJsUGFyYW1zLmdldChcInVpZFwiKVxyXG5nbG9iYWxUaGlzLnVybF9kYXRhID0gcGFyYW1zVG9PYmplY3QodXJsUGFyYW1zLmVudHJpZXMoKSlcclxuXHJcbmlmIChnbG9iYWxUaGlzLnVybF9kYXRhWydzdHVkeV9pZCddID09IG51bGwpIHtcclxuICAgIGdsb2JhbFRoaXMudXJsX2RhdGFbJ3N0dWR5X2lkJ10gPSBcImRlbW9fc3R1ZHlcIlxyXG59XHJcbmlmIChnbG9iYWxUaGlzLnVybF9kYXRhWydwcm9saWZpY19pZCddID09IG51bGwpIHtcclxuICAgIGdsb2JhbFRoaXMudXJsX2RhdGFbJ3Byb2xpZmljX2lkJ10gPSBcImRlbW9fdXNlclwiXHJcbn1cclxuaWYgKGdsb2JhbFRoaXMudXJsX2RhdGFbJ3Nlc3Npb25faWQnXSA9PSBudWxsKSB7XHJcbiAgICBnbG9iYWxUaGlzLnVybF9kYXRhWydzZXNzaW9uX2lkJ10gPSBcImRlbW9fc2Vzc2lvblwiXHJcbn1cclxuXHJcbmlmIChVSURGcm9tVVJMICE9IG51bGwpIHtcclxuICAgIGdsb2JhbFRoaXMudWlkID0gVUlERnJvbVVSTCBhcyBzdHJpbmdcclxuICAgIGlmIChnbG9iYWxUaGlzLnVpZCA9PSBcInByb2xpZmljX3JhbmRvbVwiKSB7XHJcbiAgICAgICAgbGV0IHF1ZXVlX2lkID0gYCR7TWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTApfWAucGFkU3RhcnQoMywgXCIwXCIpXHJcbiAgICAgICAgZ2xvYmFsVGhpcy51aWQgPSBgJHt1cmxQYXJhbXMuZ2V0KFwicHJvbGlmaWNfcXVldWVfbmFtZVwiKX0vJHtxdWV1ZV9pZH1gXHJcbiAgICB9XHJcbn0gZWxzZSBpZiAoREVWTU9ERSkge1xyXG4gICAgZ2xvYmFsVGhpcy51aWQgPSBcImRlbW9cIlxyXG59IGVsc2Uge1xyXG4gICAgbGV0IFVJRF9tYXliZTogYW55ID0gbnVsbFxyXG4gICAgd2hpbGUgKFVJRF9tYXliZSA9PSBudWxsKSB7XHJcbiAgICAgICAgVUlEX21heWJlID0gcHJvbXB0KFwiRW50ZXIgeW91ciB1c2VyIGlkLiBQbGVhc2UgZ2V0IGluIHRvdWNoIGlmIHlvdSB3ZXJlIG5vdCBhc3NpZ25lZCBhbiBpZCBidXQgd2lzaCB0byBwYXJ0aWNpcGF0ZSBpbiB0aGlzIGV4cGVyaW1lbnQuXCIpXHJcbiAgICB9XHJcbiAgICBnbG9iYWxUaGlzLnVpZCA9IFVJRF9tYXliZSFcclxufVxyXG5cclxuLy8gdmVyc2lvbiBmb3IgcGFwZXJcclxuaWYgKERFVk1PREUpIHtcclxuICAgIE1PQ0tNT0RFID0gdHJ1ZVxyXG59IGVsc2UgaWYgKGdsb2JhbFRoaXMudXJsX2RhdGFbJ3Nlc3Npb25faWQnXS5zdGFydHNXaXRoKFwiZGVtb1wiKSkge1xyXG4gICAgTU9DS01PREUgPSB0cnVlXHJcbn1cclxuXHJcbmNvbnNvbGUubG9nKFwiUnVubmluZyB3aXRoIFVJRFwiLCBnbG9iYWxUaGlzLnVpZClcclxubG9hZF9kYXRhKCkuY2F0Y2goKF9lcnJvcikgPT4ge1xyXG4gICAgLy9hbGVydChcIkludmFsaWQgdXNlciBpZC5cIilcclxuICAgIGNvbnNvbGUubG9nKFwiSW52YWxpZCB1c2VyIGlkLlwiKVxyXG4gICAgY29uc29sZS5sb2coZ2xvYmFsVGhpcy51aWQhKVxyXG4gICAgd2luZG93LmxvY2F0aW9uLnJlbG9hZCgpXHJcbn1cclxuKS50aGVuKChuZXdfZGF0YSkgPT4ge1xyXG4gICAgZGF0YSA9IG5ld19kYXRhXHJcbiAgICBpZiAoc3RhcnRPdmVycmlkZSAhPSBudWxsKSB7XHJcbiAgICAgICAgcXVlc3Rpb25faSA9IHBhcnNlSW50KHN0YXJ0T3ZlcnJpZGUpIC0gMVxyXG4gICAgICAgIGNvbnNvbGUubG9nKFwiU3RhcnRpbmcgZnJvbVwiLCBxdWVzdGlvbl9pKVxyXG4gICAgfVxyXG4gICAgLy8gbmV4dF9xdWVzdGlvbigpXHJcbiAgICBuZXh0X2luc3RydWN0aW9ucygwKVxyXG4gICAgJChcIiNtYWluX2JveF9pbnN0cnVjdGlvbnNcIikuc2hvdygpXHJcbiAgICAkKFwiI2luc3RydWN0aW9uc19hbmRfZGVjb3JhdGlvbnNcIikuaGlkZSgpXHJcbn0pXHJcblxyXG5jb25zb2xlLmxvZyhcIlN0YXJ0aW5nIHNlc3Npb24gd2l0aCBVSUQ6XCIsIGdsb2JhbFRoaXMudWlkISlcclxuXHJcbmxldCBhbGVydF9hY3RpdmUgPSBmYWxzZVxyXG5kb2N1bWVudC5vbnZpc2liaWxpdHljaGFuZ2UgPSAoKSA9PiB7XHJcbiAgICBpZiAoIWFsZXJ0X2FjdGl2ZSkge1xyXG4gICAgICAgIGNvdW50X2V4aXRlZF9wYWdlICs9IDFcclxuICAgICAgICBhbGVydF9hY3RpdmUgPSB0cnVlXHJcbiAgICAgICAgLy9pZiAoIShnbG9iYWxUaGlzLnVpZCEuc3RhcnRzV2l0aChcImRlbW9cIikpKSB7XHJcbiAgICAgICAgLy8gICAgYWxlcnQoXCJQbGVhc2UgZG9uJ3QgbGVhdmUgdGhlIHBhZ2UuIElmIHlvdSBkbyBzbyBhZ2Fpbiwgd2UgbWF5IHJlc3RyaWN0IHBheWluZyB5b3UuXCIpXHJcbiAgICAgICAgLy99XHJcbiAgICAgICAgYWxlcnRfYWN0aXZlID0gZmFsc2VcclxuICAgIH1cclxufVxyXG5cclxuLy8gV2hlbiB0aGUgRE9NIGlzIHJlYWR5OlxyXG4kKGRvY3VtZW50KS5yZWFkeSgoKSA9PiB7XHJcbiAgICAvLyBUcmFuc2l0aW9uIGZyb20gUGFydCAxIChxdWVzdGlvbikgdG8gUGFydCAyIChjb25maWRlbmNlIHJhdGluZylcclxuICAgICQoXCIjYnV0dG9uX25leHRfcGFydDFcIikub24oXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgIC8vIE9wdGlvbmFsbHksIGxvZyBvciBzYXZlIGFueSBQYXJ0IDEgZGF0YSBoZXJlLlxyXG4gICAgICBjbGVhclRpbWVvdXQocGFydDFUaW1lcik7XHJcbiAgICAgICQoXCIjdGltZXJcIikuaGlkZSgpO1xyXG5cclxuXHJcbiAgICAgICQoXCIjcGFydDFcIikuaGlkZSgpO1xyXG4gICAgICAkKFwiI3BhcnQyXCIpLnNob3coKTtcclxuICAgIH0pO1xyXG4gIFxyXG4gICAgLy8gSGFuZGxlIGNvbmZpZGVuY2UgcmF0aW5nIHNlbGVjdGlvbnM6XHJcbiAgICAkKFwiLmNvbmZpZGVuY2UtYnV0dG9uXCIpLm9uKFwiY2xpY2tcIiwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgbGV0IHJhdGluZyA9IHBhcnNlSW50KCQodGhpcykuYXR0cihcImRhdGEtcmF0aW5nXCIpIGFzIHN0cmluZyk7XHJcbiAgICAgICAgLy8gUmVtb3ZlICdzZWxlY3RlZCcgZnJvbSBhbGwgYnV0dG9ucywgdGhlbiBhZGQgaXQgdG8gdGhlIGNsaWNrZWQgb25lLlxyXG4gICAgICAgICQoXCIuY29uZmlkZW5jZS1idXR0b25cIikucmVtb3ZlQ2xhc3MoXCJzZWxlY3RlZFwiKTtcclxuICAgICAgICAkKHRoaXMpLmFkZENsYXNzKFwic2VsZWN0ZWRcIik7XHJcbiAgICAgICAgLy8gU3RvcmUgdGhlIHJhdGluZyBhbmQgZW5hYmxlIHRoZSBQYXJ0IDIgTmV4dCBidXR0b24uXHJcbiAgICAgICAgY29uZmlkZW5jZVJhdGluZyA9IHJhdGluZztcclxuICAgICAgICAkKFwiI2J1dHRvbl9uZXh0X3BhcnQyXCIpLnJlbW92ZUF0dHIoXCJkaXNhYmxlZFwiKTtcclxuICAgIH0pO1xyXG4gIFxyXG4gICAgLy8gVHJhbnNpdGlvbiBmcm9tIFBhcnQgMiAoY29uZmlkZW5jZSByYXRpbmcpIHRvIHRoZSBuZXh0IHF1ZXN0aW9uLlxyXG4gICAgJChcIiNidXR0b25fbmV4dF9wYXJ0MlwiKS5vbihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgLy8gTG9nIHRoZSBjb25maWRlbmNlIHJhdGluZyBhbG9uZyB3aXRoIG90aGVyIGRhdGEgaWYgbmVlZGVkLlxyXG4gICAgICBsZXQgbG9nZ2VkX2RhdGEgPSB7XHJcbiAgICAgICAgXCJxdWVzdGlvbl9pXCI6IHF1ZXN0aW9uX2ksXHJcbiAgICAgICAgXCJjb25maWRlbmNlX3JhdGluZ1wiOiBjb25maWRlbmNlUmF0aW5nLFxyXG4gICAgICAgIC8vIC4uLiBpbmNsdWRlIG90aGVyIGxvZ2dpbmcgZmllbGRzIGFzIGRlc2lyZWRcclxuICAgICAgfTtcclxuICAgICAgbG9nX2RhdGEobG9nZ2VkX2RhdGEpO1xyXG4gICAgICBcclxuICAgICAgLy8gUmVzZXQgUGFydCAyIFVJIGVsZW1lbnRzIGZvciB0aGUgbmV4dCBxdWVzdGlvbi5cclxuICAgICAgJChcIiNidXR0b25fbmV4dF9wYXJ0MlwiKS5hdHRyKFwiZGlzYWJsZWRcIiwgXCJ0cnVlXCIpO1xyXG4gICAgICAkKFwiLmNvbmZpZGVuY2UtYnV0dG9uXCIpLnJlbW92ZUNsYXNzKFwic2VsZWN0ZWRcIik7XHJcbiAgICAgIGNvbmZpZGVuY2VSYXRpbmcgPSAtMTtcclxuICAgICAgXHJcbiAgICAgIC8vIFN3aXRjaCBiYWNrIHRvIFBhcnQgMSBhbmQgbG9hZCB0aGUgbmV4dCBxdWVzdGlvbi5cclxuICAgICAgJChcIiNwYXJ0MlwiKS5oaWRlKCk7XHJcbiAgICAgICQoXCIjcGFydDFcIikuc2hvdygpO1xyXG4gICAgICBuZXh0X3F1ZXN0aW9uKCk7XHJcbiAgICB9KTtcclxuICB9KTtcclxuICBmdW5jdGlvbiBhdXRvU3VibWl0UGFydDEoKSB7XHJcbiAgICAvLyBTdG9wIHRoZSB0aW1lciBpZiBub3QgYWxyZWFkeSBjbGVhcmVkXHJcbiAgICBjbGVhckludGVydmFsKHBhcnQxSW50ZXJ2YWwpO1xyXG4gICAgJChcIiN0aW1lclwiKS5oaWRlKCk7XHJcbiAgICBcclxuICAgIC8vIEF1dG9tYXRpY2FsbHkgdHJhbnNpdGlvbiB0byBQYXJ0IDJcclxuICAgICQoXCIjcGFydDFcIikuaGlkZSgpO1xyXG4gICAgJChcIiNwYXJ0MlwiKS5zaG93KCk7XHJcbn1cclxuJChcIiNxdWFsX25leHRcIikub24oXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICBjb25zdCBxMSA9ICgkKFwiI3F1YWxfcTFcIikudmFsKCkgYXMgc3RyaW5nKSB8fCBcIlwiO1xyXG4gICAgY29uc3QgcTIgPSAoJChcIiNxdWFsX3EyXCIpLnZhbCgpIGFzIHN0cmluZykgfHwgXCJcIjtcclxuICAgIGNvbnN0IHEzID0gKCQoXCIjcXVhbF9xM1wiKS52YWwoKSBhcyBzdHJpbmcpIHx8IFwiXCI7XHJcbiAgICBcclxuICAgIGxldCB2YWxpZCA9IHRydWU7XHJcbiAgICBcclxuICAgIGlmIChxMS5sZW5ndGggPCAyNSkge1xyXG4gICAgICAgICQoXCIjd2Fybl9xMVwiKS5zaG93KCk7XHJcbiAgICAgICAgdmFsaWQgPSBmYWxzZTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgJChcIiN3YXJuX3ExXCIpLmhpZGUoKTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgaWYgKHEyLmxlbmd0aCA8IDI1KSB7XHJcbiAgICAgICAgJChcIiN3YXJuX3EyXCIpLnNob3coKTtcclxuICAgICAgICB2YWxpZCA9IGZhbHNlO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICAkKFwiI3dhcm5fcTJcIikuaGlkZSgpO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBpZiAocTMubGVuZ3RoIDwgMjUpIHtcclxuICAgICAgICAkKFwiI3dhcm5fcTNcIikuc2hvdygpO1xyXG4gICAgICAgIHZhbGlkID0gZmFsc2U7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgICQoXCIjd2Fybl9xM1wiKS5oaWRlKCk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIElmIHZhbGlkYXRpb24gZmFpbHMsIGRvIG5vdCBwcm9jZWVkXHJcbiAgICBpZiAoIXZhbGlkKSB7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyBJZiBhbGwgdGV4dCBib3hlcyBoYXZlIGF0IGxlYXN0IDUwIGNoYXJhY3RlcnMsIGxvZyBkYXRhIGFuZCBwcm9jZWVkXHJcbiAgICBjb25zdCBmaW5hbERhdGEgPSB7XHJcbiAgICAgICAgcXVhbGl0YXRpdmU6IHtcclxuICAgICAgICAgICAgcTE6IHExLFxyXG4gICAgICAgICAgICBxMjogcTIsXHJcbiAgICAgICAgICAgIHEzOiBxM1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgLy8gLi4uIGluY2x1ZGUgYW55IGFkZGl0aW9uYWwgZGF0YSBpZiBuZWVkZWRcclxuICAgIH07XHJcbiAgICBsb2dfZGF0YShmaW5hbERhdGEpO1xyXG4gICAgXHJcbiAgICAvLyBUcmFuc2l0aW9uIHRvIGVuZC1vZi1zdXJ2ZXkg4oCcVGhhbmsgeW914oCdIHNjcmVlbiBvciBzaW1pbGFyLlxyXG4gICAgJChcIiNxdWFsaXRhdGl2ZV9zZWN0aW9uXCIpLmhpZGUoKTtcclxuICAgIGlmIChNT0NLTU9ERSkge1xyXG4gICAgICAgICQoJyNyZXdhcmRfYm94X21vY2snKS50ZXh0KGBZb3VyIHRvdGFsIHJld2FyZCBpcyAkJHtiYWxhbmNlLnRvRml4ZWQoMil9ICgke3F1ZXN0aW9uX2l9IHF1ZXN0aW9ucyBhbnN3ZXJlZCkgKyAkMi5gKTtcclxuICAgICAgICAkKCcjcmV3YXJkX2JveF9tb2NrJykuc2hvdygpO1xyXG4gICAgICAgICQoXCIjbWFpbl9ib3hfZW5kX21vY2tcIikuc2hvdygpOyAgICBcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgJCgnI3Jld2FyZF9ib3gnKS50ZXh0KGBZb3VyIHRvdGFsIHJld2FyZCBpcyAkJHtiYWxhbmNlLnRvRml4ZWQoMil9ICgke3F1ZXN0aW9uX2l9IHF1ZXN0aW9ucyBhbnN3ZXJlZCkgKyAkMi5gKTtcclxuICAgICAgICAkKCcjcmV3YXJkX2JveCcpLnNob3coKTtcclxuICAgICAgICAkKFwiI21haW5fYm94X2VuZFwiKS5zaG93KCk7ICAgIFxyXG4gICAgfVxyXG59KTtcclxuIiwiZnVuY3Rpb24gcGFyYW1zVG9PYmplY3QoZW50cmllcykge1xyXG4gIGNvbnN0IHJlc3VsdCA9IHt9XHJcbiAgLy8gZWFjaCAnZW50cnknIGlzIGEgW2tleSwgdmFsdWVdIHR1cHBsZVxyXG4gIGZvciAoY29uc3QgW2tleSwgdmFsdWVdIG9mIGVudHJpZXMpIHtcclxuICAgIHJlc3VsdFtrZXldID0gdmFsdWU7XHJcbiAgfVxyXG4gIHJldHVybiByZXN1bHQ7XHJcbn1cclxuXHJcbmV4cG9ydCB7IHBhcmFtc1RvT2JqZWN0IH0iXSwibmFtZXMiOlsiU0VSVkVSX0xPR19ST09UIiwiYXN5bmMiLCJsb2dfZGF0YSIsImRhdGEiLCJnbG9iYWxUaGlzIiwidXJsX2RhdGEiLCJjb25zb2xlIiwibG9nIiwidWlkIiwicmVzdWx0IiwiJCIsImFqYXgiLCJKU09OIiwic3RyaW5naWZ5IiwicHJvamVjdCIsInBheWxvYWQiLCJ0eXBlIiwiY29udGVudFR5cGUiLCJQcm9taXNlIiwicmVzb2x2ZSIsInNldFRpbWVvdXQiLCJzbGVlcCIsImUiLCJNT0NLTU9ERSIsInF1ZXN0aW9uX2kiLCJxdWVzdGlvbiIsInVzZXJzZWxlY3Rpb25fYW5zd2Vyb25seSIsInVzZXJzZWxlY3Rpb25fd2l0aGV4cGxhbmF0aW9uIiwidXNlcnNlbGVjdGlvbl93aXRoZXhwbGFuYXRpb25xdWFsaXR5IiwiY29uZmlkZW5jZVJhdGluZyIsInBhcnQxVGltZXIiLCJwYXJ0MUludGVydmFsIiwicmVtYWluaW5nVGltZSIsImJhbGFuY2UiLCJpbnN0cnVjdGlvbl9pIiwiY291bnRfZXhpdGVkX3BhZ2UiLCJyZWdpc3RlckFuc3dlck9ubHlVc2VyU2VsZWN0aW9uIiwidXNlcl9jaG9pY2UiLCJhdHRyIiwic2hvdyIsInJlZ2lzdGVyV2l0aEV4cGxhbmF0aW9uVXNlclNlbGVjdGlvbiIsInJlZ2lzdGVyV2l0aEV4cGxhbmF0aW9uUXVhbGl0eVVzZXJTZWxlY3Rpb24iLCJyZW1vdmVBdHRyIiwibmV4dF9pbnN0cnVjdGlvbnMiLCJpbmNyZW1lbnQiLCJ2YWwiLCJoaWRlIiwibmV4dF9xdWVzdGlvbiIsImNoaWxkcmVuIiwiZWFjaCIsIl8iLCJlbCIsImlzX3VzZXJfY29ycmVjdCIsInNlbGVjdGlvbiIsImxlbmd0aCIsInByZWRpY3RlZEh0bWwiLCJBcnJheSIsImlzQXJyYXkiLCJmaWx0ZXIiLCJpdGVtIiwidG9rZW4iLCJtYXAiLCJ0b2tlblRleHQiLCJyZXBsYWNlIiwiaW50ZW5zaXR5IiwidG9wXzVfdG9rZW5zIiwicHJvYmFiaWxpdHkiLCJqb2luIiwiaHRtbCIsImFkZENsYXNzIiwicmVtb3ZlQ2xhc3MiLCJ0b2tlbnNDb25jYXRlbmF0ZWQiLCJ0ZXh0IiwiY2xlYXJUaW1lb3V0Iiwid2luZG93IiwiYXV0b1N1Ym1pdFBhcnQxIiwiY2xlYXJJbnRlcnZhbCIsInNldEludGVydmFsIiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsImFkZEV2ZW50TGlzdGVuZXIiLCJvbiIsIm9sZF9iYWxhbmNlIiwiY29ycmVjdF9zZWxlY3Rpb24iLCJ1cGRhdGVfYmFsYW5jZSIsImxvZ2dlZF9kYXRhIiwidXJsUGFyYW1zIiwiVVJMU2VhcmNoUGFyYW1zIiwibG9jYXRpb24iLCJzZWFyY2giLCJzdGFydE92ZXJyaWRlIiwiZ2V0IiwiVUlERnJvbVVSTCIsImVudHJpZXMiLCJrZXkiLCJ2YWx1ZSIsInBhcmFtc1RvT2JqZWN0IiwicXVldWVfaWQiLCJNYXRoIiwiZmxvb3IiLCJyYW5kb20iLCJwYWRTdGFydCIsIlVJRF9tYXliZSIsInByb21wdCIsInN0YXJ0c1dpdGgiLCJnZXRKU09OIiwiRGF0ZSIsIm5vdyIsImxvYWRfZGF0YSIsImNhdGNoIiwiX2Vycm9yIiwicmVsb2FkIiwidGhlbiIsIm5ld19kYXRhIiwicGFyc2VJbnQiLCJhbGVydF9hY3RpdmUiLCJvbnZpc2liaWxpdHljaGFuZ2UiLCJyZWFkeSIsInJhdGluZyIsInRoaXMiLCJxMSIsInEyIiwicTMiLCJ2YWxpZCIsInF1YWxpdGF0aXZlIiwidG9GaXhlZCJdLCJzb3VyY2VSb290IjoiIn0=