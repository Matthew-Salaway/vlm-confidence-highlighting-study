(()=>{"use strict";let t="https://matthewsalaway.pythonanywhere.com/";async function e(e){e.url_data=globalThis.url_data,console.log("Data"),"study_id"in e.url_data||(e.url_data.study_id="demo_study"),"prolific_id"in e.url_data||(e.url_data.prolific_id="demo_user"),"session_id"in e.url_data||(e.url_data.session_id="demo_session"),e.url_data.queue_id=globalThis.uid,console.log("logged",e),console.log("Logging to",t+"log");try{let n=await $.ajax(t+"log",{data:JSON.stringify({project:"ocr-calibration-study/"+e.url_data.study_id,uid:globalThis.uid+"_"+e.url_data.prolific_id,payload:JSON.stringify(e)}),type:"POST",contentType:"application/json"});return await async function(){return new Promise((t=>setTimeout(t,2e3)))}(),n}catch(t){console.log(t)}}var n=!1,i=[];let o=null,a=-1,r=0,s=0,l=20,c=0,d=0,_=0,u=0,p=0;function h(){const t=$("input[name='latexExperience']:checked").val(),e=$("input[name='latexFrequency']:checked").val(),n=$("input[name='chatbotFrequency']:checked").val();return t&&e&&n?($("#button_instructions_next").show(),!0):($("#button_instructions_next").hide(),!1)}function g(t){u+=t,0==u?$("#button_instructions_prev").attr("disabled","true"):$("#button_instructions_prev").removeAttr("disabled"),4!=u||h()?($("#button_instructions_next").removeAttr("disabled"),$("#button_instructions_next").show()):($("#button_instructions_next").attr("disabled","true"),$("#button_instructions_next").hide()),u>=5?($("#instructions_and_decorations").show(),$("#button_instructions_next").val("Start study")):($("#instructions_and_decorations").hide(),$("#button_instructions_next").val("Next")),6==u&&($("#instructions_and_decorations").show(),$("#main_box_instructions").hide(),$("#main_box_experiment").show(),v()),$("#main_box_instructions").children(":not(input)").each(((t,e)=>{$(e).hide()})),$(`#instructions_${u}`).show()}function m(t){return 2!=t?t==1-o.prediction_is_correct?1:0:-1}$("#button_instructions_next").on("click",(()=>g(1))),$("#button_instructions_prev").on("click",(()=>g(-1))),$("#button_next").on("click",(()=>{let t=_;if(-1==1-o.prediction_is_correct&&(_+=.1),d>0){let n={question_i:d,user_selections:{answeronly:-1,withexplanation:-1,withexplanationquality:-1},user_is_correct:{answeronly:m(-1),withexplanation:m(-1),withexplanationquality:m(-1)},balance:{old:t,new:_}};n.question=o,n.count_exited_page=p,e(n),p=0}v()}));let b=[],x=0;function f(t){$("#practice_container").empty().show();const e=$('\n      <div id="practice_inner_container" style="padding: 20px; padding-top:0px; overflow-y: auto;">\n        <div id="practice_header"></div>\n        <div id="practice_content" style="margin-top: 10px;"></div>\n        <div id="practice_nav" style="margin-top: 20px; margin-bottom: 25px;"></div>\n      </div>\n    ');$("#practice_container").append(e),$("#practice_header").html(`<h2>Practice Round (${x+1} of ${b.length})</h2>`),$("#practice_content").html('\n      <div id="practice_question_display" style="margin-top: 10px;">\n        <img id="practice_question_image" src="" alt="Practice Question Image" style="max-width: 100%; height: 110px; object-fit: contain;margin-top: 20px;">\n        <div id="practice_predicted_text_container" style="margin-top: 20px;">\n          <div style="margin-top: 10px;">Predicted Text:</div>\n          <div id="practice_predicted_text" style="margin-top: 20px;"></div>\n        </div>\n        <div id="practice_token_input_container" style="margin-top: 20px;">\n          <input id="practice_token_input" type="text" style="width: 100%; font-size: 16px; padding: 8px;">\n        </div>\n      </div>\n    ');const n=b[x];n.image?$("#practice_question_image").attr("src","data:image/png;base64,"+n.image):$("#practice_question_image").attr("src","");let o="";n.token_info&&Array.isArray(n.token_info)&&(o=n.token_info.filter((t=>"<|im_end|>"!==t.token)).map((t=>{const e=t.token.replace(/Ġ/g," "),n=t.top_5_tokens&&t.top_5_tokens[0]&&"number"==typeof t.top_5_tokens[0].probability?t.top_5_tokens[0].probability:1;return"highlighted"===i[c].condition?`<span style="background-color: rgba(255, 0, 0, ${1-n});">${e}</span>`:e})).join("")),$("#practice_predicted_text").html(o);let a="";n.token_info&&Array.isArray(n.token_info)&&(a=n.token_info.map((t=>t.token)).filter((t=>"<|im_end|>"!==t)).map((t=>t.replace(/Ġ/g," "))).join("")),$("#practice_token_input").val(a),$("#practice_nav").html('\n      <div>\n        <input id="practice_prev" type="button" value="Previous Example">\n        <input id="practice_next" type="button" value="Next Example" style="margin-left: 10px;">\n      </div>\n    '),$("#practice_prev").off("click").on("click",(()=>{x=(x-1+b.length)%b.length,f(t)})),$("#practice_next").off("click").on("click",(()=>{x=(x+1)%b.length,f(t)}))}function v(){if($("#main_box_experiment").show(),$("#button_next").hide(),$("#button_quit").hide(),console.log("question index, condition index",d,c),c>=i.length)return $("#main_box_experiment").hide(),void $("#qualitative_section").show();let t=i[c];if(console.log("Condition block",t),console.log(i),0===d)return void function(t){$("#main_box_experiment").hide(),$("#start_condition_page").empty().show();const e=`\n      <div style="display: flex; justify-content: space-between; align-items: center;">\n          <h2 style="margin: 0;">${"highlighted"===t?"Uncertainty Highlighted Section":"Non-Highlighted Section"}</h2>\n          <input id="start_condition_next" type="button" value="Start Experiment" style="margin: 0;"/>\n      </div>\n    `;$("#start_condition_page").append(e),0===$("#practice_container").length&&$("#start_condition_page").append('<div id="practice_container" style="margin-top:10px;"></div>'),new Promise(((t,e)=>{$.getJSON("practice_questions/Qwen_practice_Qs.json").done((e=>t(e))).fail(((t,n,i)=>e(i)))})).then((t=>{b=t,console.log("Practice questions loaded:",b),x=0,f((()=>{d=1,v()}))})).catch((t=>{console.error("Error loading practice questions:",t)})),$("#start_condition_next").on("click",(()=>{$("#start_condition_page").hide(),d=1,v()}))}(t.condition);if(d>t.questions.length)return void function(){$("#main_box_experiment").hide();const t=i[c].condition;$("#condition_label").text(t),$("#mental_demand").val("0"),$("#hurried_demand").val("0"),$("#performance").val("0"),$("#effort").val("0"),$("#frustration").val("0"),$("#nasa_tlx_survey").show()}(t.condition);o=t.questions[d-1],console.log("Question",d,o),o.image?$("#question_image").attr("src","data:image/png;base64,"+o.image):$("#question_image").attr("src","");let e="";o.token_info&&Array.isArray(o.token_info)&&(e=o.token_info.filter((t=>"<|im_end|>"!==t.token)).map((t=>{let e=t.token.replace(/Ġ/g," "),n=1-(t.top_5_tokens&&t.top_5_tokens[0]&&"number"==typeof t.top_5_tokens[0].probability?t.top_5_tokens[0].probability:1);return"highlighted"==i[c].condition?`<span style="background-color: rgba(255, 0, 0, ${n});">${e}</span>`:e})).join("")),$("#predicted_text").html(e);let n="";o.token_info&&Array.isArray(o.token_info)&&(n=o.token_info.map((t=>t.token)).filter((t=>"<|im_end|>"!==t)).map((t=>t.replace(/Ġ/g," "))).join("")),$("#token_input").val(n),$("#progress").text(`Section ${c+1} of ${i.length} | Question ${d} of ${t.questions.length}`),$("#part1").show(),$("#part2").hide(),$("#token_input_container").hide(),$("#button_next_part1").hide(),clearTimeout(r),r=window.setTimeout(T,2e4),l=20,$("#timer").text(l),$("#timer").show(),s&&clearInterval(s),s=window.setInterval((()=>{l-=1,$("#timer").text(l),l<=15&&($("#token_input_container").show(),$("#button_next_part1").show()),l<=0&&(clearInterval(s),T(),$("#timer").hide())}),1e3)}const y=new URLSearchParams(window.location.search),w=y.get("start"),k=y.get("uid");if(globalThis.url_data=function(t){const e={};for(const[n,i]of t)e[n]=i;return e}(y.entries()),null==globalThis.url_data.study_id&&(globalThis.url_data.study_id="demo_study"),null==globalThis.url_data.prolific_id&&(globalThis.url_data.prolific_id="demo_user"),null==globalThis.url_data.session_id&&(globalThis.url_data.session_id="demo_session"),null!=k){if(globalThis.uid=k,"prolific_random"==globalThis.uid){let t=`${Math.floor(10*Math.random())}`.padStart(3,"0");globalThis.uid=`${y.get("prolific_queue_name")}/${t}`}}else{let t=null;for(;null==t;)t=prompt("Enter your user id. Please get in touch if you were not assigned an id but wish to participate in this experiment.");globalThis.uid=t}globalThis.url_data.session_id.startsWith("demo")&&(n=!0),console.log("Running with UID",globalThis.uid),async function(){return await $.getJSON(`baked_queues/${globalThis.uid}.json?t=${Date.now()}`)}().catch((t=>{console.log("Invalid user id."),console.log(globalThis.uid),window.location.reload()})).then((t=>{i=t,null!=w&&(d=parseInt(w)-1,console.log("Starting from",d)),g(0),$("#main_box_instructions").show(),$("#instructions_and_decorations").hide()})),console.log("Starting session with UID:",globalThis.uid);let q=!1;function T(){clearInterval(s),$("#timer").hide(),$("#part1").hide(),$("#part2").show()}document.onvisibilitychange=()=>{q||(p+=1,q=!0,q=!1)},$(document).ready((()=>{$("#button_next_part1").on("click",(()=>{clearTimeout(r),$("#timer").hide(),$("#part1").hide(),$("#part2").show()})),$(".confidence-button").on("click",(function(){let t=parseInt($(this).attr("data-rating"));$(".confidence-button").removeClass("selected"),$(this).addClass("selected"),a=t,$("#button_next_part2").removeAttr("disabled")})),$("#button_next_part2").on("click",(()=>{e({question_i:d,condition_i:c,confidence_rating:a}),$("#button_next_part2").attr("disabled","true"),$(".confidence-button").removeClass("selected"),a=-1,$("#part2").hide(),$("#part1").show(),d++,v()})),$("input[name='latexExperience'], input[name='latexFrequency'], input[name='chatbotFrequency']").on("change",(()=>{h()&&($("#button_instructions_next").removeAttr("disabled"),$("#button_instructions_next").show())})),$("#token_input").on("input",(function(){let t=$(this).val();console.log("User input:",t)}));const t={mental_demand:!1,hurried_demand:!1,performance:!1,effort:!1,frustration:!1};function n(){return Object.values(t).every((t=>!0===t))}const i=$("#nasa_tlx_next");i.prop("disabled",!0),$(".nasa-tlx-range").on("input",(function(){const e=$(this).attr("id");e in t&&("0"!==$(this).val()&&(t[e]=!0),n()&&i.prop("disabled",!1))})),i.on("click",(()=>{if(!n())return void alert("Please adjust all sliders before continuing.");const o=$("#mental_demand").val()||"0",a=$("#hurried_demand").val()||"0",r=$("#performance").val()||"0",s=$("#effort").val()||"0",l=$("#frustration").val()||"0",_={mental_demand:parseInt(o),hurried_demand:parseInt(a),performance:parseInt(r),effort:parseInt(s),frustration:parseInt(l)};e({condition:$("#condition_label").text(),tlx:_}),function(){for(let e in t)t[e]=!1;$(".nasa-tlx-range").val("0"),i.prop("disabled",!0)}(),$("#nasa_tlx_survey").hide(),c++,d=0,v()}))})),$("#qual_next").on("click",(()=>{const t=$("#qual_q1").val()||"",i=$("#qual_q2").val()||"",o=$("#qual_q3").val()||"";let a=!0;t.length<25?($("#warn_q1").show(),a=!1):$("#warn_q1").hide(),i.length<25?($("#warn_q2").show(),a=!1):$("#warn_q2").hide(),o.length<0?($("#warn_q3").show(),a=!1):$("#warn_q3").hide(),a&&(e({qualitative:{q1:t,q2:i,q3:o}}),$("#qualitative_section").hide(),n?($("#reward_box_mock").text("Your total reward is $3.00."),$("#reward_box_mock").show(),$("#main_box_end_mock").show()):($("#reward_box").text("Your total reward is $3.00."),$("#reward_box").show(),$("#main_box_end").show()))}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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ckYsRUFBRSxvQkFBb0I2QixPQUN0QjdCLEVBQUUsc0JBQXNCNkIsU0FFeEI3QixFQUFFLGVBQWVxRixLQUFLLCtCQUN0QnJGLEVBQUUsZUFBZTZCLE9BQ2pCN0IsRUFBRSxpQkFBaUI2QixRIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vc3JjL2Nvbm5lY3Rvci50cyIsIndlYnBhY2s6Ly8vLi9zcmMvbWFpbi50cyIsIndlYnBhY2s6Ly8vLi9zcmMvdXRpbHMudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgREVWTU9ERSB9IGZyb20gJy4vZ2xvYmFscydcclxuaW1wb3J0IHsgTU9DS01PREUgfSBmcm9tICcuL21haW4nXHJcblxyXG5sZXQgU0VSVkVSX0xPR19ST09UID0gREVWTU9ERSA/IFwiaHR0cDovLzEyNy4wLjAuMTo1MDAwL1wiIDogXCJodHRwczovL21hdHRoZXdzYWxhd2F5LnB5dGhvbmFueXdoZXJlLmNvbS9cIlxyXG5cclxuYXN5bmMgZnVuY3Rpb24gc2xlZXAobXM6IG51bWJlcik6IFByb21pc2U8dm9pZD4ge1xyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIG1zKSk7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBsb2FkX2RhdGEoKTogUHJvbWlzZTxhbnk+IHtcclxuICAgIC8vIGluY2x1ZGUgdGltZXN0YW1wIHNvIHRoYXQgdGhpbmdzIGRvbid0IGdldCBjYWNoZWRcclxuICAgIGxldCByZXN1bHQgPSBhd2FpdCAkLmdldEpTT04oXHJcbiAgICAgICAgYGJha2VkX3F1ZXVlcy8ke2dsb2JhbFRoaXMudWlkfS5qc29uP3Q9JHtEYXRlLm5vdygpfWAsXHJcbiAgICApXHJcbiAgICByZXR1cm4gcmVzdWx0XHJcbn1cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGxvZ19kYXRhKGRhdGEpOiBQcm9taXNlPGFueT4ge1xyXG4gICAgLy9pZiAoTU9DS01PREUpIHtcclxuICAgIC8vICAgIGNvbnNvbGUubG9nKFwibG9nZ2VkIChtb2NrKVwiLCBkYXRhKVxyXG4gICAgLy8gICAgcmV0dXJuXHJcbiAgICAvL31cclxuICAgIFxyXG4gICAgZGF0YVtcInVybF9kYXRhXCJdID0gZ2xvYmFsVGhpcy51cmxfZGF0YVxyXG4gICAgY29uc29sZS5sb2coXCJEYXRhXCIpXHJcbiAgICBpZiAoIShcInN0dWR5X2lkXCIgaW4gZGF0YVsndXJsX2RhdGEnXSkpIHtcclxuICAgICAgICBkYXRhWyd1cmxfZGF0YSddW1wic3R1ZHlfaWRcIl0gPSBcImRlbW9fc3R1ZHlcIlxyXG4gICAgfVxyXG4gICAgaWYgKCEoXCJwcm9saWZpY19pZFwiIGluIGRhdGFbJ3VybF9kYXRhJ10pKSB7XHJcbiAgICAgICAgZGF0YVsndXJsX2RhdGEnXVtcInByb2xpZmljX2lkXCJdID0gXCJkZW1vX3VzZXJcIlxyXG4gICAgfVxyXG4gICAgaWYgKCEoXCJzZXNzaW9uX2lkXCIgaW4gZGF0YVsndXJsX2RhdGEnXSkpIHtcclxuICAgICAgICBkYXRhWyd1cmxfZGF0YSddW1wic2Vzc2lvbl9pZFwiXSA9IFwiZGVtb19zZXNzaW9uXCJcclxuICAgIH1cclxuICAgIGRhdGFbXCJ1cmxfZGF0YVwiXVtcInF1ZXVlX2lkXCJdID0gZ2xvYmFsVGhpcy51aWRcclxuICAgIGNvbnNvbGUubG9nKFwibG9nZ2VkXCIsIGRhdGEpXHJcbiAgICBjb25zb2xlLmxvZyhcIkxvZ2dpbmcgdG9cIiwgU0VSVkVSX0xPR19ST09UICsgXCJsb2dcIilcclxuXHJcbiAgICB0cnkge1xyXG4gICAgICAgIGxldCByZXN1bHQgPSBhd2FpdCAkLmFqYXgoXHJcbiAgICAgICAgICAgIFNFUlZFUl9MT0dfUk9PVCArIFwibG9nXCIsXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGRhdGE6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICAgICAgICAgICAgICBwcm9qZWN0OiBcIm9jci1jYWxpYnJhdGlvbi1zdHVkeS9cIitkYXRhWyd1cmxfZGF0YSddWydzdHVkeV9pZCddLFxyXG4gICAgICAgICAgICAgICAgICAgIHVpZDogZ2xvYmFsVGhpcy51aWQrXCJfXCIrZGF0YVsndXJsX2RhdGEnXVsncHJvbGlmaWNfaWQnXSxcclxuICAgICAgICAgICAgICAgICAgICBwYXlsb2FkOiBKU09OLnN0cmluZ2lmeShkYXRhKSxcclxuICAgICAgICAgICAgICAgIH0pLFxyXG4gICAgICAgICAgICAgICAgdHlwZTogJ1BPU1QnLFxyXG4gICAgICAgICAgICAgICAgY29udGVudFR5cGU6ICdhcHBsaWNhdGlvbi9qc29uJyxcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIClcclxuICAgICAgICBhd2FpdCBzbGVlcCgyMDAwKTtcclxuICAgICAgICByZXR1cm4gcmVzdWx0XHJcbiAgICB9IGNhdGNoIChlKSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coZSlcclxuICAgIH1cclxufSIsImltcG9ydCB7IERFVk1PREUgfSBmcm9tIFwiLi9nbG9iYWxzXCJcclxuZXhwb3J0IHZhciBVSUQ6IHN0cmluZ1xyXG5leHBvcnQgdmFyIE1PQ0tNT0RFOiBib29sZWFuID0gZmFsc2VcclxuaW1wb3J0IHsgbG9hZF9kYXRhLCBsb2dfZGF0YSB9IGZyb20gJy4vY29ubmVjdG9yJ1xyXG5pbXBvcnQgeyBwYXJhbXNUb09iamVjdCB9IGZyb20gXCIuL3V0aWxzXCJcclxuXHJcbnZhciBkYXRhOiBhbnlbXSA9IFtdXHJcbmxldCBxdWVzdGlvbjogYW55ID0gbnVsbFxyXG5sZXQgdXNlcnNlbGVjdGlvbl9hbnN3ZXJvbmx5OiBudW1iZXIgPSAtMVxyXG5sZXQgdXNlcnNlbGVjdGlvbl93aXRoZXhwbGFuYXRpb246IG51bWJlciA9IC0xXHJcbmxldCB1c2Vyc2VsZWN0aW9uX3dpdGhleHBsYW5hdGlvbnF1YWxpdHk6IG51bWJlciA9IC0xXHJcbmxldCBjb25maWRlbmNlUmF0aW5nOiBudW1iZXIgPSAtMTtcclxubGV0IHBhcnQxVGltZXI6IG51bWJlciA9IDA7XHJcbmxldCBwYXJ0MUludGVydmFsOiBudW1iZXIgPSAwO1xyXG5sZXQgcmVtYWluaW5nVGltZTogbnVtYmVyID0gMjA7XHJcbmxldCBjdXJyZW50Q29uZGl0aW9uSW5kZXggPSAwO1xyXG5sZXQgY3VycmVudFF1ZXN0aW9uSW5kZXggPSAwO1xyXG5cclxuXHJcblxyXG5cclxubGV0IGJhbGFuY2UgPSAwXHJcbmxldCBiYWxhbmNlX2luY3JlbWVudCA9IDAuMSAgICAgLy8gQmFsYW5jZSB1cGRhdGVzIGJ5ICQwLjEwIGZvciBldmVyeSBjb3JyZWN0IHNlbGVjdGlvblxyXG5cclxubGV0IGluc3RydWN0aW9uX2k6IG51bWJlciA9IDBcclxubGV0IGNvdW50X2V4aXRlZF9wYWdlOiBudW1iZXIgPSAwXHJcblxyXG5mdW5jdGlvbiBhc3NlcnQoY29uZGl0aW9uLCBtZXNzYWdlKSB7XHJcbiAgICBpZiAoIWNvbmRpdGlvbikge1xyXG4gICAgICAgIHRocm93IG1lc3NhZ2UgfHwgXCJBc3NlcnRpb24gZmFpbGVkXCI7XHJcbiAgICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGNoZWNrUHJlU3VydmV5KCk6IGJvb2xlYW4ge1xyXG4gICAgY29uc3QgbGF0ZXhFeHAgPSAkKFwiaW5wdXRbbmFtZT0nbGF0ZXhFeHBlcmllbmNlJ106Y2hlY2tlZFwiKS52YWwoKTtcclxuICAgIGNvbnN0IGxhdGV4RnJlcSA9ICQoXCJpbnB1dFtuYW1lPSdsYXRleEZyZXF1ZW5jeSddOmNoZWNrZWRcIikudmFsKCk7XHJcbiAgICBjb25zdCBjaGF0Ym90RnJlcSA9ICQoXCJpbnB1dFtuYW1lPSdjaGF0Ym90RnJlcXVlbmN5J106Y2hlY2tlZFwiKS52YWwoKTtcclxuICBcclxuICAgIGlmIChsYXRleEV4cCAmJiBsYXRleEZyZXEgJiYgY2hhdGJvdEZyZXEpIHtcclxuICAgICAgJChcIiNidXR0b25faW5zdHJ1Y3Rpb25zX25leHRcIikuc2hvdygpO1xyXG4gICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICQoXCIjYnV0dG9uX2luc3RydWN0aW9uc19uZXh0XCIpLmhpZGUoKTtcclxuICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG59XHJcblxyXG5cclxuZnVuY3Rpb24gbmV4dF9pbnN0cnVjdGlvbnMoaW5jcmVtZW50OiBudW1iZXIpIHtcclxuICAgIGluc3RydWN0aW9uX2kgKz0gaW5jcmVtZW50XHJcblxyXG4gICAgaWYgKGluc3RydWN0aW9uX2kgPT0gMCkge1xyXG4gICAgICAgICQoXCIjYnV0dG9uX2luc3RydWN0aW9uc19wcmV2XCIpLmF0dHIoXCJkaXNhYmxlZFwiLCBcInRydWVcIilcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgJChcIiNidXR0b25faW5zdHJ1Y3Rpb25zX3ByZXZcIikucmVtb3ZlQXR0cihcImRpc2FibGVkXCIpXHJcbiAgICB9XHJcbiAgICBpZihpbnN0cnVjdGlvbl9pID09IDQgJiYgIWNoZWNrUHJlU3VydmV5KCkpIHtcclxuICAgICAgICAkKFwiI2J1dHRvbl9pbnN0cnVjdGlvbnNfbmV4dFwiKS5hdHRyKFwiZGlzYWJsZWRcIiwgXCJ0cnVlXCIpXHJcbiAgICAgICAgJChcIiNidXR0b25faW5zdHJ1Y3Rpb25zX25leHRcIikuaGlkZSgpXHJcbiAgICB9XHJcbiAgICBlbHNle1xyXG4gICAgICAgICQoXCIjYnV0dG9uX2luc3RydWN0aW9uc19uZXh0XCIpLnJlbW92ZUF0dHIoXCJkaXNhYmxlZFwiKVxyXG4gICAgICAgICQoXCIjYnV0dG9uX2luc3RydWN0aW9uc19uZXh0XCIpLnNob3coKVxyXG4gICAgfVxyXG4gICAgaWYgKGluc3RydWN0aW9uX2kgPj0gNSkge1xyXG4gICAgICAgICQoXCIjaW5zdHJ1Y3Rpb25zX2FuZF9kZWNvcmF0aW9uc1wiKS5zaG93KClcclxuICAgICAgICAkKFwiI2J1dHRvbl9pbnN0cnVjdGlvbnNfbmV4dFwiKS52YWwoXCJTdGFydCBzdHVkeVwiKVxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICAkKFwiI2luc3RydWN0aW9uc19hbmRfZGVjb3JhdGlvbnNcIikuaGlkZSgpXHJcbiAgICAgICAgJChcIiNidXR0b25faW5zdHJ1Y3Rpb25zX25leHRcIikudmFsKFwiTmV4dFwiKVxyXG4gICAgfVxyXG4gICAgaWYgKGluc3RydWN0aW9uX2kgPT0gNikge1xyXG4gICAgICAgICQoXCIjaW5zdHJ1Y3Rpb25zX2FuZF9kZWNvcmF0aW9uc1wiKS5zaG93KClcclxuICAgICAgICAkKFwiI21haW5fYm94X2luc3RydWN0aW9uc1wiKS5oaWRlKClcclxuICAgICAgICAkKFwiI21haW5fYm94X2V4cGVyaW1lbnRcIikuc2hvdygpXHJcbiAgICAgICAgLy8gUmVzZXQgb3VyIGNvbmRpdGlvbiBpbmRpY2VzIGJlZm9yZSBzdGFydGluZyB0aGUgZXhwZXJpbWVudFxyXG5cclxuICAgICAgICBuZXh0X3F1ZXN0aW9uKClcclxuICAgIH1cclxuXHJcbiAgICAkKFwiI21haW5fYm94X2luc3RydWN0aW9uc1wiKS5jaGlsZHJlbihcIjpub3QoaW5wdXQpXCIpLmVhY2goKF8sIGVsKSA9PiB7XHJcbiAgICAgICAgJChlbCkuaGlkZSgpXHJcbiAgICB9KVxyXG4gICAgJChgI2luc3RydWN0aW9uc18ke2luc3RydWN0aW9uX2l9YCkuc2hvdygpXHJcbn1cclxuJChcIiNidXR0b25faW5zdHJ1Y3Rpb25zX25leHRcIikub24oXCJjbGlja1wiLCAoKSA9PiBuZXh0X2luc3RydWN0aW9ucygrMSkpXHJcbiQoXCIjYnV0dG9uX2luc3RydWN0aW9uc19wcmV2XCIpLm9uKFwiY2xpY2tcIiwgKCkgPT4gbmV4dF9pbnN0cnVjdGlvbnMoLTEpKVxyXG5cclxuJChcIiNidXR0b25fbmV4dFwiKS5vbihcImNsaWNrXCIsICgpID0+IHtcclxuXHJcbiAgICAvLyBVcGRhdGUgdGhlIHVzZXIgYmFsYW5jZVxyXG4gICAgbGV0IG9sZF9iYWxhbmNlID0gYmFsYW5jZVxyXG4gICAgdXBkYXRlX2JhbGFuY2UoKVxyXG5cclxuICAgIGlmIChjdXJyZW50UXVlc3Rpb25JbmRleCA+IDApIHtcclxuICAgICAgICBsZXQgbG9nZ2VkX2RhdGEgPSB7XHJcbiAgICAgICAgICAgIFwicXVlc3Rpb25faVwiOiBjdXJyZW50UXVlc3Rpb25JbmRleCxcclxuICAgICAgICAgICAgXCJ1c2VyX3NlbGVjdGlvbnNcIjoge1xyXG4gICAgICAgICAgICAgICAgXCJhbnN3ZXJvbmx5XCI6IHVzZXJzZWxlY3Rpb25fYW5zd2Vyb25seSxcclxuICAgICAgICAgICAgICAgIFwid2l0aGV4cGxhbmF0aW9uXCI6IHVzZXJzZWxlY3Rpb25fd2l0aGV4cGxhbmF0aW9uLFxyXG4gICAgICAgICAgICAgICAgXCJ3aXRoZXhwbGFuYXRpb25xdWFsaXR5XCI6IHVzZXJzZWxlY3Rpb25fd2l0aGV4cGxhbmF0aW9ucXVhbGl0eVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBcInVzZXJfaXNfY29ycmVjdFwiOiB7XHJcbiAgICAgICAgICAgICAgICBcImFuc3dlcm9ubHlcIjogaXNfdXNlcl9jb3JyZWN0KHVzZXJzZWxlY3Rpb25fYW5zd2Vyb25seSksXHJcbiAgICAgICAgICAgICAgICBcIndpdGhleHBsYW5hdGlvblwiOiBpc191c2VyX2NvcnJlY3QodXNlcnNlbGVjdGlvbl93aXRoZXhwbGFuYXRpb24pLFxyXG4gICAgICAgICAgICAgICAgXCJ3aXRoZXhwbGFuYXRpb25xdWFsaXR5XCI6IGlzX3VzZXJfY29ycmVjdCh1c2Vyc2VsZWN0aW9uX3dpdGhleHBsYW5hdGlvbnF1YWxpdHkpXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIFwiYmFsYW5jZVwiOiB7XHJcbiAgICAgICAgICAgICAgICBcIm9sZFwiOiBvbGRfYmFsYW5jZSxcclxuICAgICAgICAgICAgICAgIFwibmV3XCI6IGJhbGFuY2VcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgbG9nZ2VkX2RhdGFbJ3F1ZXN0aW9uJ10gPSBxdWVzdGlvblxyXG4gICAgICAgIGxvZ2dlZF9kYXRhWydjb3VudF9leGl0ZWRfcGFnZSddID0gY291bnRfZXhpdGVkX3BhZ2VcclxuICAgICAgICBsb2dfZGF0YShsb2dnZWRfZGF0YSlcclxuICAgICAgICBjb3VudF9leGl0ZWRfcGFnZSA9IDBcclxuICAgIH1cclxuICAgIFxyXG5cclxuICAgIG5leHRfcXVlc3Rpb24oKVxyXG59KTtcclxuXHJcblxyXG5cclxuZnVuY3Rpb24gaXNfdXNlcl9jb3JyZWN0KHNlbGVjdGlvbikge1xyXG4gICAgaWYgKHNlbGVjdGlvbiAhPSAyKSB7XHJcbiAgICAgICAgbGV0IGNvcnJlY3Rfc2VsZWN0aW9uID0gMSAtIHF1ZXN0aW9uW1wicHJlZGljdGlvbl9pc19jb3JyZWN0XCJdIC8vIDAgaWYgQUkgaXMgY29ycmVjdCwgMSBpZiBpbmNvcnJlY3RcclxuICAgICAgICByZXR1cm4gc2VsZWN0aW9uID09IGNvcnJlY3Rfc2VsZWN0aW9uID8gMSA6IDBcclxuICAgIH1cclxuICAgIHJldHVybiAtMVxyXG59XHJcblxyXG5mdW5jdGlvbiB1cGRhdGVfYmFsYW5jZSgpIHtcclxuICAgIGlmICh1c2Vyc2VsZWN0aW9uX3dpdGhleHBsYW5hdGlvbnF1YWxpdHkgIT0gMikge1xyXG4gICAgICAgIGxldCBjb3JyZWN0X3NlbGVjdGlvbiA9IDEgLSBxdWVzdGlvbltcInByZWRpY3Rpb25faXNfY29ycmVjdFwiXSAvLyAwIGlmIEFJIGlzIGNvcnJlY3QsIDEgaWYgaW5jb3JyZWN0XHJcbiAgICAgICAgaWYgKHVzZXJzZWxlY3Rpb25fd2l0aGV4cGxhbmF0aW9ucXVhbGl0eSA9PSBjb3JyZWN0X3NlbGVjdGlvbikge1xyXG4gICAgICAgICAgICBiYWxhbmNlICs9IGJhbGFuY2VfaW5jcmVtZW50XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcblxyXG4vKiBOZXcgZnVuY3Rpb246IFNob3cgc3RhcnQtb2YtY29uZGl0aW9uIHBhZ2UgKi9cclxuZnVuY3Rpb24gc2hvd1N0YXJ0Q29uZGl0aW9uUGFnZShjb25kaXRpb246IHN0cmluZykge1xyXG4gICAgJChcIiNtYWluX2JveF9leHBlcmltZW50XCIpLmhpZGUoKTtcclxuICAgIC8vIENsZWFyIHRoZSBjb250YWluZXIgb25jZS5cclxuICAgICQoXCIjc3RhcnRfY29uZGl0aW9uX3BhZ2VcIikuZW1wdHkoKS5zaG93KCk7XHJcblxyXG4gICAgLy8gRGV0ZXJtaW5lIGhlYWRlciB0ZXh0IGJhc2VkIG9uIGNvbmRpdGlvbi5cclxuICAgIGNvbnN0IGhlYWRlclRleHQgPSAoY29uZGl0aW9uID09PSBcImhpZ2hsaWdodGVkXCIpIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgPyBcIlVuY2VydGFpbnR5IEhpZ2hsaWdodGVkIFNlY3Rpb25cIiBcclxuICAgICAgICAgICAgICAgICAgICAgICAgIDogXCJOb24tSGlnaGxpZ2h0ZWQgU2VjdGlvblwiO1xyXG5cclxuICAgIC8vIENyZWF0ZSBhIGZsZXggY29udGFpbmVyIHdpdGggaGVhZGVyIGFuZCBTdGFydCBFeHBlcmltZW50IGJ1dHRvbi5cclxuICAgIGNvbnN0IGhlYWRlckh0bWwgPSBgXHJcbiAgICAgIDxkaXYgc3R5bGU9XCJkaXNwbGF5OiBmbGV4OyBqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWJldHdlZW47IGFsaWduLWl0ZW1zOiBjZW50ZXI7XCI+XHJcbiAgICAgICAgICA8aDIgc3R5bGU9XCJtYXJnaW46IDA7XCI+JHtoZWFkZXJUZXh0fTwvaDI+XHJcbiAgICAgICAgICA8aW5wdXQgaWQ9XCJzdGFydF9jb25kaXRpb25fbmV4dFwiIHR5cGU9XCJidXR0b25cIiB2YWx1ZT1cIlN0YXJ0IEV4cGVyaW1lbnRcIiBzdHlsZT1cIm1hcmdpbjogMDtcIi8+XHJcbiAgICAgIDwvZGl2PlxyXG4gICAgYDtcclxuICAgICQoXCIjc3RhcnRfY29uZGl0aW9uX3BhZ2VcIikuYXBwZW5kKGhlYWRlckh0bWwpO1xyXG5cclxuICAgIC8vIEFwcGVuZCBhIGNvbnRhaW5lciBmb3IgdGhlIHByYWN0aWNlIHJvdW5kIGNvbnRlbnQgaWYgbm90IGFscmVhZHkgcHJlc2VudC5cclxuICAgIGlmICgkKFwiI3ByYWN0aWNlX2NvbnRhaW5lclwiKS5sZW5ndGggPT09IDApIHtcclxuICAgICAgJChcIiNzdGFydF9jb25kaXRpb25fcGFnZVwiKS5hcHBlbmQoJzxkaXYgaWQ9XCJwcmFjdGljZV9jb250YWluZXJcIiBzdHlsZT1cIm1hcmdpbi10b3A6MTBweDtcIj48L2Rpdj4nKTtcclxuICAgIH1cclxuXHJcbiAgICBsb2FkUHJhY3RpY2VRdWVzdGlvbnMoKS50aGVuKChkYXRhKSA9PiB7XHJcbiAgICAgICAgcHJhY3RpY2VRdWVzdGlvbnMgPSBkYXRhO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKFwiUHJhY3RpY2UgcXVlc3Rpb25zIGxvYWRlZDpcIiwgcHJhY3RpY2VRdWVzdGlvbnMpO1xyXG4gICAgICAgIHByYWN0aWNlSW5kZXggPSAwOyAvLyBTdGFydCBhdCB0aGUgZmlyc3QgcHJhY3RpY2UgcXVlc3Rpb24uXHJcbiAgICAgICAgLy8gTGF1bmNoIHRoZSBwcmFjdGljZSByb3VuZC5cclxuICAgICAgICBzaG93UHJhY3RpY2VSb3VuZCgoKSA9PiB7XHJcbiAgICAgICAgICAvLyBXaGVuIHByYWN0aWNlIGlzIGNvbXBsZXRlLCByZXN1bWUgdGhlIG5vcm1hbCBleHBlcmltZW50IGZsb3cuXHJcbiAgICAgICAgICAvLyAoQXQgdGhpcyBwb2ludCwgeW91IGNhbiBub3cgc2FmZWx5IHVwZGF0ZSBleHBlcmltZW50IHN0YXRlLilcclxuICAgICAgICAgIGN1cnJlbnRRdWVzdGlvbkluZGV4ID0gMTtcclxuICAgICAgICAgIG5leHRfcXVlc3Rpb24oKTtcclxuICAgICAgICB9KTtcclxuICAgICAgfSkuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBsb2FkaW5nIHByYWN0aWNlIHF1ZXN0aW9uczpcIiwgZXJyKTtcclxuICAgICAgfSk7XHJcbiAgICBcclxuXHJcbiAgICAkKFwiI3N0YXJ0X2NvbmRpdGlvbl9uZXh0XCIpLm9uKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICAgICQoXCIjc3RhcnRfY29uZGl0aW9uX3BhZ2VcIikuaGlkZSgpO1xyXG4gICAgICAgIC8vIEFmdGVyIHN0YXJ0IHBhZ2UsIGJlZ2luIHdpdGggZmlyc3QgcXVlc3Rpb24gKHNldCBpbmRleCB0byAxKVxyXG4gICAgICAgIGN1cnJlbnRRdWVzdGlvbkluZGV4ID0gMTtcclxuICAgICAgICBuZXh0X3F1ZXN0aW9uKCk7XHJcbiAgICB9KTtcclxufVxyXG5sZXQgcHJhY3RpY2VRdWVzdGlvbnM6IGFueVtdID0gW107XHJcbmxldCBwcmFjdGljZUluZGV4OiBudW1iZXIgPSAwO1xyXG5cclxuLy8gRnVuY3Rpb24gdG8gbG9hZCBwcmFjdGljZSBxdWVzdGlvbnMgKGFzc3VtZXMgYSBKU09OIGZpbGUgd2l0aCBhbiBhcnJheSBvZiBleGFtcGxlIHF1ZXN0aW9ucylcclxuZnVuY3Rpb24gbG9hZFByYWN0aWNlUXVlc3Rpb25zKCk6IFByb21pc2U8YW55W10+IHtcclxuICByZXR1cm4gbmV3IFByb21pc2U8YW55W10+KChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuICAgICQuZ2V0SlNPTihcInByYWN0aWNlX3F1ZXN0aW9ucy9Rd2VuX3ByYWN0aWNlX1FzLmpzb25cIilcclxuICAgICAgLmRvbmUoZGF0YSA9PiByZXNvbHZlKGRhdGEpKVxyXG4gICAgICAuZmFpbCgoanF4aHIsIHRleHRTdGF0dXMsIGVycm9yKSA9PiByZWplY3QoZXJyb3IpKTtcclxuICB9KTtcclxufVxyXG5mdW5jdGlvbiBzaG93UHJhY3RpY2VSb3VuZChvbkNvbXBsZXRlOiAoKSA9PiB2b2lkKSB7XHJcbiAgICAvLyBJbnN0ZWFkIG9mIGVtcHR5aW5nIHRoZSBlbnRpcmUgcGFnZSwgdXBkYXRlIG9ubHkgdGhlIHByYWN0aWNlIGNvbnRhaW5lci5cclxuICAgICQoXCIjcHJhY3RpY2VfY29udGFpbmVyXCIpLmVtcHR5KCkuc2hvdygpO1xyXG4gIFxyXG4gICAgLy8gQnVpbGQgdGhlIHByYWN0aWNlIHJvdW5kIGNvbnRlbnQgaW5zaWRlIGEgZml4ZWQgY29udGFpbmVyLlxyXG4gICAgY29uc3QgcHJhY3RpY2VDb250ZW50ID0gJChgXHJcbiAgICAgIDxkaXYgaWQ9XCJwcmFjdGljZV9pbm5lcl9jb250YWluZXJcIiBzdHlsZT1cInBhZGRpbmc6IDIwcHg7IHBhZGRpbmctdG9wOjBweDsgb3ZlcmZsb3cteTogYXV0bztcIj5cclxuICAgICAgICA8ZGl2IGlkPVwicHJhY3RpY2VfaGVhZGVyXCI+PC9kaXY+XHJcbiAgICAgICAgPGRpdiBpZD1cInByYWN0aWNlX2NvbnRlbnRcIiBzdHlsZT1cIm1hcmdpbi10b3A6IDEwcHg7XCI+PC9kaXY+XHJcbiAgICAgICAgPGRpdiBpZD1cInByYWN0aWNlX25hdlwiIHN0eWxlPVwibWFyZ2luLXRvcDogMjBweDsgbWFyZ2luLWJvdHRvbTogMjVweDtcIj48L2Rpdj5cclxuICAgICAgPC9kaXY+XHJcbiAgICBgKTtcclxuICAgICQoXCIjcHJhY3RpY2VfY29udGFpbmVyXCIpLmFwcGVuZChwcmFjdGljZUNvbnRlbnQpO1xyXG4gIFxyXG4gICAgLy8gU2V0IGhlYWRlciBmb3IgdGhlIHByYWN0aWNlIHJvdW5kLlxyXG4gICAgJChcIiNwcmFjdGljZV9oZWFkZXJcIikuaHRtbChgPGgyPlByYWN0aWNlIFJvdW5kICgke3ByYWN0aWNlSW5kZXggKyAxfSBvZiAke3ByYWN0aWNlUXVlc3Rpb25zLmxlbmd0aH0pPC9oMj5gKTtcclxuICBcclxuICAgIC8vIEJ1aWxkIGNvbnRlbnQ6IGltYWdlLCBwcmVkaWN0ZWQgdGV4dCwgYW5kIGlucHV0LlxyXG4gICAgY29uc3QgY29udGVudEh0bWwgPSBgXHJcbiAgICAgIDxkaXYgaWQ9XCJwcmFjdGljZV9xdWVzdGlvbl9kaXNwbGF5XCIgc3R5bGU9XCJtYXJnaW4tdG9wOiAxMHB4O1wiPlxyXG4gICAgICAgIDxpbWcgaWQ9XCJwcmFjdGljZV9xdWVzdGlvbl9pbWFnZVwiIHNyYz1cIlwiIGFsdD1cIlByYWN0aWNlIFF1ZXN0aW9uIEltYWdlXCIgc3R5bGU9XCJtYXgtd2lkdGg6IDEwMCU7IGhlaWdodDogMTEwcHg7IG9iamVjdC1maXQ6IGNvbnRhaW47bWFyZ2luLXRvcDogMjBweDtcIj5cclxuICAgICAgICA8ZGl2IGlkPVwicHJhY3RpY2VfcHJlZGljdGVkX3RleHRfY29udGFpbmVyXCIgc3R5bGU9XCJtYXJnaW4tdG9wOiAyMHB4O1wiPlxyXG4gICAgICAgICAgPGRpdiBzdHlsZT1cIm1hcmdpbi10b3A6IDEwcHg7XCI+UHJlZGljdGVkIFRleHQ6PC9kaXY+XHJcbiAgICAgICAgICA8ZGl2IGlkPVwicHJhY3RpY2VfcHJlZGljdGVkX3RleHRcIiBzdHlsZT1cIm1hcmdpbi10b3A6IDIwcHg7XCI+PC9kaXY+XHJcbiAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgPGRpdiBpZD1cInByYWN0aWNlX3Rva2VuX2lucHV0X2NvbnRhaW5lclwiIHN0eWxlPVwibWFyZ2luLXRvcDogMjBweDtcIj5cclxuICAgICAgICAgIDxpbnB1dCBpZD1cInByYWN0aWNlX3Rva2VuX2lucHV0XCIgdHlwZT1cInRleHRcIiBzdHlsZT1cIndpZHRoOiAxMDAlOyBmb250LXNpemU6IDE2cHg7IHBhZGRpbmc6IDhweDtcIj5cclxuICAgICAgICA8L2Rpdj5cclxuICAgICAgPC9kaXY+XHJcbiAgICBgO1xyXG4gICAgJChcIiNwcmFjdGljZV9jb250ZW50XCIpLmh0bWwoY29udGVudEh0bWwpO1xyXG4gIFxyXG4gICAgLy8gR2V0IHRoZSBjdXJyZW50IHByYWN0aWNlIHF1ZXN0aW9uLlxyXG4gICAgY29uc3QgcXVlc3Rpb24gPSBwcmFjdGljZVF1ZXN0aW9uc1twcmFjdGljZUluZGV4XTtcclxuICBcclxuICAgIC8vIFNldCB0aGUgcXVlc3Rpb24gaW1hZ2UuXHJcbiAgICBpZiAocXVlc3Rpb25bXCJpbWFnZVwiXSkge1xyXG4gICAgICAkKFwiI3ByYWN0aWNlX3F1ZXN0aW9uX2ltYWdlXCIpLmF0dHIoXCJzcmNcIiwgXCJkYXRhOmltYWdlL3BuZztiYXNlNjQsXCIgKyBxdWVzdGlvbltcImltYWdlXCJdKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICQoXCIjcHJhY3RpY2VfcXVlc3Rpb25faW1hZ2VcIikuYXR0cihcInNyY1wiLCBcIlwiKTtcclxuICAgIH1cclxuICBcclxuICAgIC8vIFJlbmRlciBwcmVkaWN0ZWQgdGV4dCB1c2luZyB0b2tlbl9pbmZvLlxyXG4gICAgbGV0IHByZWRpY3RlZEh0bWwgPSBcIlwiO1xyXG4gICAgaWYgKHF1ZXN0aW9uW1widG9rZW5faW5mb1wiXSAmJiBBcnJheS5pc0FycmF5KHF1ZXN0aW9uW1widG9rZW5faW5mb1wiXSkpIHtcclxuICAgICAgcHJlZGljdGVkSHRtbCA9IHF1ZXN0aW9uW1widG9rZW5faW5mb1wiXVxyXG4gICAgICAgIC5maWx0ZXIoaXRlbSA9PiBpdGVtLnRva2VuICE9PSBcIjx8aW1fZW5kfD5cIilcclxuICAgICAgICAubWFwKGl0ZW0gPT4ge1xyXG4gICAgICAgICAgY29uc3QgdG9rZW5UZXh0ID0gaXRlbS50b2tlbi5yZXBsYWNlKC/EoC9nLCBcIiBcIik7XHJcbiAgICAgICAgICBjb25zdCBwcm9iID0gKGl0ZW0udG9wXzVfdG9rZW5zICYmXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW0udG9wXzVfdG9rZW5zWzBdICYmXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGVvZiBpdGVtLnRvcF81X3Rva2Vuc1swXS5wcm9iYWJpbGl0eSA9PT0gXCJudW1iZXJcIilcclxuICAgICAgICAgICAgICAgICAgICAgICAgPyBpdGVtLnRvcF81X3Rva2Vuc1swXS5wcm9iYWJpbGl0eVxyXG4gICAgICAgICAgICAgICAgICAgICAgICA6IDE7XHJcbiAgICAgICAgICAvLyBVc2UgdGhlIGdsb2JhbCBjb25kaXRpb24gZnJvbSB0aGUgbWFpbiBkYXRhIHRvIGRlY2lkZSB3aGV0aGVyIHRvIGFwcGx5IGhpZ2hsaWdodGluZy5cclxuICAgICAgICAgIGlmIChkYXRhW2N1cnJlbnRDb25kaXRpb25JbmRleF0uY29uZGl0aW9uID09PSBcImhpZ2hsaWdodGVkXCIpIHtcclxuICAgICAgICAgICAgY29uc3QgaW50ZW5zaXR5ID0gMSAtIHByb2I7XHJcbiAgICAgICAgICAgIHJldHVybiBgPHNwYW4gc3R5bGU9XCJiYWNrZ3JvdW5kLWNvbG9yOiByZ2JhKDI1NSwgMCwgMCwgJHtpbnRlbnNpdHl9KTtcIj4ke3Rva2VuVGV4dH08L3NwYW4+YDtcclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0b2tlblRleHQ7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSlcclxuICAgICAgICAuam9pbignJyk7XHJcbiAgICB9XHJcbiAgICAkKFwiI3ByYWN0aWNlX3ByZWRpY3RlZF90ZXh0XCIpLmh0bWwocHJlZGljdGVkSHRtbCk7XHJcbiAgXHJcbiAgICAvLyBQcmVwb3B1bGF0ZSB0aGUgdGV4dCBpbnB1dC5cclxuICAgIGxldCB0b2tlbnNDb25jYXRlbmF0ZWQgPSBcIlwiO1xyXG4gICAgaWYgKHF1ZXN0aW9uW1widG9rZW5faW5mb1wiXSAmJiBBcnJheS5pc0FycmF5KHF1ZXN0aW9uW1widG9rZW5faW5mb1wiXSkpIHtcclxuICAgICAgdG9rZW5zQ29uY2F0ZW5hdGVkID0gcXVlc3Rpb25bXCJ0b2tlbl9pbmZvXCJdXHJcbiAgICAgICAgLm1hcChpdGVtID0+IGl0ZW0udG9rZW4pXHJcbiAgICAgICAgLmZpbHRlcih0b2tlbiA9PiB0b2tlbiAhPT0gXCI8fGltX2VuZHw+XCIpXHJcbiAgICAgICAgLm1hcCh0b2tlbiA9PiB0b2tlbi5yZXBsYWNlKC/EoC9nLCBcIiBcIikpXHJcbiAgICAgICAgLmpvaW4oJycpO1xyXG4gICAgfVxyXG4gICAgJChcIiNwcmFjdGljZV90b2tlbl9pbnB1dFwiKS52YWwodG9rZW5zQ29uY2F0ZW5hdGVkKTtcclxuICBcclxuICAgIC8vIEJ1aWxkIG5hdmlnYXRpb24gYnV0dG9ucy5cclxuICAgIGNvbnN0IG5hdkh0bWwgPSBgXHJcbiAgICAgIDxkaXY+XHJcbiAgICAgICAgPGlucHV0IGlkPVwicHJhY3RpY2VfcHJldlwiIHR5cGU9XCJidXR0b25cIiB2YWx1ZT1cIlByZXZpb3VzIEV4YW1wbGVcIj5cclxuICAgICAgICA8aW5wdXQgaWQ9XCJwcmFjdGljZV9uZXh0XCIgdHlwZT1cImJ1dHRvblwiIHZhbHVlPVwiTmV4dCBFeGFtcGxlXCIgc3R5bGU9XCJtYXJnaW4tbGVmdDogMTBweDtcIj5cclxuICAgICAgPC9kaXY+XHJcbiAgICBgO1xyXG4gICAgJChcIiNwcmFjdGljZV9uYXZcIikuaHRtbChuYXZIdG1sKTtcclxuICBcclxuICAgIC8vIEF0dGFjaCBidXR0b24gaGFuZGxlcnMuXHJcbiAgICAkKFwiI3ByYWN0aWNlX3ByZXZcIikub2ZmKFwiY2xpY2tcIikub24oXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgIHByYWN0aWNlSW5kZXggPSAocHJhY3RpY2VJbmRleCAtIDEgKyBwcmFjdGljZVF1ZXN0aW9ucy5sZW5ndGgpICUgcHJhY3RpY2VRdWVzdGlvbnMubGVuZ3RoO1xyXG4gICAgICBzaG93UHJhY3RpY2VSb3VuZChvbkNvbXBsZXRlKTtcclxuICAgIH0pO1xyXG4gICAgJChcIiNwcmFjdGljZV9uZXh0XCIpLm9mZihcImNsaWNrXCIpLm9uKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICBwcmFjdGljZUluZGV4ID0gKHByYWN0aWNlSW5kZXggKyAxKSAlIHByYWN0aWNlUXVlc3Rpb25zLmxlbmd0aDtcclxuICAgICAgc2hvd1ByYWN0aWNlUm91bmQob25Db21wbGV0ZSk7XHJcbiAgICB9KTtcclxuICB9XHJcbiAgXHJcblxyXG5cclxuLyogTmV3IGZ1bmN0aW9uOiBTaG93IGVuZC1vZi1jb25kaXRpb24gcGFnZSAqL1xyXG5mdW5jdGlvbiBzaG93RW5kQ29uZGl0aW9uUGFnZShjb25kaXRpb246IHN0cmluZykge1xyXG4gICAgJChcIiNtYWluX2JveF9leHBlcmltZW50XCIpLmhpZGUoKTtcclxuICAgIGNvbnN0IGN1cnJlbnRDb25kaXRpb24gPSBkYXRhW2N1cnJlbnRDb25kaXRpb25JbmRleF0uY29uZGl0aW9uO1xyXG4gICAgJChcIiNjb25kaXRpb25fbGFiZWxcIikudGV4dChjdXJyZW50Q29uZGl0aW9uKTtcclxuICAgIC8vIFJlc2V0IGVhY2ggc2xpZGVyIHRvIGEgZGVmYXVsdCwgZS5nLiwgMFxyXG4gICAgJChcIiNtZW50YWxfZGVtYW5kXCIpLnZhbChcIjBcIik7XHJcbiAgICAkKFwiI2h1cnJpZWRfZGVtYW5kXCIpLnZhbChcIjBcIik7XHJcbiAgICAkKFwiI3BlcmZvcm1hbmNlXCIpLnZhbChcIjBcIik7XHJcbiAgICAkKFwiI2VmZm9ydFwiKS52YWwoXCIwXCIpO1xyXG4gICAgJChcIiNmcnVzdHJhdGlvblwiKS52YWwoXCIwXCIpO1xyXG5cclxuICAgICQoXCIjbmFzYV90bHhfc3VydmV5XCIpLnNob3coKTtcclxuICAgXHJcbn1cclxuXHJcblxyXG5cclxuZnVuY3Rpb24gbmV4dF9xdWVzdGlvbigpIHtcclxuICAgIC8vIHJlc3RvcmUgcHJldmlvdXMgc3RhdGUgb2YgVUlcclxuICAgICQoXCIjbWFpbl9ib3hfZXhwZXJpbWVudFwiKS5zaG93KCk7XHJcbiAgICAkKFwiI2J1dHRvbl9uZXh0XCIpLmhpZGUoKVxyXG4gICAgJCgnI2J1dHRvbl9xdWl0JykuaGlkZSgpXHJcbiAgICAvLyQoXCIjcmFuZ2VfdmFsXCIpLnZhbCh1c2VyX3RydXN0KVxyXG4gICAgY29uc29sZS5sb2coXCJxdWVzdGlvbiBpbmRleCwgY29uZGl0aW9uIGluZGV4XCIsIGN1cnJlbnRRdWVzdGlvbkluZGV4LCBjdXJyZW50Q29uZGl0aW9uSW5kZXgpICAgICAgICBcclxuXHJcbiAgICBpZiAoY3VycmVudENvbmRpdGlvbkluZGV4ID49IGRhdGEubGVuZ3RoKSB7XHJcbiAgICAgICAgJChcIiNtYWluX2JveF9leHBlcmltZW50XCIpLmhpZGUoKTtcclxuICAgICAgICAkKFwiI3F1YWxpdGF0aXZlX3NlY3Rpb25cIikuc2hvdygpO1xyXG4gICAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIGxldCBjb25kaXRpb25CbG9jayA9IGRhdGFbY3VycmVudENvbmRpdGlvbkluZGV4XTtcclxuICAgIGNvbnNvbGUubG9nKFwiQ29uZGl0aW9uIGJsb2NrXCIsIGNvbmRpdGlvbkJsb2NrKVxyXG4gICAgY29uc29sZS5sb2coZGF0YSlcclxuXHJcbiAgICAvLyBJZiB3ZSBhcmUgYXQgdGhlIHN0YXJ0IHBhZ2UgZm9yIHRoaXMgY29uZGl0aW9uLCBzaG93IGl0LlxyXG4gICAgaWYgKGN1cnJlbnRRdWVzdGlvbkluZGV4ID09PSAwKSB7XHJcbiAgICAgICAgc2hvd1N0YXJ0Q29uZGl0aW9uUGFnZShjb25kaXRpb25CbG9jay5jb25kaXRpb24pO1xyXG4gICAgICAgIHJldHVybjtcclxuICAgIH1cclxuXHJcbiAgICAvLyBJZiB3ZSd2ZSBnb25lIHBhc3QgYWxsIHF1ZXN0aW9ucyBpbiB0aGlzIGNvbmRpdGlvbiwgc2hvdyB0aGUgZW5kLW9mLWNvbmRpdGlvbiBwYWdlLlxyXG4gICAgaWYgKGN1cnJlbnRRdWVzdGlvbkluZGV4ID4gY29uZGl0aW9uQmxvY2sucXVlc3Rpb25zLmxlbmd0aCkge1xyXG4gICAgICAgIHNob3dFbmRDb25kaXRpb25QYWdlKGNvbmRpdGlvbkJsb2NrLmNvbmRpdGlvbik7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG5cclxuXHJcbiAgICBxdWVzdGlvbiA9IGNvbmRpdGlvbkJsb2NrLnF1ZXN0aW9uc1tjdXJyZW50UXVlc3Rpb25JbmRleCAtIDFdO1xyXG4gICAgY29uc29sZS5sb2coXCJRdWVzdGlvblwiLCBjdXJyZW50UXVlc3Rpb25JbmRleCwgcXVlc3Rpb24pXHJcbiAgICBcclxuICAgIFxyXG4gICAgLy8gLS0tIFVwZGF0ZSBQYXJ0IDEgZWxlbWVudHMgLS0tXHJcbiAgICAvLyBGb3IgdGhlIGltYWdlOiBhc3N1bWUgYSB2YWxpZCBCYXNlNjQgc3RyaW5nIGZvciBub3cuXHJcbiAgICBpZiAocXVlc3Rpb25bXCJpbWFnZVwiXSkge1xyXG4gICAgICAkKFwiI3F1ZXN0aW9uX2ltYWdlXCIpLmF0dHIoXCJzcmNcIiwgXCJkYXRhOmltYWdlL3BuZztiYXNlNjQsXCIgKyBxdWVzdGlvbltcImltYWdlXCJdKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICQoXCIjcXVlc3Rpb25faW1hZ2VcIikuYXR0cihcInNyY1wiLCBcIlwiKTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8gRGlzcGxheSB0aGUgcHJlZGljdGVkIHRleHQuXHJcbiAgICAvLyBCdWlsZCB0aGUgcHJlZGljdGVkIHRleHQgSFRNTCBieSBjb25jYXRlbmF0aW5nIHRva2VuX2luZm9cclxuICAgIGxldCBwcmVkaWN0ZWRIdG1sID0gXCJcIjtcclxuICAgIGlmIChxdWVzdGlvbltcInRva2VuX2luZm9cIl0gJiYgQXJyYXkuaXNBcnJheShxdWVzdGlvbltcInRva2VuX2luZm9cIl0pKSB7XHJcbiAgICAgICAgcHJlZGljdGVkSHRtbCA9IHF1ZXN0aW9uW1widG9rZW5faW5mb1wiXVxyXG4gICAgICAgICAgICAvLyBTa2lwIHRoZSBlbmQgdG9rZW5cclxuICAgICAgICAgICAgLmZpbHRlcihpdGVtID0+IGl0ZW0udG9rZW4gIT09IFwiPHxpbV9lbmR8PlwiKVxyXG4gICAgICAgICAgICAubWFwKGl0ZW0gPT4ge1xyXG4gICAgICAgICAgICAgICAgLy8gUmVwbGFjZSB0aGUgc3BlY2lhbCBcIsSgXCIgY2hhcmFjdGVyIHdpdGggYSBzcGFjZVxyXG4gICAgICAgICAgICAgICAgbGV0IHRva2VuVGV4dCA9IGl0ZW0udG9rZW4ucmVwbGFjZSgvxKAvZywgXCIgXCIpO1xyXG4gICAgICAgICAgICAgICAgLy8gR2V0IHRoZSBwcm9iYWJpbGl0eSBmcm9tIHRoZSBmaXJzdCBjYW5kaWRhdGUgaW4gdG9wXzVfdG9rZW5zLlxyXG4gICAgICAgICAgICAgICAgLy8gSWYgbm90IGF2YWlsYWJsZSwgZGVmYXVsdCB0byAxIChubyBoaWdobGlnaHQpLlxyXG4gICAgICAgICAgICAgICAgbGV0IHByb2IgPSAoaXRlbS50b3BfNV90b2tlbnMgJiZcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW0udG9wXzVfdG9rZW5zWzBdICYmXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlb2YgaXRlbS50b3BfNV90b2tlbnNbMF0ucHJvYmFiaWxpdHkgPT09IFwibnVtYmVyXCIpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IGl0ZW0udG9wXzVfdG9rZW5zWzBdLnByb2JhYmlsaXR5XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IDE7XHJcbiAgICAgICAgICAgICAgICAvLyBDb21wdXRlIHRoZSBoaWdobGlnaHQgaW50ZW5zaXR5ICgwIGlmIHByb2JhYmlsaXR5IGlzIDEsIDEgaWYgcHJvYmFiaWxpdHkgaXMgMClcclxuICAgICAgICAgICAgICAgIGxldCBpbnRlbnNpdHkgPSAxIC0gcHJvYjtcclxuICAgICAgICAgICAgICAgIC8vIENyZWF0ZSBhIHNwYW4gd2l0aCByZWQgYmFja2dyb3VuZDsgYWRqdXN0IHRoZSBvcGFjaXR5IGJ5IGludGVuc2l0eS5cclxuICAgICAgICAgICAgICAgIGlmIChkYXRhW2N1cnJlbnRDb25kaXRpb25JbmRleF0uY29uZGl0aW9uID09IFwiaGlnaGxpZ2h0ZWRcIikge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBgPHNwYW4gc3R5bGU9XCJiYWNrZ3JvdW5kLWNvbG9yOiByZ2JhKDI1NSwgMCwgMCwgJHtpbnRlbnNpdHl9KTtcIj4ke3Rva2VuVGV4dH08L3NwYW4+YDtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRva2VuVGV4dDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLmpvaW4oJycpO1xyXG4gICAgfVxyXG4gICAgJChcIiNwcmVkaWN0ZWRfdGV4dFwiKS5odG1sKHByZWRpY3RlZEh0bWwpO1xyXG4gICAgICBcclxuICAgIFxyXG4gICAgLy8gQ29uY2F0ZW5hdGUgdG9rZW5zICh3aXRoIHJlcGxhY2VtZW50IG9mIMSgIGFuZCBza2lwcGluZyA8fGltX2VuZHw+KS5cclxuICAgIGxldCB0b2tlbnNDb25jYXRlbmF0ZWQgPSBcIlwiO1xyXG4gICAgaWYgKHF1ZXN0aW9uW1widG9rZW5faW5mb1wiXSAmJiBBcnJheS5pc0FycmF5KHF1ZXN0aW9uW1widG9rZW5faW5mb1wiXSkpIHtcclxuICAgICAgICB0b2tlbnNDb25jYXRlbmF0ZWQgPSBxdWVzdGlvbltcInRva2VuX2luZm9cIl1cclxuICAgICAgICAgIC5tYXAoaXRlbSA9PiBpdGVtLnRva2VuKVxyXG4gICAgICAgICAgLmZpbHRlcih0b2tlbiA9PiB0b2tlbiAhPT0gXCI8fGltX2VuZHw+XCIpXHJcbiAgICAgICAgICAubWFwKHRva2VuID0+IHRva2VuLnJlcGxhY2UoL8SgL2csIFwiIFwiKSlcclxuICAgICAgICAgIC5qb2luKCcnKTtcclxuICAgIH1cclxuICAgICQoXCIjdG9rZW5faW5wdXRcIikudmFsKHRva2Vuc0NvbmNhdGVuYXRlZCk7XHJcbiAgICBcclxuICAgIC8vIChVcGRhdGUgcHJvZ3Jlc3MgYW5kIG90aGVyIGVsZW1lbnRzIGFzIG5lY2Vzc2FyeSlcclxuICAgICQoXCIjcHJvZ3Jlc3NcIikudGV4dChgU2VjdGlvbiAke2N1cnJlbnRDb25kaXRpb25JbmRleCArIDF9IG9mICR7ZGF0YS5sZW5ndGh9IHwgUXVlc3Rpb24gJHtjdXJyZW50UXVlc3Rpb25JbmRleH0gb2YgJHtjb25kaXRpb25CbG9jay5xdWVzdGlvbnMubGVuZ3RofWApO1xyXG4gICAgICAgIC8vIEFsd2F5cyBzaG93IFBhcnQgMSBhbmQgaGlkZSBQYXJ0IDIgd2hlbiBhIG5ldyBxdWVzdGlvbiBsb2Fkcy5cclxuICAgICAgICAkKFwiI3BhcnQxXCIpLnNob3coKTtcclxuICAgICAgICAkKFwiI3BhcnQyXCIpLmhpZGUoKTtcclxuICAgIFxyXG4vLyBBdCB0aGUgZW5kIG9mIG5leHRfcXVlc3Rpb24oKSwgYWZ0ZXIgdXBkYXRpbmcgYWxsIFBhcnQgMSBlbGVtZW50czpcclxuJChcIiN0b2tlbl9pbnB1dF9jb250YWluZXJcIikuaGlkZSgpO1xyXG4kKFwiI2J1dHRvbl9uZXh0X3BhcnQxXCIpLmhpZGUoKTtcclxuXHJcbi8vIFN0YXJ0IGEgMjAtc2Vjb25kIHRpbWVyIGZvciBQYXJ0IDFcclxuY2xlYXJUaW1lb3V0KHBhcnQxVGltZXIpO1xyXG5wYXJ0MVRpbWVyID0gd2luZG93LnNldFRpbWVvdXQoYXV0b1N1Ym1pdFBhcnQxLCAyMDAwMCk7XHJcblxyXG4vLyBSZXNldCBhbmQgc3RhcnQgdGhlIHRpbWVyIGZvciBQYXJ0IDFcclxucmVtYWluaW5nVGltZSA9IDIwO1xyXG4kKFwiI3RpbWVyXCIpLnRleHQocmVtYWluaW5nVGltZSk7XHJcbiQoXCIjdGltZXJcIikuc2hvdygpO1xyXG5cclxuLy8gQ2xlYXIgYW55IHByZXZpb3VzIGludGVydmFsXHJcbmlmIChwYXJ0MUludGVydmFsKSB7XHJcbiAgICBjbGVhckludGVydmFsKHBhcnQxSW50ZXJ2YWwpO1xyXG59XHJcblxyXG4vLyBTdGFydCBhIG5ldyBpbnRlcnZhbCB0aGF0IGNvdW50cyBkb3duIGV2ZXJ5IHNlY29uZFxyXG5wYXJ0MUludGVydmFsID0gd2luZG93LnNldEludGVydmFsKCgpID0+IHtcclxuICAgIHJlbWFpbmluZ1RpbWUgLT0gMTtcclxuICAgICQoXCIjdGltZXJcIikudGV4dChyZW1haW5pbmdUaW1lKTtcclxuXHJcbiAgICAvLyBXaGVuIHRoZXJlIGFyZSAxNSBzZWNvbmRzIG9yIGxlc3MgcmVtYWluaW5nLCBzaG93IHRoZSBpbnB1dCBib3ggYW5kIE5leHQgYnV0dG9uXHJcbiAgICBpZiAocmVtYWluaW5nVGltZSA8PSAxNSkge1xyXG4gICAgICAgICQoXCIjdG9rZW5faW5wdXRfY29udGFpbmVyXCIpLnNob3coKTtcclxuICAgICAgICAkKFwiI2J1dHRvbl9uZXh0X3BhcnQxXCIpLnNob3coKTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAocmVtYWluaW5nVGltZSA8PSAwKSB7XHJcbiAgICAgICAgY2xlYXJJbnRlcnZhbChwYXJ0MUludGVydmFsKTtcclxuICAgICAgICBhdXRvU3VibWl0UGFydDEoKTtcclxuICAgICAgICAkKFwiI3RpbWVyXCIpLmhpZGUoKTtcclxuICAgIH1cclxufSwgMTAwMCk7XHJcblxyXG5cclxufVxyXG5cclxuLy8gZ2V0IHVzZXIgaWQgYW5kIGxvYWQgcXVldWVcclxuLy8gdHJ5IHRvIHNlZSBpZiBzdGFydCBvdmVycmlkZSB3YXMgcGFzc2VkXHJcbmNvbnN0IHVybFBhcmFtcyA9IG5ldyBVUkxTZWFyY2hQYXJhbXMod2luZG93LmxvY2F0aW9uLnNlYXJjaCk7XHJcbmNvbnN0IHN0YXJ0T3ZlcnJpZGUgPSB1cmxQYXJhbXMuZ2V0KCdzdGFydCcpO1xyXG5jb25zdCBVSURGcm9tVVJMID0gdXJsUGFyYW1zLmdldChcInVpZFwiKVxyXG5nbG9iYWxUaGlzLnVybF9kYXRhID0gcGFyYW1zVG9PYmplY3QodXJsUGFyYW1zLmVudHJpZXMoKSlcclxuXHJcbmlmIChnbG9iYWxUaGlzLnVybF9kYXRhWydzdHVkeV9pZCddID09IG51bGwpIHtcclxuICAgIGdsb2JhbFRoaXMudXJsX2RhdGFbJ3N0dWR5X2lkJ10gPSBcImRlbW9fc3R1ZHlcIlxyXG59XHJcbmlmIChnbG9iYWxUaGlzLnVybF9kYXRhWydwcm9saWZpY19pZCddID09IG51bGwpIHtcclxuICAgIGdsb2JhbFRoaXMudXJsX2RhdGFbJ3Byb2xpZmljX2lkJ10gPSBcImRlbW9fdXNlclwiXHJcbn1cclxuaWYgKGdsb2JhbFRoaXMudXJsX2RhdGFbJ3Nlc3Npb25faWQnXSA9PSBudWxsKSB7XHJcbiAgICBnbG9iYWxUaGlzLnVybF9kYXRhWydzZXNzaW9uX2lkJ10gPSBcImRlbW9fc2Vzc2lvblwiXHJcbn1cclxuXHJcbmlmIChVSURGcm9tVVJMICE9IG51bGwpIHtcclxuICAgIGdsb2JhbFRoaXMudWlkID0gVUlERnJvbVVSTCBhcyBzdHJpbmdcclxuICAgIGlmIChnbG9iYWxUaGlzLnVpZCA9PSBcInByb2xpZmljX3JhbmRvbVwiKSB7XHJcbiAgICAgICAgbGV0IHF1ZXVlX2lkID0gYCR7TWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTApfWAucGFkU3RhcnQoMywgXCIwXCIpXHJcbiAgICAgICAgZ2xvYmFsVGhpcy51aWQgPSBgJHt1cmxQYXJhbXMuZ2V0KFwicHJvbGlmaWNfcXVldWVfbmFtZVwiKX0vJHtxdWV1ZV9pZH1gXHJcbiAgICB9XHJcbn0gZWxzZSBpZiAoREVWTU9ERSkge1xyXG4gICAgZ2xvYmFsVGhpcy51aWQgPSBcImRlbW9cIlxyXG59IGVsc2Uge1xyXG4gICAgbGV0IFVJRF9tYXliZTogYW55ID0gbnVsbFxyXG4gICAgd2hpbGUgKFVJRF9tYXliZSA9PSBudWxsKSB7XHJcbiAgICAgICAgVUlEX21heWJlID0gcHJvbXB0KFwiRW50ZXIgeW91ciB1c2VyIGlkLiBQbGVhc2UgZ2V0IGluIHRvdWNoIGlmIHlvdSB3ZXJlIG5vdCBhc3NpZ25lZCBhbiBpZCBidXQgd2lzaCB0byBwYXJ0aWNpcGF0ZSBpbiB0aGlzIGV4cGVyaW1lbnQuXCIpXHJcbiAgICB9XHJcbiAgICBnbG9iYWxUaGlzLnVpZCA9IFVJRF9tYXliZSFcclxufVxyXG5cclxuLy8gdmVyc2lvbiBmb3IgcGFwZXJcclxuaWYgKERFVk1PREUpIHtcclxuICAgIE1PQ0tNT0RFID0gdHJ1ZVxyXG59IGVsc2UgaWYgKGdsb2JhbFRoaXMudXJsX2RhdGFbJ3Nlc3Npb25faWQnXS5zdGFydHNXaXRoKFwiZGVtb1wiKSkge1xyXG4gICAgTU9DS01PREUgPSB0cnVlXHJcbn1cclxuXHJcbmNvbnNvbGUubG9nKFwiUnVubmluZyB3aXRoIFVJRFwiLCBnbG9iYWxUaGlzLnVpZClcclxubG9hZF9kYXRhKCkuY2F0Y2goKF9lcnJvcikgPT4ge1xyXG4gICAgLy9hbGVydChcIkludmFsaWQgdXNlciBpZC5cIilcclxuICAgIGNvbnNvbGUubG9nKFwiSW52YWxpZCB1c2VyIGlkLlwiKVxyXG4gICAgY29uc29sZS5sb2coZ2xvYmFsVGhpcy51aWQhKVxyXG4gICAgd2luZG93LmxvY2F0aW9uLnJlbG9hZCgpXHJcbn1cclxuKS50aGVuKChuZXdfZGF0YSkgPT4ge1xyXG4gICAgZGF0YSA9IG5ld19kYXRhXHJcbiAgICBpZiAoc3RhcnRPdmVycmlkZSAhPSBudWxsKSB7XHJcbiAgICAgICAgY3VycmVudFF1ZXN0aW9uSW5kZXggPSBwYXJzZUludChzdGFydE92ZXJyaWRlKSAtIDFcclxuICAgICAgICBjb25zb2xlLmxvZyhcIlN0YXJ0aW5nIGZyb21cIiwgY3VycmVudFF1ZXN0aW9uSW5kZXgpXHJcbiAgICB9XHJcbiAgICAvLyBuZXh0X3F1ZXN0aW9uKClcclxuICAgIG5leHRfaW5zdHJ1Y3Rpb25zKDApXHJcbiAgICAkKFwiI21haW5fYm94X2luc3RydWN0aW9uc1wiKS5zaG93KClcclxuICAgICQoXCIjaW5zdHJ1Y3Rpb25zX2FuZF9kZWNvcmF0aW9uc1wiKS5oaWRlKClcclxufSlcclxuXHJcbmNvbnNvbGUubG9nKFwiU3RhcnRpbmcgc2Vzc2lvbiB3aXRoIFVJRDpcIiwgZ2xvYmFsVGhpcy51aWQhKVxyXG5cclxubGV0IGFsZXJ0X2FjdGl2ZSA9IGZhbHNlXHJcbmRvY3VtZW50Lm9udmlzaWJpbGl0eWNoYW5nZSA9ICgpID0+IHtcclxuICAgIGlmICghYWxlcnRfYWN0aXZlKSB7XHJcbiAgICAgICAgY291bnRfZXhpdGVkX3BhZ2UgKz0gMVxyXG4gICAgICAgIGFsZXJ0X2FjdGl2ZSA9IHRydWVcclxuICAgICAgICAvL2lmICghKGdsb2JhbFRoaXMudWlkIS5zdGFydHNXaXRoKFwiZGVtb1wiKSkpIHtcclxuICAgICAgICAvLyAgICBhbGVydChcIlBsZWFzZSBkb24ndCBsZWF2ZSB0aGUgcGFnZS4gSWYgeW91IGRvIHNvIGFnYWluLCB3ZSBtYXkgcmVzdHJpY3QgcGF5aW5nIHlvdS5cIilcclxuICAgICAgICAvL31cclxuICAgICAgICBhbGVydF9hY3RpdmUgPSBmYWxzZVxyXG4gICAgfVxyXG59XHJcblxyXG4vLyBXaGVuIHRoZSBET00gaXMgcmVhZHk6XHJcbiQoZG9jdW1lbnQpLnJlYWR5KCgpID0+IHtcclxuICAgIC8vIFRyYW5zaXRpb24gZnJvbSBQYXJ0IDEgKHF1ZXN0aW9uKSB0byBQYXJ0IDIgKGNvbmZpZGVuY2UgcmF0aW5nKVxyXG4gICAgJChcIiNidXR0b25fbmV4dF9wYXJ0MVwiKS5vbihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgLy8gT3B0aW9uYWxseSwgbG9nIG9yIHNhdmUgYW55IFBhcnQgMSBkYXRhIGhlcmUuXHJcbiAgICAgIGNsZWFyVGltZW91dChwYXJ0MVRpbWVyKTtcclxuICAgICAgJChcIiN0aW1lclwiKS5oaWRlKCk7XHJcblxyXG5cclxuICAgICAgJChcIiNwYXJ0MVwiKS5oaWRlKCk7XHJcbiAgICAgICQoXCIjcGFydDJcIikuc2hvdygpO1xyXG4gICAgfSk7XHJcbiAgXHJcbiAgICAvLyBIYW5kbGUgY29uZmlkZW5jZSByYXRpbmcgc2VsZWN0aW9uczpcclxuICAgICQoXCIuY29uZmlkZW5jZS1idXR0b25cIikub24oXCJjbGlja1wiLCBmdW5jdGlvbigpIHtcclxuICAgICAgICBsZXQgcmF0aW5nID0gcGFyc2VJbnQoJCh0aGlzKS5hdHRyKFwiZGF0YS1yYXRpbmdcIikgYXMgc3RyaW5nKTtcclxuICAgICAgICAvLyBSZW1vdmUgJ3NlbGVjdGVkJyBmcm9tIGFsbCBidXR0b25zLCB0aGVuIGFkZCBpdCB0byB0aGUgY2xpY2tlZCBvbmUuXHJcbiAgICAgICAgJChcIi5jb25maWRlbmNlLWJ1dHRvblwiKS5yZW1vdmVDbGFzcyhcInNlbGVjdGVkXCIpO1xyXG4gICAgICAgICQodGhpcykuYWRkQ2xhc3MoXCJzZWxlY3RlZFwiKTtcclxuICAgICAgICAvLyBTdG9yZSB0aGUgcmF0aW5nIGFuZCBlbmFibGUgdGhlIFBhcnQgMiBOZXh0IGJ1dHRvbi5cclxuICAgICAgICBjb25maWRlbmNlUmF0aW5nID0gcmF0aW5nO1xyXG4gICAgICAgICQoXCIjYnV0dG9uX25leHRfcGFydDJcIikucmVtb3ZlQXR0cihcImRpc2FibGVkXCIpO1xyXG4gICAgfSk7XHJcbiAgXHJcbiAgICAvLyBUcmFuc2l0aW9uIGZyb20gUGFydCAyIChjb25maWRlbmNlIHJhdGluZykgdG8gdGhlIG5leHQgcXVlc3Rpb24uXHJcbiAgICAkKFwiI2J1dHRvbl9uZXh0X3BhcnQyXCIpLm9uKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICAvLyBMb2cgdGhlIGNvbmZpZGVuY2UgcmF0aW5nIGFsb25nIHdpdGggb3RoZXIgZGF0YSBpZiBuZWVkZWQuXHJcbiAgICAgIGxldCBsb2dnZWRfZGF0YSA9IHtcclxuICAgICAgICBcInF1ZXN0aW9uX2lcIjogY3VycmVudFF1ZXN0aW9uSW5kZXgsXHJcbiAgICAgICAgXCJjb25kaXRpb25faVwiOiBjdXJyZW50Q29uZGl0aW9uSW5kZXgsXHJcbiAgICAgICAgXCJjb25maWRlbmNlX3JhdGluZ1wiOiBjb25maWRlbmNlUmF0aW5nLFxyXG4gICAgICAgIC8vIC4uLiBpbmNsdWRlIG90aGVyIGxvZ2dpbmcgZmllbGRzIGFzIGRlc2lyZWRcclxuICAgICAgfTtcclxuICAgICAgbG9nX2RhdGEobG9nZ2VkX2RhdGEpO1xyXG4gICAgICBcclxuICAgICAgLy8gUmVzZXQgUGFydCAyIFVJIGVsZW1lbnRzIGZvciB0aGUgbmV4dCBxdWVzdGlvbi5cclxuICAgICAgJChcIiNidXR0b25fbmV4dF9wYXJ0MlwiKS5hdHRyKFwiZGlzYWJsZWRcIiwgXCJ0cnVlXCIpO1xyXG4gICAgICAkKFwiLmNvbmZpZGVuY2UtYnV0dG9uXCIpLnJlbW92ZUNsYXNzKFwic2VsZWN0ZWRcIik7XHJcbiAgICAgIGNvbmZpZGVuY2VSYXRpbmcgPSAtMTtcclxuICAgICAgXHJcbiAgICAgIC8vIFN3aXRjaCBiYWNrIHRvIFBhcnQgMSBhbmQgbG9hZCB0aGUgbmV4dCBxdWVzdGlvbi5cclxuICAgICAgJChcIiNwYXJ0MlwiKS5oaWRlKCk7XHJcbiAgICAgICQoXCIjcGFydDFcIikuc2hvdygpO1xyXG4gICAgICBjdXJyZW50UXVlc3Rpb25JbmRleCsrO1xyXG4gICAgICBuZXh0X3F1ZXN0aW9uKCk7XHJcbiAgICB9KTtcclxuICAgICQoXCJpbnB1dFtuYW1lPSdsYXRleEV4cGVyaWVuY2UnXSwgaW5wdXRbbmFtZT0nbGF0ZXhGcmVxdWVuY3knXSwgaW5wdXRbbmFtZT0nY2hhdGJvdEZyZXF1ZW5jeSddXCIpLm9uKFwiY2hhbmdlXCIsICgpID0+IHtcclxuICAgICAgICBpZihjaGVja1ByZVN1cnZleSgpKSB7XHJcbiAgICAgICAgICAgICQoXCIjYnV0dG9uX2luc3RydWN0aW9uc19uZXh0XCIpLnJlbW92ZUF0dHIoXCJkaXNhYmxlZFwiKVxyXG4gICAgICAgICAgICAkKFwiI2J1dHRvbl9pbnN0cnVjdGlvbnNfbmV4dFwiKS5zaG93KCkgICAgICAgICAgICBcclxuICAgICAgICB9XHJcblxyXG4gICAgfSk7XHJcbiAgICAvLyBrZXlsb2cgdGhlIGlucHV0XHJcbiAgICAkKFwiI3Rva2VuX2lucHV0XCIpLm9uKFwiaW5wdXRcIiwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgbGV0IGN1cnJlbnRUZXh0ID0gJCh0aGlzKS52YWwoKTtcclxuICAgICAgICBjb25zb2xlLmxvZyhcIlVzZXIgaW5wdXQ6XCIsIGN1cnJlbnRUZXh0KTtcclxuICAgIH1cclxuICAgICk7XHJcblxyXG4gICAgLy8gRGVmaW5lIGFuIGludGVyZmFjZSBmb3Igc2xpZGVyIHRyYWNraW5nXHJcbmludGVyZmFjZSBTbGlkZXJTdGF0ZSB7XHJcbiAgICBtZW50YWxfZGVtYW5kOiBib29sZWFuO1xyXG4gICAgaHVycmllZF9kZW1hbmQ6IGJvb2xlYW47XHJcbiAgICBwZXJmb3JtYW5jZTogYm9vbGVhbjtcclxuICAgIGVmZm9ydDogYm9vbGVhbjtcclxuICAgIGZydXN0cmF0aW9uOiBib29sZWFuO1xyXG59XHJcblxyXG4vLyBJbml0aWFsaXplIHRyYWNraW5nIG9iamVjdFxyXG5jb25zdCBzbGlkZXJDaGFuZ2VkOiBTbGlkZXJTdGF0ZSA9IHtcclxuICAgIG1lbnRhbF9kZW1hbmQ6IGZhbHNlLFxyXG4gICAgaHVycmllZF9kZW1hbmQ6IGZhbHNlLFxyXG4gICAgcGVyZm9ybWFuY2U6IGZhbHNlLFxyXG4gICAgZWZmb3J0OiBmYWxzZSxcclxuICAgIGZydXN0cmF0aW9uOiBmYWxzZVxyXG59O1xyXG5cclxuLy8gRnVuY3Rpb24gdG8gY2hlY2sgaWYgYWxsIHNsaWRlcnMgaGF2ZSBiZWVuIGFkanVzdGVkXHJcbmZ1bmN0aW9uIGNoZWNrQWxsU2xpZGVyc0NoYW5nZWQoKTogYm9vbGVhbiB7XHJcbiAgICByZXR1cm4gT2JqZWN0LnZhbHVlcyhzbGlkZXJDaGFuZ2VkKS5ldmVyeSh2YWx1ZSA9PiB2YWx1ZSA9PT0gdHJ1ZSk7XHJcbn1cclxuZnVuY3Rpb24gcmVzZXRTbGlkZXJzKCkge1xyXG4gICAgLy8gUmVzZXQgdHJhY2tpbmcgb2JqZWN0XHJcbiAgICBmb3IgKGxldCBrZXkgaW4gc2xpZGVyQ2hhbmdlZCkge1xyXG4gICAgICAgIHNsaWRlckNoYW5nZWRba2V5IGFzIGtleW9mIFNsaWRlclN0YXRlXSA9IGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFJlc2V0IHNsaWRlciB2YWx1ZXMgdG8gMFxyXG4gICAgJChcIi5uYXNhLXRseC1yYW5nZVwiKS52YWwoXCIwXCIpO1xyXG5cclxuICAgIC8vIERpc2FibGUgdGhlIFwiTmV4dFwiIGJ1dHRvbiBhZ2FpblxyXG4gICAgbmV4dEJ1dHRvbi5wcm9wKFwiZGlzYWJsZWRcIiwgdHJ1ZSk7XHJcbn1cclxuXHJcbi8vIERpc2FibGUgdGhlIFwiTmV4dFwiIGJ1dHRvbiBpbml0aWFsbHlcclxuY29uc3QgbmV4dEJ1dHRvbiA9ICQoXCIjbmFzYV90bHhfbmV4dFwiKSBhcyBKUXVlcnk8SFRNTElucHV0RWxlbWVudD47XHJcbm5leHRCdXR0b24ucHJvcChcImRpc2FibGVkXCIsIHRydWUpO1xyXG5cclxuLy8gRXZlbnQgbGlzdGVuZXIgZm9yIGFsbCBzbGlkZXJzXHJcbiQoXCIubmFzYS10bHgtcmFuZ2VcIikub24oXCJpbnB1dFwiLCBmdW5jdGlvbiAoKSB7XHJcbiAgICBjb25zdCBzbGlkZXJJZCA9ICQodGhpcykuYXR0cihcImlkXCIpIGFzIGtleW9mIFNsaWRlclN0YXRlO1xyXG4gICAgXHJcbiAgICAvLyBFbnN1cmUgdGhhdCB0aGUgc2xpZGVyIGV4aXN0cyBpbiBvdXIgdHJhY2tpbmcgb2JqZWN0XHJcbiAgICBpZiAoc2xpZGVySWQgaW4gc2xpZGVyQ2hhbmdlZCkge1xyXG4gICAgICAgIGNvbnN0IHNsaWRlclZhbHVlID0gJCh0aGlzKS52YWwoKTtcclxuICAgICAgICBpZiAoc2xpZGVyVmFsdWUgIT09IFwiMFwiKSB7XHJcbiAgICAgICAgICAgIHNsaWRlckNoYW5nZWRbc2xpZGVySWRdID0gdHJ1ZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIEVuYWJsZSB0aGUgXCJOZXh0XCIgYnV0dG9uIGlmIGFsbCBzbGlkZXJzIGhhdmUgYmVlbiBjaGFuZ2VkXHJcbiAgICAgICAgaWYgKGNoZWNrQWxsU2xpZGVyc0NoYW5nZWQoKSkge1xyXG4gICAgICAgICAgICBuZXh0QnV0dG9uLnByb3AoXCJkaXNhYmxlZFwiLCBmYWxzZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59KTtcclxuXHJcbi8vIEV2ZW50IGxpc3RlbmVyIGZvciBcIk5leHRcIiBidXR0b24gaW4gTkFTQSBUTFggc3VydmV5XHJcbm5leHRCdXR0b24ub24oXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICBpZiAoIWNoZWNrQWxsU2xpZGVyc0NoYW5nZWQoKSkge1xyXG4gICAgICAgIGFsZXJ0KFwiUGxlYXNlIGFkanVzdCBhbGwgc2xpZGVycyBiZWZvcmUgY29udGludWluZy5cIik7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIEdhdGhlciBzbGlkZXIgdmFsdWVzIHNhZmVseVxyXG4gICAgY29uc3QgbWVudGFsRGVtYW5kID0gKCQoXCIjbWVudGFsX2RlbWFuZFwiKS52YWwoKSBhcyBzdHJpbmcpIHx8IFwiMFwiO1xyXG4gICAgY29uc3QgaHVycmllZERlbWFuZCA9ICgkKFwiI2h1cnJpZWRfZGVtYW5kXCIpLnZhbCgpIGFzIHN0cmluZykgfHwgXCIwXCI7XHJcbiAgICBjb25zdCBwZXJmb3JtYW5jZSA9ICgkKFwiI3BlcmZvcm1hbmNlXCIpLnZhbCgpIGFzIHN0cmluZykgfHwgXCIwXCI7XHJcbiAgICBjb25zdCBlZmZvcnQgPSAoJChcIiNlZmZvcnRcIikudmFsKCkgYXMgc3RyaW5nKSB8fCBcIjBcIjtcclxuICAgIGNvbnN0IGZydXN0cmF0aW9uID0gKCQoXCIjZnJ1c3RyYXRpb25cIikudmFsKCkgYXMgc3RyaW5nKSB8fCBcIjBcIjtcclxuXHJcbiAgICAvLyBMb2cgdGhlIGRhdGFcclxuICAgIGNvbnN0IHRseERhdGEgPSB7XHJcbiAgICAgICAgbWVudGFsX2RlbWFuZDogcGFyc2VJbnQobWVudGFsRGVtYW5kKSxcclxuICAgICAgICBodXJyaWVkX2RlbWFuZDogcGFyc2VJbnQoaHVycmllZERlbWFuZCksXHJcbiAgICAgICAgcGVyZm9ybWFuY2U6IHBhcnNlSW50KHBlcmZvcm1hbmNlKSxcclxuICAgICAgICBlZmZvcnQ6IHBhcnNlSW50KGVmZm9ydCksXHJcbiAgICAgICAgZnJ1c3RyYXRpb246IHBhcnNlSW50KGZydXN0cmF0aW9uKVxyXG4gICAgfTtcclxuXHJcbiAgICBsb2dfZGF0YSh7XHJcbiAgICAgICAgY29uZGl0aW9uOiAkKFwiI2NvbmRpdGlvbl9sYWJlbFwiKS50ZXh0KCksXHJcbiAgICAgICAgdGx4OiB0bHhEYXRhXHJcbiAgICB9KTtcclxuXHJcbiAgICAvLyBIaWRlIHRoZSBOQVNBIFRMWCBwYWdlIGFuZCBtb3ZlIG9uXHJcbiAgICByZXNldFNsaWRlcnMoKTtcclxuICAgICQoXCIjbmFzYV90bHhfc3VydmV5XCIpLmhpZGUoKTtcclxuICAgIGN1cnJlbnRDb25kaXRpb25JbmRleCsrO1xyXG4gICAgY3VycmVudFF1ZXN0aW9uSW5kZXggPSAwO1xyXG4gICAgbmV4dF9xdWVzdGlvbigpO1xyXG59KTtcclxuXHJcbiAgICBcclxuXHJcbn0pO1xyXG4gIGZ1bmN0aW9uIGF1dG9TdWJtaXRQYXJ0MSgpIHtcclxuICAgIC8vIFN0b3AgdGhlIHRpbWVyIGlmIG5vdCBhbHJlYWR5IGNsZWFyZWRcclxuICAgIGNsZWFySW50ZXJ2YWwocGFydDFJbnRlcnZhbCk7XHJcbiAgICAkKFwiI3RpbWVyXCIpLmhpZGUoKTtcclxuICAgIFxyXG4gICAgLy8gQXV0b21hdGljYWxseSB0cmFuc2l0aW9uIHRvIFBhcnQgMlxyXG4gICAgJChcIiNwYXJ0MVwiKS5oaWRlKCk7XHJcbiAgICAkKFwiI3BhcnQyXCIpLnNob3coKTtcclxufVxyXG4kKFwiI3F1YWxfbmV4dFwiKS5vbihcImNsaWNrXCIsICgpID0+IHtcclxuICAgIGNvbnN0IHExID0gKCQoXCIjcXVhbF9xMVwiKS52YWwoKSBhcyBzdHJpbmcpIHx8IFwiXCI7XHJcbiAgICBjb25zdCBxMiA9ICgkKFwiI3F1YWxfcTJcIikudmFsKCkgYXMgc3RyaW5nKSB8fCBcIlwiO1xyXG4gICAgY29uc3QgcTMgPSAoJChcIiNxdWFsX3EzXCIpLnZhbCgpIGFzIHN0cmluZykgfHwgXCJcIjtcclxuICAgIFxyXG4gICAgbGV0IHZhbGlkID0gdHJ1ZTtcclxuICAgIFxyXG4gICAgaWYgKHExLmxlbmd0aCA8IDI1KSB7XHJcbiAgICAgICAgJChcIiN3YXJuX3ExXCIpLnNob3coKTtcclxuICAgICAgICB2YWxpZCA9IGZhbHNlO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICAkKFwiI3dhcm5fcTFcIikuaGlkZSgpO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBpZiAocTIubGVuZ3RoIDwgMjUpIHtcclxuICAgICAgICAkKFwiI3dhcm5fcTJcIikuc2hvdygpO1xyXG4gICAgICAgIHZhbGlkID0gZmFsc2U7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgICQoXCIjd2Fybl9xMlwiKS5oaWRlKCk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGlmIChxMy5sZW5ndGggPCAwKSB7XHJcbiAgICAgICAgJChcIiN3YXJuX3EzXCIpLnNob3coKTtcclxuICAgICAgICB2YWxpZCA9IGZhbHNlO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICAkKFwiI3dhcm5fcTNcIikuaGlkZSgpO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyBJZiB2YWxpZGF0aW9uIGZhaWxzLCBkbyBub3QgcHJvY2VlZFxyXG4gICAgaWYgKCF2YWxpZCkge1xyXG4gICAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8gSWYgYWxsIHRleHQgYm94ZXMgaGF2ZSBhdCBsZWFzdCA1MCBjaGFyYWN0ZXJzLCBsb2cgZGF0YSBhbmQgcHJvY2VlZFxyXG4gICAgY29uc3QgZmluYWxEYXRhID0ge1xyXG4gICAgICAgIHF1YWxpdGF0aXZlOiB7XHJcbiAgICAgICAgICAgIHExOiBxMSxcclxuICAgICAgICAgICAgcTI6IHEyLFxyXG4gICAgICAgICAgICBxMzogcTNcclxuICAgICAgICB9LFxyXG4gICAgICAgIC8vIC4uLiBpbmNsdWRlIGFueSBhZGRpdGlvbmFsIGRhdGEgaWYgbmVlZGVkXHJcbiAgICB9O1xyXG4gICAgbG9nX2RhdGEoZmluYWxEYXRhKTtcclxuICAgIFxyXG4gICAgLy8gVHJhbnNpdGlvbiB0byBlbmQtb2Ytc3VydmV5IOKAnFRoYW5rIHlvdeKAnSBzY3JlZW4gb3Igc2ltaWxhci5cclxuICAgICQoXCIjcXVhbGl0YXRpdmVfc2VjdGlvblwiKS5oaWRlKCk7XHJcbiAgICBpZiAoTU9DS01PREUpIHtcclxuICAgICAgICAkKCcjcmV3YXJkX2JveF9tb2NrJykudGV4dChgWW91ciB0b3RhbCByZXdhcmQgaXMgJDMuMDAuYCk7XHJcbiAgICAgICAgJCgnI3Jld2FyZF9ib3hfbW9jaycpLnNob3coKTtcclxuICAgICAgICAkKFwiI21haW5fYm94X2VuZF9tb2NrXCIpLnNob3coKTsgICAgXHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgICQoJyNyZXdhcmRfYm94JykudGV4dChgWW91ciB0b3RhbCByZXdhcmQgaXMgJDMuMDAuYCk7XHJcbiAgICAgICAgJCgnI3Jld2FyZF9ib3gnKS5zaG93KCk7XHJcbiAgICAgICAgJChcIiNtYWluX2JveF9lbmRcIikuc2hvdygpOyAgICBcclxuICAgIH1cclxufSk7XHJcbiIsImZ1bmN0aW9uIHBhcmFtc1RvT2JqZWN0KGVudHJpZXMpIHtcclxuICBjb25zdCByZXN1bHQgPSB7fVxyXG4gIC8vIGVhY2ggJ2VudHJ5JyBpcyBhIFtrZXksIHZhbHVlXSB0dXBwbGVcclxuICBmb3IgKGNvbnN0IFtrZXksIHZhbHVlXSBvZiBlbnRyaWVzKSB7XHJcbiAgICByZXN1bHRba2V5XSA9IHZhbHVlO1xyXG4gIH1cclxuICByZXR1cm4gcmVzdWx0O1xyXG59XHJcblxyXG5leHBvcnQgeyBwYXJhbXNUb09iamVjdCB9Il0sIm5hbWVzIjpbIlNFUlZFUl9MT0dfUk9PVCIsImFzeW5jIiwibG9nX2RhdGEiLCJkYXRhIiwiZ2xvYmFsVGhpcyIsInVybF9kYXRhIiwiY29uc29sZSIsImxvZyIsInVpZCIsInJlc3VsdCIsIiQiLCJhamF4IiwiSlNPTiIsInN0cmluZ2lmeSIsInByb2plY3QiLCJwYXlsb2FkIiwidHlwZSIsImNvbnRlbnRUeXBlIiwiUHJvbWlzZSIsInJlc29sdmUiLCJzZXRUaW1lb3V0Iiwic2xlZXAiLCJlIiwiTU9DS01PREUiLCJxdWVzdGlvbiIsImNvbmZpZGVuY2VSYXRpbmciLCJwYXJ0MVRpbWVyIiwicGFydDFJbnRlcnZhbCIsInJlbWFpbmluZ1RpbWUiLCJjdXJyZW50Q29uZGl0aW9uSW5kZXgiLCJjdXJyZW50UXVlc3Rpb25JbmRleCIsImJhbGFuY2UiLCJpbnN0cnVjdGlvbl9pIiwiY291bnRfZXhpdGVkX3BhZ2UiLCJjaGVja1ByZVN1cnZleSIsImxhdGV4RXhwIiwidmFsIiwibGF0ZXhGcmVxIiwiY2hhdGJvdEZyZXEiLCJzaG93IiwiaGlkZSIsIm5leHRfaW5zdHJ1Y3Rpb25zIiwiaW5jcmVtZW50IiwiYXR0ciIsInJlbW92ZUF0dHIiLCJuZXh0X3F1ZXN0aW9uIiwiY2hpbGRyZW4iLCJlYWNoIiwiXyIsImVsIiwiaXNfdXNlcl9jb3JyZWN0Iiwic2VsZWN0aW9uIiwib24iLCJvbGRfYmFsYW5jZSIsImxvZ2dlZF9kYXRhIiwicHJhY3RpY2VRdWVzdGlvbnMiLCJwcmFjdGljZUluZGV4Iiwic2hvd1ByYWN0aWNlUm91bmQiLCJvbkNvbXBsZXRlIiwiZW1wdHkiLCJwcmFjdGljZUNvbnRlbnQiLCJhcHBlbmQiLCJodG1sIiwibGVuZ3RoIiwicHJlZGljdGVkSHRtbCIsIkFycmF5IiwiaXNBcnJheSIsImZpbHRlciIsIml0ZW0iLCJ0b2tlbiIsIm1hcCIsInRva2VuVGV4dCIsInJlcGxhY2UiLCJwcm9iIiwidG9wXzVfdG9rZW5zIiwicHJvYmFiaWxpdHkiLCJjb25kaXRpb24iLCJqb2luIiwidG9rZW5zQ29uY2F0ZW5hdGVkIiwib2ZmIiwiY29uZGl0aW9uQmxvY2siLCJoZWFkZXJIdG1sIiwicmVqZWN0IiwiZ2V0SlNPTiIsImRvbmUiLCJmYWlsIiwianF4aHIiLCJ0ZXh0U3RhdHVzIiwiZXJyb3IiLCJ0aGVuIiwiY2F0Y2giLCJlcnIiLCJzaG93U3RhcnRDb25kaXRpb25QYWdlIiwicXVlc3Rpb25zIiwiY3VycmVudENvbmRpdGlvbiIsInRleHQiLCJzaG93RW5kQ29uZGl0aW9uUGFnZSIsImludGVuc2l0eSIsImNsZWFyVGltZW91dCIsIndpbmRvdyIsImF1dG9TdWJtaXRQYXJ0MSIsImNsZWFySW50ZXJ2YWwiLCJzZXRJbnRlcnZhbCIsInVybFBhcmFtcyIsIlVSTFNlYXJjaFBhcmFtcyIsImxvY2F0aW9uIiwic2VhcmNoIiwic3RhcnRPdmVycmlkZSIsImdldCIsIlVJREZyb21VUkwiLCJlbnRyaWVzIiwia2V5IiwidmFsdWUiLCJwYXJhbXNUb09iamVjdCIsInF1ZXVlX2lkIiwiTWF0aCIsImZsb29yIiwicmFuZG9tIiwicGFkU3RhcnQiLCJVSURfbWF5YmUiLCJwcm9tcHQiLCJzdGFydHNXaXRoIiwiRGF0ZSIsIm5vdyIsImxvYWRfZGF0YSIsIl9lcnJvciIsInJlbG9hZCIsIm5ld19kYXRhIiwicGFyc2VJbnQiLCJhbGVydF9hY3RpdmUiLCJkb2N1bWVudCIsIm9udmlzaWJpbGl0eWNoYW5nZSIsInJlYWR5IiwicmF0aW5nIiwidGhpcyIsInJlbW92ZUNsYXNzIiwiYWRkQ2xhc3MiLCJjdXJyZW50VGV4dCIsInNsaWRlckNoYW5nZWQiLCJtZW50YWxfZGVtYW5kIiwiaHVycmllZF9kZW1hbmQiLCJwZXJmb3JtYW5jZSIsImVmZm9ydCIsImZydXN0cmF0aW9uIiwiY2hlY2tBbGxTbGlkZXJzQ2hhbmdlZCIsIk9iamVjdCIsInZhbHVlcyIsImV2ZXJ5IiwibmV4dEJ1dHRvbiIsInByb3AiLCJzbGlkZXJJZCIsImFsZXJ0IiwibWVudGFsRGVtYW5kIiwiaHVycmllZERlbWFuZCIsInRseERhdGEiLCJ0bHgiLCJyZXNldFNsaWRlcnMiLCJxMSIsInEyIiwicTMiLCJ2YWxpZCIsInF1YWxpdGF0aXZlIl0sInNvdXJjZVJvb3QiOiIifQ==